# 双随机相位加密同轴傅里叶全息水印防伪技术

1,2 1,2孙刘杰 庄松林  
1 上海理工大学出版印刷学院,上海20093  
2 上海理工大学光学与电子信息工程学院,上海20093

摘要： 提出了一种制作加密　的傅里叶变换全息图像的方法,通过光学系统或计算机系统将原始数字图像经过双随机相位模板调制并与参考光干涉生成加密的傅里叶变换全息图像。将加密的傅里叶变换全息图像作为水印可以叠加隐藏在载体数字图像中,用于证明载体数字图像的版权。通过打印和扫描实验证明了含水印数字图像,可以通过普通的印刷技术印制在证件中；印刷品中的含水印载体数字图像,可以通过扫描输入计算机变换生成数字图像,通过盲检测技术可以从中提取所含数字水印,从而证明印刷品的真实性,提高了防伪能力。

关键词： 全息术；数字水印；　印刷；防伪中图分类号：TN26；TP309.7 文献标识码：A

# ForgeryPreventionBasedonIn-LineFourierHolographicWatermark withDoubleRandom PhaseEncryption

SunLiujie1,2 ZhuangSonglin1,2

1 ColegeofPrintingandPublishing,UniversityofShanghaiforScienceandTechnology,Shanghai20093 2 ColegeofOpticsandElectronicInformationEnginering,UniversityofShanghaiforScienceandTechnology, Shanghai20093

Abstract：　 A methodtofabricateencrypted Fouriertransform holographsisprovided.With opticalsystem or computer,theoriginaldigitalimageismodulatedbydoublerandom phaseplatesandinterfereswiththereference light,andthentheencryptedFouriertransformholographiscreated,whichcanberegardedasthewatermarkand hideninahostimagetoguarante thecopyrightauthentication.Theprintingandscaningexperimentsprovethat thedigitalimageswithwatermarkcanbeprintedonthecertificateswithordinaryprintingtechnology.Thedigital imageswithwatermarkcanbescanedandinputintothecomputer,andthedigitalwatermarkcanbeextractedwith blinddetectiontechnology.The credibility ofthe printed materisproved,andthe anti-fake performanceis improved.

Keywords：　 holography；digitalwatermark；print；forgeryprevention

# 1 引　 言

数字水印技术是一种保护数字作品版权的技术,利用人类的听觉、视觉系统的特点,在声音、图像和视频中加入一定的信息,使人们很难分辨加水印后的数字作品与原始数字作品的区别,而通过专门的检测方法又能提取所加信息,以此证明原创作者对数字媒体的版权。在检测过程中,如果不需要原始数字作品参与的检测器,称为盲检测器。数字水印应具有不可见性、稳健性和安全性等特点。由于记录了物体的全部信息(振幅和相位),从部分全息图像也可以再现原物体的像,具有信息冗余度高和抗干扰能力强等特点,因此全息图像也特别适合作为水印图像。

TakaiN 等[1] 直接用物体的傅里叶变换全息图像作为水印直接叠加到载体图像中,并通过仿真证实了常系数加权比自适应加权有更好的重建图像质量,但是没有经过授权也可以读取图像中水印,安全性差,且不能抵抗低通滤波干扰。KishkS等[2] 提出了一种在图像中隐藏图像的方法,隐藏的图像经过双相位编码加密生成随机图像并嵌入到载体图像中,只有经过授权才能读取隐藏图像,具有高安全性,但嵌入强度过高(加权系数 $\alpha = 5 0 \%$ )。本文将加密水印和全息技术结合[3～11] ,形成了一种新的加密全息水印方法,该加密水印只有通过解密模板才能恢复原始图像,安全性高,嵌入强度适中 $\mathrm { ( } \alpha = 1 0 \% \sim 3 0 \% \$ ),具有较好的不可见性,且具有一定的抗低通滤波和几何畸变干扰能力。通过印刷技术,可以将含加密全息水印的载体图像印制在证件等印刷品上,用于对印刷品的真实性进行检验,提高了印刷品的防伪能力。光学全息水印防伪技术具有制作方法简单、保密防伪性能强、制作成本低等特点,具有重要的实用价值。

# 2 原 理

设待加密图像或数据为已归一化的 $f ( x , y )$ ,图像大小为 M pixel $\times \mathrm { ~ N ~ }$ pixel。其中 $( \boldsymbol { \textbf { \it x } } , \boldsymbol { \textbf { \it y } } )$ )为空域坐标。令 $( \textsf { \textsf { E } } , \eta )$ )为频域坐标。 $\psi _ { } ( \boldsymbol { x } , \boldsymbol { y } )$ )为双随机相位的加密图像。 $p ( \boldsymbol { x } , \boldsymbol { y } )$ )和 $b ( \hat { \boldsymbol { \mathsf { \varepsilon } } } , \boldsymbol { \mathsf { \eta } } )$ )为均匀分布在 $[ 0 , 1 ]$ 之间的两个独立白噪声随机图像。则双随机相位的加密图像为

$$
\begin{array} { r }  \psi _ { \mathcal { ( } \textbf { \mathcal { x } } , \textbf { \mathcal { y } } ) } = \{ \ f _ { \mathcal { ( } \textbf { \mathcal { x } } , \textbf { \mathcal { y } } ) \exp \left[ \frac { \ i \pi \phi _ { \mathcal { ( } \textbf { \mathcal { x } } , \textbf { \mathcal { y } } ) } } { \hbar \mathcal { ( } \textbf { \mathcal { x } } , \textbf { \mathcal { y } } ) } \right] \} \ \ast \ h _ { \mathcal { ( } \textbf { \mathcal { x } } , \textbf { \mathcal { y } } ) } , } \end{array}
$$

其中 $h ( \boldsymbol { x } , \boldsymbol { y } )$ )是 $\mathrm { B } ( \^ { \xi } , \eta ) = \exp \bigl [ \mathrm { j } 2 \pi b ( ^ { \xi } , \eta ) \bigr ]$ 的脉冲响应, $\ast$ 为卷积运算符号。理论证明 $[ 4 ]$ ψ $x , y )$ )是一个白噪声图像,其均值为0,方差为

$$
\sigma _ { \psi } ^ { 2 } = \frac { 1 } { \mathrm { M } \times \mathrm { N } } \Big [ \sum _ { u = 0 } ^ { \mathrm { M - 1 } } \sum _ { v = 0 } ^ { \mathrm { N - 1 } } \big | \ f ( \ u , v ) \big | \ 2 \Big ] \ ,
$$

$\psi _ { } ( \boldsymbol { x } , \boldsymbol { y } )$ )包含了振幅信息和相位信息,是一个复数图像,不能直接作为水印叠加在可视图像上,因此必须作特殊处理。

# 2.1 加密数字全息图像

设 $\psi _ { ( \mathrm { \scriptsize ~ } x , \mathrm { \scriptsize ~ y } ) } = \mathrm { \scriptsize ~ A } ( \mathrm { \scriptsize ~ } x , \mathrm { \scriptsize ~ y } ) \exp [ \mathrm { \scriptsize ~ j } \phi ( \mathrm { \scriptsize ~ } x , \mathrm { \scriptsize ~ y } ) ]$ ,同轴参考光的相位为 $\exp [ \mathrm { j } \phi _ { \mathrm { 0 } } ]$ ,其中 $\phi _ { \mathrm { 0 } }$ 为某一常数,则同轴全息图像为

$$
\begin{array} { r l } & { \mathrm { H } ( x , y ) = } \\ & { \bigl | \operatorname { A } ( x , y ) \exp \{ \mathfrak { j } [ \oint ( x , y ) + \oint _ { 0 } ] \} + \exp ( \mathfrak { j } \oint _ { 0 } ) \bigr | ^ { 2 } = } \\ & { 1 + \bigl | \operatorname { A } ( x , y ) \bigr | ^ { 2 } + \operatorname { A } ( x , y ) \exp \bigl [ \mathfrak { j } \oint ( x , y ) \bigr ] + } \\ & { \mathrm { A } ( x , \mathfrak { v } ) \exp [ - \mathfrak { i } \oint ( x , \mathfrak { v } ) ] , } \end{array}
$$

此全息图像含有项 $\mathrm { A ( \it x , \mathrm { y } ) \exp [ j \phi ( \mathrm { x } , \mathrm { y } ) , \bar { \it y } ] _ { \tau } } ,$ ,此项即为恢复原始图像的信息。另外的 $1 + \mid \mathrm { A } ( \ b { x } , \ b { y } ) \mid ^ { 2 } +$ $\mathrm { A } ( \boldsymbol { x } , \boldsymbol { \mathrm { y } } ) \exp [ - \mathrm { j } \boldsymbol { \Phi } ( \boldsymbol { x } , \boldsymbol { \mathrm { y } } ) ]$ 项中的常数1 可通过零频滤波去除, $\vert \ \mathrm { A } ( \ x , \ y ) \ \vert ^ { 2 }$ 项可以通过计算其功率谱或零级滤波加以去除, $\mathrm { A } ( \boldsymbol { x } , \boldsymbol { y } ) \exp [ - \mathrm { j } \phi ( \boldsymbol { x } , \boldsymbol { y } ) ]$ 项增加了恢复图像的背景高斯白噪声的方差。

# 2.2 加密数字全息图像的　解密

同轴全息图像 ${ \mathrm { H } } ( { \boldsymbol { x } } , { \boldsymbol { y } } )$ 通过计算或滤波处理后,得到新的加密数字全息图像为

$$
\mathrm { H } ^ { \prime } ( x , y ) = \mathrm { A } ( x , y ) \exp [ \mathrm { j } \phi ( x , y ) ] +
$$

$$
\mathrm { A } ( \boldsymbol { x } , \mathrm { y } ) \exp [ - \mathrm { j } \phi ( \boldsymbol { x } , \mathrm { y } ) ] ,
$$

加密图像的解密过程是加密过程的逆变换过程,即将加 密 图 像 $\boldsymbol { \mathrm { H } } ^ { \prime } ( \boldsymbol { x } , \boldsymbol { y } )$ 进 行 傅 里 叶 变 换 后 乘 以$\exp [ - \mathrm { \ j } 2 \pi b ( \bar { \boldsymbol { \xi } } , \boldsymbol { \eta } ) ]$ ,再进行逆傅里叶 变 换 后 乘 以$\exp [ - \mathrm { j } 2 \pi \boldsymbol { p } ( \boldsymbol { x } , \boldsymbol { y } ) ]$ ,就可得到原始图像 $f ( x , y )$ ,在$f ( x , y )$ 的背景上叠加了高斯噪声信号 $f _ { 1 } ( x , y )$ ,其表达式为

$$
f _ { 1 } ( x , y ) = \mathrm { I F T } \{ \hat { \mathrm { A } } ( \overleftarrow { \xi } , \eta ) \exp [ - \mathrm { j } 2 \pi b ( \overleftarrow { \xi } , \eta ) ] \} \times
$$

$$
\exp [ - \mathrm { j } 2 \pi p ( x , y ) ] ,
$$

其中 $\hat { \mathrm { A } } ( \mathfrak { E } , \eta )$ )为 $\mathrm { A } ( \boldsymbol { x } , \boldsymbol { y } ) \exp [ - \mathrm { j } \phi ( \boldsymbol { x } , \boldsymbol { y } ) ]$ 的傅里叶变换。

# 2.3 加密全息水印技术

设 $\ C ( \boldsymbol { x } , \boldsymbol { y } )$ 为载体图像, $\alpha$ 为加权系数,它表示水印添加的强度,则含水印的载体实值图像为

$$
\begin{array} { r } { \mathrm { I } ( x , \mathsf { y } ) = \alpha \mathrm { H } ^ { \prime } ( x , \mathsf { y } ) + \mathrm { C } ( x , \mathsf { y } ) , } \end{array}
$$

为了恢复原始图像信息,首先将 $\boldsymbol { \mathrm { I } } ( \boldsymbol { x } , \boldsymbol { y } )$ 进行傅里叶变换,并乘以 $\exp [ - \mathrm { j } 2 \pi b ( \bar { \boldsymbol { \xi } } , \boldsymbol { \eta } ) ]$ ,再进行逆傅里叶变换后乘以 $\exp [ - \mathrm { j } 2 \pi \boldsymbol { p } ( \boldsymbol { x } , \boldsymbol { y } ) ]$ ,就可得到原始图像$f ( x , y )$ ,在 $f ( x , y )$ )的背景上叠加了高斯噪声信号$f _ { 2 } ( x , y )$ ),其表达式为

$$
\begin{array} { r l } &  f _ { 2 } ( \boldsymbol { \textbf { \em x } } , \boldsymbol { \textbf { y } } ) = \mathrm { I F T } \{ [ \begin{array} { l } { a \hat { \mathrm { A } } ( \boldsymbol { \textbf { \xi } } , \boldsymbol { \eta } ) + \mathbb { C } ( \boldsymbol { \textbf { \xi } } , \boldsymbol { \eta } _ { \mathrm { D } } ]   } \\ {   \mathrm { e x p } [ - \mathrm { j } 2 \pi b ( \boldsymbol { \textbf { \xi } } , \boldsymbol { \eta } _ { \mathrm { D } } ] \}   \times } \\ {   \mathrm { e x p } [ - \mathrm { j } 2 \pi \boldsymbol { \phi } ( \boldsymbol { \textbf { \em x } } , \boldsymbol { \textbf { y } } ) ] ,   } \end{array} \end{array}
$$

其中 $\mathfrak { C } ( \mathfrak { E } , \eta )$ 为载体图像 $\operatorname { C } ( x , y )$ )的傅里叶变换。对于大数 M 和 $\mathrm { ~ N ~ }$ ,高斯噪声信号 $f _ { 2 } ( x , y )$ 的方差可表示为[2] ：

$$
\sigma ^ { 2 } = \frac { 1 } { { \bf M } \times { \bf N } } \Big [ \sum _ { \hat { \varepsilon } = 0 } ^ { { \bf M } - 1 } \sum _ { \eta = 0 } ^ { { \bf N } - 1 } \big | \alpha \hat { \bf A } ( \hat { \varepsilon } , \eta ) + \mathfrak { C } ( \hat { \varepsilon } , \eta _ { \mathcal { D } } | 2 \big ] .
$$

# 3 仿真和分析

# 3.1 水印的嵌入和检测

仿真实验用原始图像如图1(a)～图1(c)所示,图像大小为256pixel $\times 2 5 6$ pixel,灰度等级为256。水印图像是表示特征信息或版权信息的二值图像,如图1(d)～图1(f)所示。当水印嵌入强度系数$\alpha = 2 5 \%$ 时,嵌入水印后的图像如图 $1 ( \mathrm { g } ) \sim$ 图1(i)所示。加入水印前后的载体图像在视觉上无法区分,体现了水印的不可见性。从嵌入水印后的图像中,通过正确的相位模板解密,可获得重建水印图像[图1(j)～图1(l)]。在水印重建过程中,不需要原始图像的参与,此重建过程是盲检测过程。

![](images/5f20483b05c18ce009f7b538c2e2315e998537d2e54169ffa4390cc1568399bb.jpg)  
图1 原始灰度载体图像[(a),(b),(c)],原始二值水印图像[(d),(e),(f)],含水印的载体图像[(g),(h),(i)], 用正确密钥解密恢复原始二值水印图像[ (j),(k),(l)]   
Fig.1 Originalgray-levelpicturesusedashostimages $\left[ \left( \mathrm { a } \right) , \left( \mathrm { b } \right) , \left( \mathrm { c } \right) \right]$ ,originalbinarypicturesusedasthewatermarks[(d) (e),(f)],watermarkedhostimages $\big [ ( \mathbf { g } ) , ( \mathrm { h } ) , ( \mathrm { i } ) \big ]$ ,reconstructedwatermarksbythecorectkeyfunctions $\left[ \left( \mathbf { j } \right) , \left( \mathbf { k } \right) , \left( \mathbf { l } \right) \right]$

# 3.2 含水印图像的印刷和　认证

经过印刷和扫描过程后,如果数字水印图像依然可以重建,表明该数字水印算法可以抗一定的几何形状畸变攻击、像素值变化攻击和低通滤波攻击的能力。加密全息水印技术所生成的数字水印嵌在载体图像中,含水印的载体图像可以通过打印或数字印刷机印制在证件等印刷品上,用来对证件等印刷品进行真伪鉴别。图2(a)～图2(c)是图 $1 ( \mathrm { g } ) \sim$ 图1(i)含水印载体图像通过60 dpiHPLaserJet6L激光打印机打印并通过60 dpiHPScan230C扫描仪扫描重新生成并输入计算机的图像。图2(d)～图2(f)是从扫描后的图像中 ,通过正确的相位模板解密,获得重建水印图像。从图中可以清晰地辨认所加入的认证信息,证明加密全息水印可以通过印刷技术印制在印刷品上,提高印刷品的防伪能力。

![](images/5ad8df57afee6076f830c4e165caddb7b17782e76f74e65c2fe0fc12c28d0075.jpg)  
图2 含水印载体图像通过打印机打印并通过扫描仪扫描重新生成并输入计算机的图像[(a),(b),(c)], 从扫描图像中恢复的原始二值水印图像[(d),(e),(f)] Fig.2 Scanedtheprintingimagesofthewatermarkedhostimages[(a),(b),(c)],reconstructedbinarywatermarksfrom thescanedimagesbythecorectkeyfunctions $\big [ ( \mathrm { d } ) , ( \mathrm { e } ) , ( \mathrm { f } ) \big ]$

# 4 结　 论

双随机相位加密数字全息水印防伪技术是建立在双随机相位加密技术的基础上,并结合了全息技术和数字印刷技术的特点,具有高安全性和不可见性,而且具有一定的抗几何形状畸变攻击、像素值变化攻击和低通滤波攻击的能力。理论分析和仿真实验证明了该数字全息水印方法的可行性和实用性。打印扫描实验显示了光学全息水印可以通过普通的印刷技术印制在证件等印刷品上作为认证标记,可以通过正确随机相位模板解密恢复出水印图像,并从恢复的图像判断出所加认证信息。双随机相位加密全息水印防伪技术特别适合证件的防伪。

# 参 考 文 献

1TakaiN,MifuneY.Digitalwatermarkingbyaholographictechnique [J].Apl.Opt.,202,41(5)： $8 6 5 \sim 8 7 3$ 2KishkS,JavidiB.Informationhidingtechnique withdoublephase encoding[J].Apl.Opt.,202,41(26)： $5 4 6 2 \sim 5 4 7 0$ 3RefregierP,JavidiB.Opticalimageencryptionbasedoninputplane

andFourierplanerandomencoding[J].Opt.Let.,195,20(7)： $7 6 7 \sim 7 6 9$   
4Javidi B, Nomura T. Securing information by use of digital holography[J].Opt.Let.,200,25(1)： $2 8 \sim 3 0$   
5NaughtonTJ,JavidiB.Compresionofencryptedthre-dimensional objectsusingdigitalholography[J].Opt.Engng.,204,43(10)： $2 2 3 3 \sim 2 2 3 8$   
6Kishk S,JavidiB.Watermarkingofthre-dimensionalobjectsby digitalholography[J].Opt.Let.,203,28(3)：167～169   
7NishchalN K,JosephJ,Singh K.Fuly phaseencryption using digitalholography[J].Opt.Engng.,204,43(12)： $2 9 5 9 \sim 2 9 6 6$   
8Lu-zhong Cai, Ming-zhao He, Qing Liu et al. Digitalimage encryptionand watermarking by phase-shiftinginterferometry[J]. Apl.Opt.,204,43(15)：3078～3084   
9Ming-zhaoHe,Lu-zhongCai,QingLiuetal.Phase-onlyencryption andwatermarkingbasedonphase-shiftinginterferometer[J].Apl. Opt.,205,4 (13)：260 ～2606   
10Xiang Peng, Lingfeng Yu, Lilong Cai. Double-lock for image encryptionwithvirtualopticalwavelength[J].Opt.Expres,202, 10(1)：41～45   
1 Peng Xiang, Zhang Peng, Niu Hanben. 3-D spatial digital watermarkingsystembasedonvirtualoptics[J].ActaOpticaSinica, 204,24(1 )： $1 5 0 7 \sim 1 5 1 0$ (inChinese) 彭　 翔,张　 鹏,牛憨笨.基于虚拟光学的三维空间数字水印系 统[J].光学学报,204,24(1 )： $1 5 0 7 \sim 1 5 1 0$