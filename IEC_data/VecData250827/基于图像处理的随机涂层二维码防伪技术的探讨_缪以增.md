華中师範大学硕士学位论文基于图像处理的随机涂层二维码防伪技术的探讨学位申请人姓名： 缪以增申请学位学生类别： 全日制硕士申请学位学科专业： 电子与通信工程指导教师姓名： 孙向明 教授

# 硕士学位论文

# 基于图像处理的随机涂层二维码防伪技术的探讨

论文作者：缪以增指导教师：孙向明教授学科专业：电子与通信工程研究方向：图像处理

# 华中师范大学物理科学与技术学院2020年5月

# Discussion on Anticounterfeiting Technology of Random Coated QR Code Based on Image Processing

A Thesis

Submitted in Partial Fulfillment of the Requirement For the M.E Degree in Electronics and Communication Engineering

By

Miao Yizeng Postgraduate Program College of Physical Science and Technology Central China Normal University

Supervisor: Sun Xiangming Academic Title:Professor

Signature 孙向明

Approved May. 2020

# 摘要

随着经济的高速发展，假冒伪劣产品的日益增长成为了一个影响经济正常发展的重要问题。不管是从我国还是国际角度来看，假冒伪劣产品的增长不仅影响了用户的合法利益，还给国家和企业等带来了巨大的损失，而采取一定的技术手段，对假冒伪劣产品进行打击就显得尤为重要。

防伪技术的目的是为了解决快速发展的社会对于打击假冒伪劣产品的需求，通过不断地改进和发现新的防伪技术，使得防伪技术在产品应用领域中占据着越来越重要的地位。目前所常用的防伪技术主要包含广泛应用于纸币制造中的雕刻印刷防伪技术、应用于票证及产品包装的油墨水印防伪技术、激光全息防伪技术、电话查询防伪技术和RFID防伪技术等。

然而，目前所采用的众多防伪技术解决方案，无法同时解决用户可以直接判断和“防复制”这两个重要问题。图像处理是目前发展迅速且应用广泛的一门技术，它可以直接表现图像的信息，并且对图像的信息加以处理，以此达到满足自身的需求。本文是基于图像处理技术展开研究，结合传统二维码QRCode的广泛使用，研究并实现了一种随机涂层二维码防伪技术，完全解决了防伪标签被复制的问题。随机涂层是由特殊颜色颗粒随机分布在具有一定高度的透明涂层构成，利用图像处理技术获取在不同角度下，拍摄设备获得的防伪标签中随机涂层相对于二维码的相对坐标，并以特征矢量表征其相对坐标信息，通过服务器验证不同角度下的随机涂层特征矢量，在一定的误差允许范围内，可判断防伪标签的真假，即判断使用防伪标签产品的真假。

本文对基于图像处理的随机涂层二维码防伪系统进行了深入研究和实现。首先，本文使用二维码识别算法得出图像中二维码黑白方格点的图像坐标值，然后提出使用透视变换算法建立基于二维码的相对坐标系，并得出透视变换的变换矩阵。同时，本文使用中值滤波去噪算法对图像进行预处理，然后使用基于区域增长的图像分割算法获得随机涂层区域，并使用轮廓点检测算法得出随机涂层的轮廓点图像坐标值，随之提出使用上述的透视变换矩阵获得每个涂层相对于二维码的相对轮廓点图像坐标值，最后计算出每个涂层的相对重心点坐标值和相对涂层区域面积，并以此作为随机涂层二维码的特征矢量，从而进行防伪判别。

经过多次测试，本文所提出的防伪系统各个部分已经完全实现，最后系统对于防伪标签的防伪识别准确度为0.98，即使在光照较弱情况下和不同设备中，防伪系统依然能够拥有较高的防伪识别准确度。防伪系统的功能和准确度可以达到预期的目标。

关键词：图像处理；随机涂层；二维码；防伪

# Abstract

With the rapid development of the economy, the increasing growth of counterfeit and shoddy products has become an important issue affecting the normal development of the economy. Whether from the perspective of China or internationally, the growth of counterfeit and shoddy products not only affects the legitimate interests of users, but also brings huge losses to countries and enterprises. It is necessary to take certain technical measures to combat counterfeit and shoddy products. Seems particularly important.

The purpose of anti-counterfeiting technology is to solve the fast-growing society's demand for combating counterfeit and shoddy products.Through continuous improvement and discovery of new anti-counterfeiting technology， anti-counterfeiting technology occupies an increasingly important position in the field of product applications. At present, the commonly used anti-counterfeiting technology mainly includes engraving and printing anti-counterfeiting technology widely used in the manufacture of banknotes, ink watermark anti-counterfeiting technology used in tickets and product packaging, laser holographic anti-counterfeitingtechnology, telephone inquiryanti-counterfeiting technology and RFID anti-counterfeiting technology.

However, the numerous anti-counterfeiting technology solutions currently adopted cannot simultaneously solve the two important problems that users can directly judge and "anti-copy". Image processing is a rapidly developing and widely used technology. It can directly express the image information and process the image information to meet its own needs. This article is based on image processing technology to carry out research, combined with the widespread use of traditional QR Code, research and implementation of a random coating two-dimensional code anti-counterfeiting technology, completely solve the problem of anti-counterfeit labels being copied. The random coating is composed of special color particles randomly distributed in a transparent coating with a certain height, using image processing technology to obtain the relative coordinates of the random coating relative to the two-dimensional code in the anti-counterfeit label obtained by the shooting equipment at different angles,and Characteristic vectors are used to characterize their relative coordinate information. The server verifies the random coating feature vectors at different angles.Within a certain tolerance,the authenticity of the anti-counterfeit label can be judged, that is, the authenticity of the product using the anti-counterfeit label.

In this paper, the anti-counterfeiting technology of random coating two-dimensional code based on image processing is deeply researched and implemented.First, this paper uses the two-dimensional code recognition algorithm to obtain the image coordinate values of the black and white grid points of the two-dimensional code in the image,and then proposes to use the perspective transformation algorithm to establish the relative coordinate system based on the two-dimensional code,and obtain the perspective transformation matrix.At the same time, this paper uses the median filter denoising algorithm to preprocess the image, and then uses the image segmentation algorithm based on region growth to obtain the random coating area, and uses the contour point detection algorithm to obtain the coordinate value of the contour point image of the random coating. It is proposed to use the above-mentioned perspective transformation matrix to obtain the relative coordinate point image coordinate value of each coating relative to the twodimensional code, and.finally calculate the coordinate value of the relative center of gravity of each coating and the relative coating area, and use this as Randomly coat the feature vectors of the two-dimensional codes to perform anti-counterfeit discrimination.

After many tests, the various parts of the anti-counterfeiting system proposed in this paper have been fully realized.Finally, the anti-counterfeiting identification accuracy of the system for anti-counterfeiting tags is 0.98.Even under low light conditions and in different devices, the anti-counterfeiting system can still have a high Anti-counterfeiting identification accuracy. The function and accuracy of the anti-counterfeiting system can achieve the expected goal.

Keywords: image processing; random coating; two-dimensional code; anticounterfeiting.

# 目录

摘要. I  
Abstract... III  
第1章绪论. 1  
1.1课题研究背景与意义 1  
1.2国内外研究现状. 2  
1.2.1防伪技术的国内外研究现状， 2  
1.2.2现存防伪技术存在的主要问题， 4  
1.3本文主要内容及结构安排 5  
1.3.1本文主要内容.. 5  
1.3.2论文结构安排 6  
第2章相关理论基础介绍.. 7  
2.1二维码理论基础.  
2.1.1二维码概述. 7  
2.1.2 QR码. 8  
2.2图像处理理论基础. .12  
2.2.1 图像去噪. 12  
2.2.2图像分割... .15  
2.2.3透视变换.. 19  
2.3 本章小结... 19  
第3章随机涂层二维码防伪技术研究 .20  
3.1随机涂层二维码防伪概述.. 20  
3.1.1随机涂层二维码防伪原理， 20  
3.1.2随机涂层二维码防伪构成.. .21  
3.2基于图像处理的二维码坐标系研究， 23  
3.2.1二维码坐标系重建技术.. .23  
3.2.2实验及结果分析.. .24  
3.3基于图像处理的随机涂层研究. 25  
3.3.1随机涂层轮廓点提取. 25  
3.3.2实验及结果分析. 26  
3.4随机涂层二维码防伪技术研究， 26  
3.4.1防伪标签特征矢量提取技术.. 26  
3.4.2实验及结果分析. 28  
3.5本章小结.. 30  
第4章随机涂层二维码防伪需求和可行性分析， 31  
4.1常见防伪方案.. 31  
4.1.1常见防伪系统方案介绍.. 31

# 4.1.2常见数字加密二维码防伪系统方案分析. 32

2防伪系统的需求分析. 34

4.2.1防伪系统的功能需求分析， 34  
4.2.2防伪系统的性能需求分析. 36  
4.2.3防伪系统的安全性需求分析.. .36  
4.3随机涂层二维码防伪系统的设计方案. .36  
4.4随机涂层二维码防伪系统可行性分析. 38  
4.5本章小结. 38  
第5章随机涂层二维码防伪系统的设计和实现 39  
5.1软件开发运行环境及运行平台.. 39  
5.1.1软件运行环境分析.. 39  
5.1.2软件开发环境和运行平台. 39  
5.2随机涂层二维码防伪系统的整体架构设计. 40  
5.3系统特征矢量生成模块设计与实现. 41  
5.3.1系统特征矢量生成模块设计. 41  
5.3.2系统特征矢量生成模块实现.. 42  
5.4系统特征矢量验证模块设计与实现. 44  
5.4.1系统特征矢量验证模块设计.. 44  
5.4.2系统特征矢量验证模块实现. 47  
5.5本章小结... 48  
第6章随机涂层二维码防伪系统的测试.. 49  
6.1防伪系统测试架构和测试环境. 49  
6.1.1防伪系统测试架构. 49  
6.1.2防伪系统测试环境.. 50  
6.2防伪系统功能测试. 50  
6.3防伪系统性能测试.. 51  
6.4防伪系统防伪测试. 52  
6.4.1防伪系统防伪准确性测试. 52  
6.4.2防伪系统在不同光照条件下防伪测试. 54  
6.4.3防伪系统在不同设备条件下防伪测试.. 55  
6.5本章小结.. .56  
第7章总结与展望 57  
7.1本文工作总结. 57  
7.2不足和展望. 57  
参考文献... 59  
致谢.. 62

# 第1章绪论

# 1.1课题研究背景与意义

近年来，随着我国商品经济的不断增长，在世界GDP排名中，我国已经取得了世界第二的成绩。然而，随着我国经济高速发展的同时，层出不穷的假冒伪劣产品给我国的社会发展带来了许多不利的影响。从工业和农业用品到与人们息息相关的食品、药品、日用品等，随处可见的假冒伪劣产品在损害消费者自身利益的同时，对我国的企业造成了巨大的损失[1]。

根据相关数据显示，从我国的角度来看，假冒伪劣产品的数量呈现每年上升的趋势[2]。以2015年数据为例，我国的假冒伪劣产品的贸易金额大约占我国总体贸易金额的 $6 \%$ 至 $8 \%$ 。同时，假冒伪劣产品对我国至少 $3 5 \%$ 的企业产生影响，而从平均数据来看，每家企业因为假冒伪劣产品而产生的损失多达2000万元。而从国际上来看，假冒伪劣产品现象日益成为了一个损害全球经济健康发展的重要因素之一。根据经济合作与发展组织和欧盟知识产权局在2019年共同发布的相关报告显示，在2013年度，假冒伪劣产品的国际贸易金额高达4610亿美元，占世界贸易总额的$2 . 5 \%$ ；而到了2016年度，假冒伪劣产品的国际商贸金额高达5090亿美元，占世界贸易总额的 $3 . 3 \%$ ，假冒伪劣产品问题呈现出越来越严重的局面。

假冒伪劣产品的形成是多方面的。以我们国家为例，假冒伪劣产品的形成主要是因为市场经济下，人们为了追求利益的最大化导致。在我国的市场经济中，生产者和销售者为了利润的最大化，通过盗用商标和以次充好等方式缩减成本，进而尽可能地增加收益 $i 3 j _ { \circ } ^ { - }$ ·从这一方面来说，假冒伪劣产品的产生极大地损害了我国市场经济的健康发展。因此，采取有效的措施，治理假冒伪劣现象，对于我国经济的发展十分重要。

目前，对于假冒伪劣产品的防治，集中在以下四个方面：一是促进对相关法律的建立和完善，二是加强对相关法律的执行力度，三是出台更多的反仿冒政策，四是采取相关的反仿冒技术措施4。因此，通过一些技术手段的使用，使得假冒伪劣产品得到有效的鉴别，进而无法在市场上流通，成为我国目前高速发展的经济中需要针对性解决的问题。

在使用一些技术手段对假冒伪劣产品现象进行治理时，如果仅仅只是简单地对产品的信息进行验证，而不采取一定的防伪措施的话，那么就无法从根源上对假冒伪劣产品进行打击。近年来，随着移动互联网的发展和普及，利用移动互联网进行防伪验证的手段以其可靠有效和易于操作等被广泛应用于产品防伪领域。通过移动互联网的连接，消费者可以很方便地检验产品真伪，而政府和企业则可以有效地进行假冒伪劣产品的打假活动。因此，从产品生产的源头出发，充分利用好移动互联网技术，找到一种简单有效的防伪解决方案变得越来越重要。而这，也是本课题研究所努力的方向。

# 1.2国内外研究现状

# 1.2.1防伪技术的国内外研究现状

防伪主要指为了避免出现假冒伪劣品，对产品或者商品采取的一种主动的保护措施，而防伪技术则是为了达到这个目的而产生的相关技术手段。目前国内外所采取的防伪技术主要包含以下几类：

# （1）雕刻印刷防伪技术

雕刻印刷防伪作为一种传统的印刷防伪技术手段，大多应用于各国的纸币制造中[5]。其防伪的主要方式是通过触摸其表面而带来的明显凹凸感。同时，由于特殊工艺的采用，其表面的凹凸感具备一定的稳定性，即不容易随着外界的改变而改变回。而且，由于纸币的普及，这种防伪方式具有一定的认可度，人们也很容易通过这种方式辨别真伪。

雕刻印刷防伪具有很长的历史，在我们日常生活之中，这种防伪方式具有不可代替的作用。一方面，雕刻印刷往往对于印刷仪器有着极高要求且价格昂贵，这使得仿造者难以去加以仿造；另一方面，在我国雕刻印刷设备属于专控设备，个人或者企业很难去获得相关设备，进而一定程度上保护了其产品不被仿造者进行仿造。

# （2）油墨水印防伪技术

在油墨水印防伪技术中，其组成部分中的防伪油墨是其中比较重要的一部分。防伪油墨是具备防伪特性的油墨，它可以在一定条件下产生一定的变化，从而显示出可见或者不可见的图形，即达到防伪的效果。这种防伪方式由于其操作简单和成本低，因此广泛应用于票证和产品包装中。

在传统的油墨水印防伪技术中，常见的做法是在普通油墨中添加具有防伪特性的材料，从而使得油墨也具有防伪功能。但是这种做法具备一定的弊端，当特殊材料和比例被破解后，便很容易被仿造者仿造。因此，随着时代的发展，另一种防伪方法被人们提出，即用多种材料与油墨发生反应，进而使得油墨同样具有防伪功能，在这种方法中，一定程度上增加了仿造难度[8]。

# （3）激光全息防伪技术

激光全息防伪又称之为激光防伪，它起源于上个世纪80年代。激光全息防伪主要是利用激光全息的原理，以很快的速度对成像物体的材料和相关印刷设备进行复制9。激光全息防伪的成像图不仅可以很好的还原物体本身，还可以从不同角度形成的不同颜色对物体进行全方面的观察。

激光全息防伪在具备防伪功能的同时，由于其颜色的多样性使得其具备一定的装饰功能。同时，激光全息防伪所使用的纸张可以被降解并且对环境的影响较小，识别过程较为简单，因此被普遍使用在一般防伪之中。

# （4）电码查询防伪技术

电码查询防伪技术是依靠于计算机网络的一种综合性防伪技术[0]。这种防伪技术先是为每一个生产的产品随机提供一个编码，编码与产品是一一对应的，且具有唯一性，同时将产品的编码存放在数据库之中。当用户购买到相关产品时，只需要通过互联网或者电话上传产品的防伪产品编码，数据库便可以通过比对，判断产品的真伪，进而告诉用户[]。因此，在电码查询防伪技术中，编码与产品的一一对应性，使得伪造者很难去仿造。

同时，在这种技术手段中，防伪编码的查询具备一次性，即当第一次进行防伪查询之后，数据库会记录查询的时间和产品等信息。当用户进行第二次查询时，数据库会告诉用户查询码已经被使用的事实，这样做可以防止伪造者对同一编码的多次伪造。而编码的产生虽然是随机的，但是因为其组合种类的海量性，伪造者也无法通过随意编造编码进行验证。

# （5）RFID(Radio FrequencyIdentification)防伪技术

RFID技术是上世纪90年代开始应用的一种自动识别无线技术，也被称作为射频识别技术。这种技术能够利用射频信号对标签自动识别并获得相应的信息。由于RFID 技术具有高可靠性，高安全性和高抗干扰性等优点，并且可以高速识别运动对象和同时识别多个目标，它被应用于状态识别和防伪等各个领域[2]。

当RFID技术应用于防伪时，它可以给每个产品（不仅仅是产品的类型）提供唯一标识符[13]。与此同时，RFID 读取设备可以同时读取上百个类似的唯一标识符。许许多多的行业都在使用RFID技术的这些特性来提高追踪与产品相关的各种信息。例如，政府和药企都会利用RFID技术对政府文件和药品等进行防伪。特别是对于奢侈品产品的防伪来说，企业制造商会记录其运送的每一个RFID标签产品的唯一标识符。

相比较于传统防伪机制（如印刷，墨水等)，RFID技术无疑更具备优势。RFID技术并不需要观察或者与直接接触产品便可以读取其防伪信息。

# 1.2.2现存防伪技术存在的主要问题

目前广泛应用的各种防伪技术，每一种都会随着社会需求的变化而不断更新。然而，面对消费者对于有效可靠的防伪技术的诉求，各种防伪技术解决方案都存在着一定的漏洞和不足之处。这些防伪技术都无法满足在实际生活中的最普遍防伪需求。其主要存在的问题如下：

（1）防伪过程中的材料等成本较高

在目前所采用的防伪技术中，一些防伪技术虽然具备一定的防伪效果，但是由于防伪材料或者设备的高昂，防伪成本会呈现大幅度增加。比如，以雕刻印刷防伪技术为例，生产者在使用这种防伪技术时，不仅要得到政府的审批，还需要购买价格昂贵的雕刻印刷设备和印刷材料。

（2）防伪技术程度不高，易仿造

以油墨水印防伪和激光全息防伪为例，这两种防伪技术虽然有着成本低和易于防伪识别的优点，但是正是因为这样的优点，使得这两种防伪技术极易被伪造。这两种防伪技术缺少一定的唯一性，因此当防伪产品被伪造时，消费者很难去对正品进行识别。即使在油墨防伪中，采用更高科技的防伪特性材料，仿造者也很容易去进行伪造，且这种方式也在无形中增加了成本。

（3）防伪操作复杂，消费者无法直接判断

部分防伪技术方式因为采用与互联网技术和芯片技术相结合的方式，使得其防伪效果更加的准确。以RFID防伪和电码查询防伪为例，前者采用与射频芯片相结合的方式，后者则依靠互联网系统进行验证防伪。然而，在实际应用中，前者会因为成本的原因无法大规模使用，而且在进行防伪验证时，还需要特殊的读取设备，从而增加了用户的操作实现难度；而后者虽然使用互联网进行查询，消费者在验证过程中还需要进行一系列复杂的验证操作，无法从防伪表面上得到防伪信息。

（4）无法做到真正的防伪防“复制”

除了上述常用的几类防伪方式之外，日常生活中还有其他几种防伪技术方式被提出使用。例如，使用特殊加密防伪算法的二维码防伪技术，然而这种防伪技术无法防止防伪标识被复制的情况。虽然，某些解决方案能够解决防伪图案被打印的问题，但是依旧无法从根本上解决防伪标识被复制（例如，使用相机进行拍摄伪造）的问题。

综上所述，目前所采用的主流防伪技术在不同方面上都无法满足生产者或者消费者的常用防伪需求，即人们需要一种成本低，不易仿造，防伪验证简单，能够精确给出防伪验证结果和实现真正的防复制的防伪技术解决方案。

# 1.3本文主要内容及结构安排

# 1.3.1本文主要内容

为了解决上述防伪技术中的不足，做到有效可靠，且低成本，本文提出了一种基于图像处理的随机涂层二维码防伪技术。该技术主要是将含有随机颜色颗粒的透明涂层附着在二维码表面，其图形结构截面图如图1.1所示。

![](images/d6a9ebf4db2024e0edf9bd09b1abafd7ea5283be4d87530e048a758d926326cb.jpg)  
图1.1包含随机涂层的二维码横截面

在图1.1中，二维码表面覆盖着一层含有有色颗粒的透明涂层，并以此共同构成一个新的二维码防伪标签。当需要进行防伪验证时，用户通过手机从不同角度拍摄防伪标签，在图像处理技术的支持下，提取标签中有色颗粒在不同角度下的特征信息，并将其与服务器中特征信息数据进行对比验证，进而达到防伪的目的。在实际应用中，该技术可以完全解决防伪标签被复制的问题，同时用户可以通过手机验证进行直观的判断。

本文的具体研究内容如下：

（1）防伪技术的国内外研究现状

通过对国内外主要防伪技术的研究进行介绍，总结出目前防伪技术存在的主要问题，最后得出目前市场上需要一种成本低，高效可靠的防伪技术解决方案。

# （2）防伪系统的技术实现

对本课题提出的随机涂层二维码防伪技术进行概述和技术上实现的具体分析。文中首先对本文提出的随机涂层二维码防伪原理及构成做详细介绍，同时分别阐述

了防伪技术中使用的二维码坐标系重建技术和随机涂层轮廓点提取技术，最后在上述技术实现的基础上，介绍了本研究课题防伪技术的核心，即防伪标签特征矢量提取技术。

# （3）防伪系统的需求和可行性分析

通过对比现今主要存在的几种防伪解决方案，对防伪系统进行各种需求分析。介绍了随机涂层二维码防伪系统的设计方案，并对方案进行可行性分析。

# （4）防伪系统的系统模块设计实现和测试

通过对随机涂层二维码防伪技术系统的需求分析和可行性分析，总结出新防伪系统的系统设计方案和系统中各个模块的具体设计方案，并对相关的具体设计进行了技术上的实现。最后对随机涂层二维码防伪系统的模块和整体进行测试。

# 1.3.2论文结构安排

本文主要分为7个章节，章节的内容结构大致如下：

第一章：论述了本文的研究背景与意义，同时对防伪技术的国内外研究现状进行了具体介绍，指出了其中的不足之处，并提出了基于图像处理的随机涂层二维码防伪技术解决方案，最后对提出的防伪技术解决方案的具体内容和结构安排进行了阐述。

第二章：主要对本课题研究过程中涉及到的相关技术基础知识进行介绍，其中包括二维码基础知识和常用的图像处理相关基础知识。同时，针对课题研究的需求，在介绍相关图像处理基础知识的同时，阐述了本课题对于图像处理技术中相关技术的选择。

第三章：详细介绍了随机涂层二维码防伪技术的相关研究，包括其防伪原理，随机涂层结构，以及防伪技术研究中，主要采用的技术及其实现。

第四章：首先对常见防伪方案进行了介绍，然后进一步阐述了防伪系统的需求分析。最后，给出本课题提出防伪方式的设计方案，并对上述方案进行可行性分析。

第五章：主要对随机涂层二维码防伪系统的系统设计和各个模块设计进行了介绍，并给出了相应的实现方式。

第六章：重点对上一章介绍的设计和实现进行了测试，验证系统的可行性。同时，在测试过程中，对防伪系统的准确度进行了针对性测试，并介绍了系统在不同光照条件下和不同设备之间的测试结果。

第七章：主要对本论文的研究内容进行了总结，对本论文的不足之处和需要改进的地方进行了反思，同时对本论文所涉及技术的前景与发展做出了展望。

# 第2章相关理论基础介绍

# 2.1二维码理论基础

# 2.1.1二维码概述

条形码作为一种新兴产业技术，它是在信息技术高速发展的前提下产生和发展而来的。条形码表示的是光学机器可读的数据，对于传统一维条形码来说，它主要是通过不同宽度的平行线和平行线之间的间距表示数据[14]。目前在人们的平常生活中，产品包装中所印刷的条形码大部分都包含了传统的一维条形码。同时，它被广泛应用于图书管理，商业，运输等各个领域，极大地方便了人们的生产和生活[5]。

而随着条形码应用领域的增加，一般的一维条形码早已无法满足人们的需求。一维条形码在通常情况下仅只包含几个或数十个数字或字母，其信息容量很小[6]。即使在某种特殊情况下需要用一维码记录更多数据时，一维码也会因为数据的增加而增加其本身尺寸。而且一维条形码无法存储例如汉字和图像等数据。正是由于上述这些因素，使得一维码在许多领域中不再适用。因此，才诞生了可以在垂直和水平维度上共同表达数据信息的二维码。

二维码是利用某些指定的黑白图形根据定义的规律在水平和垂直方向上分布的图形上储存数据符号信息[17]。二维码大多根据其编码方式和结构区别分成二维矩阵式条码和二维堆叠式条码两种。在实际应用中，二维码的种类主要包含堆叠式二维码和矩阵式二维码两种[I8]。常见的堆叠式二维码包括Code49 和PDF417，而常见的矩阵式二维码则包括DataMatrix和QR码。其中，QR码由于拥有同等条件下的最大容量，所以被广泛应用于各个领域。因此，为了课题研究的实用性和针对性，在本课题中所提到的二维码对象均为QR码。图2.1显示出几种常见的二维码。

![](images/3e9800267a22dafd1f8570d262c11519c8158f1445299c379a8e18233c9a10c3.jpg)  
图2.1几种常见的二维码

# 2.1.2 QR码

QR码是QuickResponseCode（快速响应代码）的缩写，它是机器可读的光学标签，其中包含相关项目或者产品信息。QR码是由丰田子公司DensoWave在1994年发明的，最初用于跟踪汽车零件制造中的库存[19]。虽然QR码专为跟踪汽车制造中的零件而开发，但是随着技术的发展，目前已经广泛应用于许多其他领域，用户不仅可以通过QR码对文字数据进行快速交换，还可以利用其链接网站并进行内容下载，同时，QR码还具有用户身份鉴定和商务交易等功能。

QR 码主要是由白色背景上以正方形图案排列的黑白模块组成，而编码的信息可以是文本，图片等其他信息[2]。QR 码正是由于其允许内容被高速解码，其被广泛应用于全世界的各个领域当中。QR码系统组成，主要包含QR码编码器和QR 码解码器，编码器负责编码数据并生成QR码，而解码器负责从QR码中解码数据，其主要结构如图2.2所示。

![](images/10d94300e30adcf718ad2b27e5310c8c0cdd2a3b3360b738a657eef663ec9637.jpg)  
图2.2QR码系统构造

对于每一个QR码符号来说，它主要是由规则的正方形阵列排列的正方形模块建立的，并且包含功能图案和编码区域[2]。功能图案主要是确保二维码扫描设备能够正确识别出要解码的代码，其必须放置在特定的区域位置。功能图案包含以下四个部分，分别是探测图案，分隔符，定位图案和校正图案。编码区域则是包含纠错码字等众多信息。图2.3给出了QR码的具体结构。

![](images/5394865e12c5035fc520a29520ace064d3f9e783129044f7cff74b74fea87457.jpg)  
图2.3QR码符号结构

根据图2.3，我们对QR码符号结构中，主要部分的介绍如下：

（1）探测图案

探测图案主要是处于二维码图形的左上，左下和右上三个位置的特殊探测图形。它的主体包含一个 $7 \mathrm { x } 7$ 模块的外部黑色正方形，一个5x5模块的内部正方形和一个3x3的黑色实心正方形，其模块宽度比例为1:1:3:1:1，如下图2.4所示[22]。

A:3模块 B:5模块 C:7模块

![](images/a6312e28ab2c6656737b5b7da61916a2f9f83d60d0c812a70b81d51e9dd80d12.jpg)  
图2.4QR码探测图案结构

探测图案主要作用是为了确保二维码扫描设备在扫描QR码时，能够正确的定位到QR码图案。

（2）分隔符

分隔符是每个探测图案与编码区域之间的空白区域，主要起到的是分开两个区域的作用。

（3）定位图案

定位图案主要包含水平定位图案和垂直定位图案，它主要是由黑白交替的图案组成，其主要作用是帮助确定符号密度，模块坐标和版本信息区域。

# （4）校正图案

校正图案主要是由5x5的外部黑色图案包含3x3的外部白色图案，以及其内部的黑色单独图案共同构成。校正图案的数量主要与符号的版本相关。

# （5）编码区域

编码区域主要是包含格式信息，版本信息，数据和纠错码，它是二维码组成中最重要的一部分。

QR 码在实际生活应用当中，包含多个符号版本，其符号版本范围主要是版本1到版本40，不同的版本拥有不同的模块数量。从QR码的外在表现来看，即包含不同的黑白点数量。图2.5显示了版本1与版本2的主要外形。在本课题中，为了研究的针对性，课题采用了广泛使用的版本2作为研究对象。

![](images/10b2869b870f9aa7ad1f3c4a570060b6cc5322105cb802480565595673ed407f.jpg)  
图2.5常见QR码版本外形  
图2.6纠错等级

在QR码的结构中，其最大的特性是引用了纠错码字，从而来提高自己系统的稳定性[23]。QR码在添加完这些纠错码字之后，使得QR码在被损坏一部分之后，依然能够被成功地读取正确的结果。QR码的纠错码字的选择是多样的，使用者可以通过考虑QR码的不同使用环境选择不同级别的纠错，图2.6显示了几种可供选择的纠错级别（级别越高，代表了纠错能力越高）。

<html><body><table><tr><td>编号</td><td>水平等级</td><td>错误修正容量</td></tr><tr><td>1</td><td>L</td><td>7%</td></tr><tr><td></td><td>M</td><td>15%</td></tr><tr><td>3</td><td>Q</td><td>25%</td></tr><tr><td>4</td><td>H</td><td>30%</td></tr></table></body></html>

综合上文所述，我们可以发现，QR码主要具备以下几个方面的优点：

（1）从QR码的本身

QR码作为一种能够存储数据的方式，它能够做到占用的空间体积很小。相比较于一般一维码来说，在包含相同数量数据的条件下，QR码能够做到只拥有一般一维码的十分之一的空间。而且，QR码具有很高的数据存储容量，同样相比较于一般二维码，一个QR码符号是同等条件下一般一维码数据存储容量的200倍。并且，QR码可以处理各种数据类型，包含数字，字母，中文等，与此同时，QR码具有一定的纠错能力，即使其表面的 $30 \%$ 区域损坏，它依然能够解码出正确的结果。

# （2）从QR码的使用

QR 码能够被容易地制作出来，任何人都可以根据自己的需求制作符合自己要求的QR码。而且，QR码在实际使用时，用户可以从各个角度对其进行扫描，即不需要正对QR码进行扫描操作，即可快速地得到正确的扫描结果。而正是由于上述的这些优点，QR码被广泛应用于生活中的各个领域，如商品包装，广告网站，金融交易等。

# 2.2图像处理理论基础

# 2.2.1图像去噪

图像去噪主要是通过噪声滤波器实现的，选择不同的滤波器，对于图像本身来说有着不同的去噪效果。目前图像去噪方法根据不同的处理对象，可以分为空间域滤波法以及频域滤波法两种[24]。而在本课题研究过程中，为了简化研究过程，本文主要采用空间域法对图像进行去噪处理。同时在空间域滤波法中，比较常用的滤波方法为均值滤波去噪方式和中值滤波去噪方式。其中，前者滤波方法属于线性滤波方式，而后者滤波方式则属于非线性滤波方式。

# （1）均值滤波

均值滤波是线性滤波器算法中比较简单易行的一种滤波方法，其对于高斯噪声有着良好的平滑效果。均值滤波算法又称作为邻域平均法，这种方法的主要思想是每个像素的灰度值用像素的邻域像素灰度值的平均代替。在均值滤波中，邻域的选择通常用单位距离为 $\Delta L$ ，半径分别为 $r = \Delta L$ 和 $r = { \sqrt { 2 } } \Delta L$ 的4邻域和8邻域构成[5],如图2.7所示。

![](images/156718e927386a931080a948decaa6b1d7922f890690d3f4c48966c3137e89e0.jpg)  
图2.7均值滤波的4邻域和8邻域

在式2.1中，表示均值滤波中像素灰度值的计算。式中， $g ( m , n )$ 为滤波后的图像， $M$ 表示系统邻域中的像素点总个数， $s$ 为像素点的邻域，而 $f ( m , n )$ 则表示滤波处理前的图像。

$$
\begin{array} { r } { g ( m , n ) = \frac { 1 } { M } \sum _ { f \in s } f ( m , n ) } \end{array}
$$

均值滤波的去噪效果往往对于脉冲信号比较敏感，但是当其处理平滑图像的噪声时，会因为均值滤波器本身的结构缺陷使得图像细节被模糊。均值滤波的图像去噪效果，如图2.8所示。

![](images/08c4e269d1190808bcb44da265a405b6a0a784b56c9fa6017c93896f65b6ca34.jpg)  
图2.8均值滤波效果对比

（2）中值滤波

中值滤波最开始是在1971年由Turky首次提出，而在当时中值滤波主要是用于时间序列分析，直到后来慢慢发展到应用于图像处理中的去噪。中值滤波器是用于消除图像噪声的非线性滤波器，其基本原理可以表述为用数字图像中心点邻域的中值代替该位置点的值[26]。

中值表示将一组数按照从小到大的顺序排列[27]，通过公式2.2 计算得出的Median $( P )$ 。假设这组数为 $P _ { 1 } , P _ { 2 } , P _ { 3 } , \ldots \ldots , P _ { n }$ ，顺序排列为 $P _ { 1 } ^ { \prime } \leq P _ { 2 } ^ { \prime } \leq P _ { 3 } ^ { \prime } \leq \dots \leq P _ { n } ^ { \prime }$ 。

$$
M e d i a n ( P ) = M e d \{ P _ { 1 } , P _ { 2 } , P _ { 3 } , \ldots , P _ { n } \}
$$

$$
= \binom { P _ { k + 1 } ^ { \prime } , n = 2 k + 1 } { \frac { 1 } { 2 } [ P _ { k } ^ { \prime } + P _ { k + 1 } ^ { \prime } ] , n = 2 k }
$$

将上述一维中值滤波推广到二维，则可以得出二维中值滤波算法，即应用于图像中的中值滤波算法。

$$
f ( i , j ) = M e d i a n \{ f ( m , n ) | f ( m , n ) \in N _ { f ( i , j ) } \}
$$

在式(2.3)当中， $f ( m , n )$ 为邻域中像素点灰度值， $N _ { f ( i , j ) }$ 表示 $f ( i , j )$ 的邻域。

通过上述的操作之后，图像中邻域系统内像素值相差较大的点被处理，使得其逼近周围像素值，从而去除很多孤立像素点。在本课题研究中，其滤波效果如图2.9所示。

![](images/14e3f02aaa975bc55b4cf2d52890c46b839f4a42cc26c3055fbcb85245768515.jpg)  
图2.9中值滤波效果对比

综合比较两种去噪方式，可以发现中值滤波效果比均值滤波效果更好。因此，在本课题研究中，采取中值滤波作为图像去噪方式进行图像进行预处理。

在图像经过中值滤波进行去噪处理后，需要从处理后的图像中找到有用信息为测量防伪系统的红色斑点重心坐标提供研究条件。作为图像最基本特征之一的图像分割，一般情况下包含了大量的图像信息。

# 2.2.2图像分割

图像分割是一种比较重要的图像处理技术。图像分割就是按照一定的特征，比如颜色、纹理和像素灰度等，将图像分为不同区域，并提取感兴趣目标的技术。在实际应用中，图像分割就是将目标从图像背景中分割出来。目前，随着图像处理技术的不断发展，图像分割技术也是呈现出多样化的趋势。在本课题的研究过程中，主要是针对彩色图像进行分割，而彩色灰度图像分割主要是由颜色空间和灰度图像分割方法共同构成[28]。颜色空间指的是构成图像的颜色空间选择，常用的有RGB，HIS等，而灰度图像分割方法主要的类别包含三种形式：阈值分割、边缘检测和区域增长。

在我们的白常生活中，人眼所能感知的颜色通常由RGB颜色构成，其中R代表红色，G代表绿色，B代表蓝色。RGB颜色空间一般只适用于显示系统之中，且由于其空间中三个分量相关度较高，因此不适用于图像分割之中。同时，利用线性或者非线性关系可以将RGB颜色空间转化为其他颜色空间[29]。目前，对于常见的线性空间包含YUV和YIQ等颜色空间，而常见的非线性空间则包含HSI和CIE等颜色空间[30]。

# （1）基于阈值的图像分割法

在采用阈值分割法处理图像时，如果图像中某个像素的值大于固定的阈值，（通常情况是对象相比较于背景来说，更加的明亮)，那么就将这个像素标记为对象，反之，则将其标记为背景。因此，在使用阈值对图像进行分割时，最重要一点是按照一点的规则合理地选择最佳的分割阈值[31]。

根据上文表述可知，RGB颜色空间并不适用于图像分割。而在本文的研究过程中，主要任务是将红色区域与其他颜色背景分割开，因此在颜色空间的选择上，本文采取非线性空间中的HSV颜色空间（HSV颜色空间为HIS颜色空间的变形）。

<html><body><table><tr><td></td><td>黑色</td><td>灰色</td><td>白色</td><td colspan="2">红色</td><td>色</td><td>黄色</td><td>绿色</td><td>青色</td><td>蓝色</td><td>紫色</td></tr><tr><td>Hmin</td><td>0</td><td>0</td><td>0</td><td>0</td><td>156</td><td>11</td><td>26</td><td>35</td><td>78</td><td>100</td><td>125</td></tr><tr><td>Hmax</td><td>180</td><td>180</td><td>180</td><td>10</td><td>180</td><td>25</td><td>34</td><td>77</td><td>99</td><td>124</td><td>155</td></tr><tr><td>Smn</td><td>0</td><td>0</td><td>0</td><td colspan="2">43</td><td>43</td><td>43</td><td>43</td><td>43</td><td>43</td><td>43</td></tr><tr><td>Snmax</td><td>255</td><td>43</td><td>30</td><td colspan="2">255</td><td>255</td><td>255</td><td>255</td><td>255</td><td>255</td><td>255</td></tr><tr><td>Vmn</td><td>0</td><td>46</td><td>221</td><td colspan="2">46</td><td>46</td><td>46</td><td>46</td><td>46</td><td>46</td><td>46</td></tr><tr><td>Vmax</td><td>46</td><td>220</td><td>255</td><td colspan="2">255</td><td>255</td><td>255</td><td>255</td><td>255</td><td>255</td><td>255</td></tr></table></body></html>

图2.10HSV颜色空间范围划分

在HSV颜色空间中，H表示色调，即颜色的特性，其用角度进行度量，取值范围为 $0 \sim 3 6 0$ ，以红色为起始点，按照顺时针方向，则0表示红色，240表示蓝色，120表示绿色；S代表饱和度，即颜色的饱和信息，值越大，颜色越饱和；V代表亮度，即明暗信息，值越大，色彩越明亮[32]。HSV颜色空间与人眼所看到的颜色感知基本一样，能够很好地对不同颜色进行区分。因此，在本文研究中，主要通过合理地设置HSV颜色空间阈值，从而对图像进行颜色分割。

![](images/e59faf4473f2e25793db42c64d46fb78ccad916ab003171d4b75a27c9c1d06e2.jpg)  
图2.11阈值分割效果对比

# （2）基于边缘检测的图像分割法

边缘检测的方法主要利用的是不同区域之间边缘上的像素点灰度值会发生剧烈的变化。这种边缘点上灰度值的变化，可以通过计算其导数来检测。对于阶跃形式的图像边缘，可以通过其对应的一阶导数进行检测，而微分算子常被用作检测之中[33]。

在实际的边缘检测中，常用的边缘检测算子包括Canny算子,Sobel算子，Roberts算子和Prewitt算子等。其中，Canny 算子是高斯函数的一阶导数，它能够很好地平衡噪声抑制和边缘检测[34]。虽然，边缘检测主要面对的是灰度值图像，但是彩色图像相比较于灰度值图像来说，具有更加丰富的边缘信息。因此，其同样适用于彩色图像的图像分割问题。在本课题研究中，其图像分割效果如图2.12所示。

![](images/7d647fab819d4f2eff0a149a4d67c003b5440427574ddf67863db3e19cb2f262.jpg)

图2.12边缘检测分割效果对比

（3）基于区域增长的图像分割法

在采用区域增长的方法进行图像分割时，主要是检查初始“种子点”的相邻像素，并对相邻像素是否加入区域之中进行判断。在使用这种方法时，需要先找到一个种子像素作为每个图像分割的起点，然后将像素的相似属性与种子像素区域周围的种子像素合并到种子像素域之中，最后继续这个过程，从而使得区域增大[35]。

然而，在采用基于区域增长的图像分割法进行图像分割时，往往会出现分割出的区域过多或者过少的情况[3]。因此，为了尽可能避免这种情况的发生，本文提出了阈值分析和区域增长相结合的图像分割方式。在实际图像分割方法应用中，先利用基于阈值的图像分割法分割出有色区域（红色小斑点)，然后计算区域的几何中心，并将几何中心值作为区域增长图像分割中的种子点，最后得到区域增长后的分割图像。在本课题研究中，其图像分割效果如图2.13所示。

![](images/f5c8f1498f2dad0d919d6f988763e8516fbf95d9e5f65a40b0098ec64621d160.jpg)

图2.13区域增长分割效果对比

通过综合分析三种图像分割法，可以发现基于边缘的图像分割方法，在实际应用中，其分割得出的图像往往会在实际图像没有边缘的地方出现边缘；而基于阈值分割的图像分割法得出的图像有时会丢失部分信息；同时，单独的基于区域增长的图像分割法会有区域分割错误的情况。因此，在综合各种图像分割方式之后，选择采用基于阈值的图像分割方法和基于区域增长的图像分割法相结合的方式，从而得到最佳图像分割效果。

# 2.2.3透视变换

透视变换(PerspectiveTransformation)也被称为投影映射，它主要是将图片图像投影到另外一个新的平面，从而形成一个新的图像 $[ 3 7 ]$ 。其主要的变换公式可以总结为式2.4所示。

$$
[ m ^ { \prime } , n ^ { \prime } , t ^ { \prime } ] = [ u , v , t ] \left[ { \begin{array} { l l l } { A _ { 1 1 } } & { A _ { 1 2 } } & { A _ { 1 3 } } \\ { A _ { 2 1 } } & { A _ { 2 2 } } & { A _ { 2 3 } } \\ { A _ { 3 1 } } & { A _ { 3 2 } } & { A _ { 3 3 } } \end{array} } \right]
$$

在上式中， $u , v$ 表示原始图像坐标，而变换后的图像坐标用 ${ \pmb m } , { \pmb n }$ 表示，其中$m = { \frac { m ^ { \prime } } { t ^ { \prime } } } , n = { \frac { n ^ { \prime } } { t ^ { \prime } } } \circ$

对于矩阵 $\equiv { \left[ \begin{array} { l l l } { A _ { 1 1 } } & { A _ { 1 2 } } & { A _ { 1 3 } } \\ { A _ { 2 1 } } & { A _ { 2 2 } } & { A _ { 2 3 } } \\ { A _ { 3 1 } } & { A _ { 3 2 } } & { A _ { 3 3 } } \end{array} \right] } .$ 来说，我们可以将其分为四个部分，这四个部分分别为：代表缩放和旋转等线性变换的 $\begin{array}{c} \begin{array} { r l } { \left[ { A _ { 1 1 } } & { { A _ { 1 2 } } } \\ { { A _ { 2 1 } } } & { { A _ { 2 2 } } } \end{array} \right] } \end{array}$ ，代表平移的 $[ A _ { 3 1 } \quad A _ { 3 2 } ]$ ，代表透视变换的$[ A _ { 1 3 } \quad A _ { 2 3 } ] ^ { T }$ ，代表系数的 $A _ { 3 3 }$ 。对公式3.2进行进一步的重写，我们可以得出公式2.5。

$$
m = \frac { m ^ { \prime } } { t ^ { \prime } } = \frac { A _ { 1 1 } u + A _ { 2 1 } v + A _ { 3 1 } } { A _ { 1 3 } u + A _ { 2 3 } v + A _ { 3 3 } }
$$

$$
\begin{array} { r } { n = \frac { n ^ { \prime } } { t ^ { \prime } } = \frac { A _ { 1 2 } u + A _ { 2 2 } v + A _ { 3 2 } } { A _ { 1 3 } u + A _ { 2 3 } v + A _ { 3 3 } } } \end{array}
$$

因此，我们可以通过几个变换前后的已知点得到变换公式[38。同时，固定的变换公式可以让我们得到变换后的图像。

# 2.3本章小结

本章主要是作为后续章节的理论基础，其中包括二维码的理论基础，主要对二维码进行了总结性介绍，并重点对-QR码的形成，图像结构和编码相关进行了阐述。同时，本章介绍了常用的几种图像处理技术，包括噪声抑制和图像分割，并对适用于本课题研究的图像处理技术进行了比较研究。最后，本章对透视变换的算法进行了阐述。

# 第3章随机涂层二维码防伪技术研究

# 3.1随机涂层二维码防伪概述

# 3.1.1随机涂层二维码防伪原理

防伪标签能够有效防伪需要有两个基本的条件，第一是防伪标签具有不可复制性，第二是防伪标签能够被认证，而目前的防伪方法都不能很好的同时具备这两个要素。本文提出的基于图像处理的随机涂层二维码防伪标签，可以同时具备有效防伪的两个基本条件。

随机涂层二维码防伪标签采用在打印好的二维码上随机刷涂的方法制作具有不可复制性的防伪标签。刷涂的材料采用有色颗粒混合透明层（在本课题研究中，有色颗粒采用红色颗粒)，透明涂层中有色颗粒悬浮在二维码的上方，从不同的角度拍摄，可以形成不同的包含有色颗粒的二维码图案。其主要结构如图3.1所示，图3.1中的有色颗粒为悬浮在二维码上面的红色斑点。

有色颗粒高

同时，二维码具有一定的纠错能力。当满足二维码上的遮盖区域不包含二维码的三个大定位标（即左上，右上，左下三个定位标)，并且遮盖所产生的错误量小于二维码本身的纠错容量（一般二维码的纠错容量为二维码被污损三分之一左右），此时二维码可以被准确无误地识别出来。

生产者在产品上粘贴随机涂层二维码防伪标签后用相机至少从两个角度拍摄该二维码，提取出二维码的基本信息后，还要提取悬浮有色颗粒的特征信息。

![](images/9295164dfba34ab5d9dc14c58366587f7a500592d4ed1abf2c00c2a5eadeaee2.jpg)  
图3.2不同角度特征信息提取

如图3.2所示，随机涂层二维码的防伪信息主要通过从不同角度对二维码的特征信息提取得出，其具体介绍如下：

（1)在特征信息的提取中，我们需要至少在两个角度上存储上述信息，如图3.2所示，从P，P1，P2三个角度对二维码D的信息进行提取。在每个角度上，找到每个悬浮颗粒的像素重心相对于二维码三个定位标的位置，并把它们记录下来。计算每个悬浮颗粒的大小和边界信息。这些记录的信息作为特征矢量，存储到服务器上。至于计算悬浮颗粒的大小和边界信息主要是通过图像处理的办法实现的。二维码本身的颜色通常为黑白色，而悬浮的有色颗粒在本文研究中假设为红色，在这种情况下我们就可以通过对图像单个像素进行处理，并进行二值化，这样我们就可以将悬浮有色颗粒的轮廓提取出来，最后再通过轮廓提取算法将轮廓的坐标信息全部返回出来，同时建立轮廓相对于二维码位置的相对坐标系，并最终得出轮廓即悬浮颗粒的大小和边界信息。

（2）当用户获得包含随机涂层二维码防伪标签的产品后，用户需要用手机指定的app 对二维码进行拍摄，该app会引导用户在指定的角度拍摄，app提取和服务器端同样的特征矢量，使用二维码特征信息作为索引，与服务器端的特征信息进行匹配。从而判断得出二维码的真伪，即判断出产品的真伪，进而达到防伪的日的。

# 3.1.2随机涂层二维码防伪构成

通过上述对于随机涂层二维码防伪技术原理的介绍，本文进一步提出此防伪技术的主要流程，如图3.3所示。

![](images/6dd5ed85b253dd9d49f3a523966bbdd07d204ed621e1ea0be970e0ab5f32eee0.jpg)  
图3.3基于图像处理的随机涂层二维码防伪系统流程图

根据图3.3所示，此防伪技术首先利用手机等拍摄设备，通过拍摄视频图像进行图像采集，采集后的图像再经过滤波去噪处理，形成初始图像文件。此时，初始图像文件将经过两方面的操作，一方面，初始图像文件经过图像截取、图像分割和轮廓点识别操作后，形成随机涂层的轮廓点相对于初始图像的坐标点；另一方面，初始图像经过二维码标定处理后，利用透视变换，在求出透视变换矩阵的同时得出二维码坐标系（以二维码的单个黑白格宽度为单位）。然后，轮廓点（轮廓点是指图像中随机涂层的轮廓点）经过上述透视变换矩阵形成相对二维坐标系的轮廓点相对坐标值，最后，通过此相对坐标值得出其相对特征矢量，即随机涂层二维码防伪标签的特征矢量。

从以上流程图介绍可以看出，在整个防伪技术流程中，最重要的部分包含以下三个：第一是二维码的标定部分，这部分主要是为了建立二维码坐标系，以便后续相对坐标值的得出；第二是轮廓点的提取部分，这部分主要为了随机涂层信息的表示；第三则是从轮廓点相对坐标值中提取能表示其特征的特征矢量信息。下文将从以上三个部分进行介绍。

# 3.2基于图像处理的二维码坐标系研究

# 3.2.1二维码坐标系重建技术

在本文的课题研究中，二维码所起到的作用，除了能够正常识别以外，还需要通过二维码建立二维码的相对坐标系。而二维码坐标系的建立，主要有以下几种方式。

# （1）基于边缘检测的二维码坐标系构成

二维码通常是由黑白小方格组成，因此在二维码的灰度值图像中，其具有丰富的边缘信息，可以通过边缘检测的方式构建二维码坐标系图，常用的边缘检测方法包括Sobel算子和Reborts算子。但是，在实际使用中，图像所采集到的二维码图像往往是不规则的，即图像易发生形变，这就导致在使用边缘检测时，产生一定的误差。

# （2）基于条形码识别库ZXing的二维码坐标系构成

条形码生成和识别库ZXing是一个由谷歌开发的开源库，其主要用于二维码的编码生成和解码输出[39]。ZXing库不仅支持一维码如UPC-A、UPC-E和Code39等，还支持二维码如QRCode、DataMatrix 和PDF417等，同时，其支持的开发语言种类也十分的广泛，包含 $C { \ + } +$ 、Java和Python等。目前，在大多数移动端的条形码生成和扫描中，都会存在ZXing库的身影。因此，本研究课题采用基于条形码生成和识别库ZXing的方式，构建二维码坐标系。同时，在本课题研究中，为了研究更具代表性，主要针对QRCode的解码过程。

在ZXing库中，其二维码的识别流程可以归结为以下几步：

1、获得相机的一帧初始图像，将图像传递到函数中进行解析。

2、对传递过来的图像进行解析，如果解析不成功则退出，反之继续进行下一步。

3、退出并返回上述解析结果。

在ZXing库中，其开放的API接口虽然能够提供一些基本的条形码生成和扫描功能，但是对于本研究课题来说，无法从其开放的API接口中直接获取想要的数据。然而，考虑到QR码的识别实现原理，本文采用在原代码库的基础上，增加自己的二维码黑白格坐标点提取功能。

# 3.2.2实验及结果分析

在技术实现部分，本文以VisualStudio 2015、二维码开源库ZXing3.4.0 和计算机视觉库Opencv3.4.7构建整个软件编程环境。同时，实时采集二维码图像作为输入图像进行实验分析。其输出图像如图3.4所示。

![](images/18d8be69cde7896b8134609f5d6ca92be4f0eb942ce7c5c949be6b06dc1ca8f4.jpg)  
图3.4重建二维码输出图像

同时，在实验过程中为了验证其技术性能，本文通过在不同角度和不同光照影响下，实时采集100帧图像进行性能分析，其结果数据如表3.1所示。

表3.1技术试验结果  

<html><body><table><tr><td>识别率</td><td>平均耗时(ms)</td></tr><tr><td>0.99</td><td>52</td></tr></table></body></html>

在表3.1中，平均耗时指的是所有成功识别二维码图像并重建二维码坐标点的平均耗费时间。根据实验结果分析数据可知，在100帧图像中共有99帧图像识别成功，且识别的平均耗时为 $5 2 \mathrm { m s }$ ，则该方法识别率高，其识别成功所花费的时间较短，满足本技术的要求。

# 3.3基于图像处理的随机涂层研究

# 3.3.1随机涂层轮廊点提取

通过第二章的介绍可以得知，图像中表示随机涂层的小红斑点主要通过图像分割的方式进行提取，而图像分割的方式则采用基于阈值的图像分割法和基于区域增长的图像分割法相结合的方式。而在图像分割之前，我们需要首先进行二维码图像区域截取，即从整个完整原始图像中，截取出二维码区域图像，其截取的原理主要利用上文所提取的二维码黑白方格坐标点进行，图3.5所示，表示采集图像和截取二维码区域后的图像。

![](images/0a6eb0aba70c34aa9614c439b9542dd0c434cb59b25e085fe3342bda73546cea.jpg)  
图3.5原始图像和分割二维码区域图像

在二维码区域图像截取完成之后，即开始进行图像分割处理，提取红色斑点区域。处理后的图像主要为二值化图像，即黑色表示背景区域，白色表示红色斑点区域。此时，下一步处理需要从上述二值化图像中，提取出白色区域的轮廓点坐标，即红色斑点的轮廓坐标，这里主要采用图像的轮廓检测算法进行处理，其算法基本原理如下。

在轮廓检测算法中，利用编码的思想，用不同的整数值来表示不同的边界，进而可以确定其轮廓层次关系和边界类型。在算法处理中，其输入图像为二值化图像，即以0和1表示像素值的图像，在图像的整体扫描过程中，当遇到以下情形时停止扫描（用 $g ( m , n )$ 表示图像像素值）：

（1） $g ( m , n )$ 为内边界的起始点，即 $g ( m , n - 1 ) = 0 , g ( m , n ) = 1 ;$ （2） $g ( m , n )$ 为外边界的起始点，即 $g ( m , n + 1 ) = 0 , g ( m , n ) > = 1$

同时，从起始点开始，记录边界上的像素点位置信息。而对于发现的不同边界来说，用标识符NBD来唯一表示，NBD的个数即为边界点的个数。而在扫描过程中遇到右边界点时，即 $g ( m , n + 1 ) = 0 , g ( m , n ) = 1$ ，需要将右边节点像素值重置为-NBD。

通过轮廓检测算法的处理，可以很容易得到斑点区域的轮廓坐标点值，此坐标点值主要为后续处理提供特征原始信息。

# 3.3.2实验及结果分析

在本课题的随机涂层研究中，以VisualStudio 2015 和计算机视觉库Opencv 3.4.8构建整个软件编程环境，对随机涂层二维码中的随机涂层进行轮廓提取。其实验的输入输出图像，如图3.6所示。

![](images/5209b030e98f44d38f2e8ee38d28cbe3e0b6a7fc26ac071540dbb28afdb1cf48.jpg)  
图3.6重建二维码输入输出图像

同时，为了检测本文提出的随机涂层轮廓点提取技术的实际效果和性能，本文采集100帧图像进行分析，判断算法的成功检测率和检测成功的平均消耗时间，并且控制在不同光照条件和不同角度。最后实验测量数据如表3.2所示。

表3.2技术试验结果  

<html><body><table><tr><td>识别率</td><td>平均耗时(ms)</td></tr><tr><td>0.99</td><td>202</td></tr></table></body></html>

根据最终实验结果可知，在所有100帧图像中，只有1帧图像识别处理失败，而且平均耗时较低。因此，此算法适用于实际的技术要求。

# 3.4随机涂层二维码防伪技术研究

# 3.4.1防伪标签特征矢量提取技术

通过上文对于图像的处理，可以得出二维码的相对坐标系和轮廓点相对于图像的坐标位置。然后，可以根据二维码相对坐标系转化过程中透视变换矩阵，得出轮廓点相对于二维码的相对坐标值（以标准正向二维码的左上角黑色方格点的中心坐标点为原点，向右为y轴，向下为x轴）。

对于每一个轮廓来说，其拥有一组轮廓坐标点数据集，如果直接使用这些数据集进行防伪比较显然不现实，所以本文采用求轮廓重心点坐标的方式，将每个轮廓看作是一个多边形，以重心点坐标值表示每个轮廓的特征信息。

在求取轮廓重心时，一般做法是通过累加求和再平均的方式进行。即假设多边形的点坐标为 $P _ { i } ( x _ { i } , y _ { i } ) ( n = 1 , 2 , 3 , \dots , n )$ ，则其重心坐标值为 $G ( x _ { G } , y _ { G } )$ ，其中：

$$
\scriptstyle x _ { G } = { \frac { \sum _ { i = 1 } ^ { n } x _ { i } } { n } }
$$

$$
\scriptstyle y _ { G } = { \frac { \sum _ { i = 1 } ^ { n } y _ { i } } { n } }
$$

上述为求取重心点坐标的一般方式，然而此种方式所带来的问题是：由于没有对多边形做出一定的分析和处理，这种方式很容易导致最终求取重心的精度值不够，因此我们需要其他方式对轮廓点的重心点进行求解。

对于常见三角形来说，可以很容易利用其顶点坐标求解其重心和面积。而多边形本质上可看作是多个三角形拼接而成，因此可以利用三角形重心点求解方式推广到多边形重心点求解，即利用平面薄板重心公式将积分进行累加和求解[4I]。如公式3.2所示，每个三角形面积为σi，重心坐标为Gg(xg,yg)。

$$
x _ { g } = \frac { \iint x d \sigma } { S } = \frac { \sum _ { i = 1 } ^ { n } x _ { i } \sigma _ { i } } { \sum _ { i = 1 } ^ { n } \sigma _ { i } }
$$

$$
x _ { g } = \frac { \iint y d \sigma } { S } = \frac { \sum _ { i = 1 } ^ { n } y _ { i } \sigma _ { i } } { \sum _ { i = 1 } ^ { n } \sigma _ { i } }
$$

根据上述表述可知，多边形求取重心点坐标时，可以将其分割成三角形来求解。如图3.7所示，将多边形分割为以 $P _ { i } ( x _ { i } , y _ { i } ) ( i = 1 , 2 , \dots , n )$ 为顶点的 $( n - 2 )$ 个三角形，对于每一个三角形来说，其重心为 $G _ { i } ^ { \prime } ( x _ { G i } ^ { \prime } , y _ { G i } ^ { \prime } )$ ，面积为，则可以通过公式3.3，计算出多边形的重心坐标为 $G ^ { \prime } ( x _ { G } ^ { \prime } , y _ { G } ^ { \prime } )$ 。

![](images/56dbd741ed5fda578ad936e8366c78273f8ddb1540279b071793d0568d42a284.jpg)  
图3.7多边形分割为三角形

$$
x _ { G } ^ { \prime } = \frac { \sum _ { i = 2 } ^ { n - 1 } ( x _ { 1 } + x _ { i } + x _ { i + 1 } ) \left[ \begin{array} { c c c } { x _ { 1 } } & { y _ { 1 } } & { 1 } \\ { x _ { i } } & { y _ { i } } & { 1 } \\ { x _ { i + 1 } } & { y _ { i + 1 } } & { 1 } \end{array} \right] } { 3 \sum _ { i = 2 } ^ { n - 1 } \left[ \begin{array} { c c c } { x _ { 1 } } & { y _ { 1 } } & { 1 } \\ { x _ { i } } & { y _ { i } } & { 1 } \\ { x _ { i + 1 } } & { y _ { i + 1 } } & { 1 } \end{array} \right] }
$$

$$
y _ { G } ^ { \prime } = { \frac { \sum _ { i = 2 } ^ { n - 1 } ( y _ { 1 } + y _ { i } + y _ { i + 1 } ) \left[ { \begin{array} { c c c } { x _ { 1 } } & { y _ { 1 } } & { 1 } \\ { x _ { i } } & { y _ { i } } & { 1 } \\ { x _ { i + 1 } } & { y _ { i + 1 } } & { 1 } \end{array} } \right] } { 3 \sum _ { i = 2 } ^ { n - 1 } \left[ { \begin{array} { c c c } { x _ { 1 } } & { y _ { 1 } } & { 1 } \\ { x _ { i } } & { y _ { i } } & { 1 } \\ { x _ { i + 1 } } & { y _ { i + 1 } } & { 1 } \end{array} } \right] } }
$$

通过上述的多边形重心点坐标求解算法，可以得到每个轮廓的重心点坐标值，并以此坐标值表示轮廓的特征信息。

# 3.4.2实验及结果分析

在此技术的实验和分析过程中，本文采用VisualStudio2015、二维码开源库ZXing和计算机视觉库Opencv3.4.7共同搭建软件编程环境。同时针对不同大小的红色斑点（大，中，小三种红色斑点)，在固定USB 摄像头和移动USB摄像头的不同条件下进行实验研究和结果分析。其不同大小的红色斑点输入输出的处理图像如图3.8所示。

![](images/8c7cee1bde17c868ca1a7381b6ba5ee11990d89fc2982433312dbade7ce9fd7a.jpg)  
(a)红色斑点输入输出图像（大）

![](images/78871d17540855ff34e977087685dc8b4131b682bd268b56dfddd25edf417a2a.jpg)  
图3.8红色斑点输入输出图像

同时，对不同条件下，计算其重心点坐标的Mean和RMS数据值。其中Mean和RMSE分别表示100帧图像的重心点坐标的平均值和均方根误差值。最后的实验数据如表3.3所示（表中以二维码的单个黑白方格点的宽度为一个单位）。

表3.3实验数据  

<html><body><table><tr><td rowspan="2">斑点类型</td><td rowspan="2">参数</td><td colspan="2">摄像头保持静止</td><td colspan="2">摄像头保持移动</td></tr><tr><td>x坐标</td><td>y坐标</td><td>x坐标</td><td>y坐标</td></tr><tr><td rowspan="2">大红点</td><td>Mean</td><td>16.22717236</td><td>13.39604152</td><td>16.21968346</td><td>13.35475124</td></tr><tr><td>RMSE</td><td>0.012511818</td><td>0.009138649</td><td>0.026879825</td><td>0.041903766</td></tr><tr><td rowspan="2">中红点</td><td>Mean</td><td>12.43857734</td><td>10.29313169</td><td>12.41362863</td><td>10.26746007</td></tr><tr><td>RMSE</td><td>0.015831112</td><td>0.014618354</td><td>0.040990794</td><td>0.029899955</td></tr><tr><td rowspan="2">小红点</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>MesE</td><td>1156320733</td><td>9.54356579</td><td>115404386</td><td>9.531145362</td></tr></table></body></html>

通过对表3.2的数据进行分析可知，对于不同大小的红色斑点，其在摄像头保持稳定和移动摄像头的情况下，均方根误差始终小于0.1个单位，即技术实现具备稳定性。因此，可以得出本文所提出的基于图像处理的随机涂层二维码防伪技术具备实现的可行性，即可以通过其不同角度下的随机涂层相对位置，唯一确定防伪标签的特征矢量。

# 3.5本章小结

本章主要介绍了基于图像处理的随机涂层二维码防伪技术研究，包括防伪技术的实现原理和防伪技术的主要结构，以及最后验证防伪技术可行性。本章首先对文中提出的防伪技术的实现原理进行详细阐述，并进一步提出防伪技术的实现流程，然后针对流程中二维码坐标系的建立和随机涂层轮廓点提取技术进行进一步介绍，分别阐述了其实现方法和方法的实验及结果分析，最后对于防伪技术的特征信息表示进行介绍，并对整个防伪技术进行实验和结果分析，确定了本文提出的防伪技术的可行性。

# 第4章随机涂层二维码防伪需求和可行性分析

# 4.1常见防伪方案

# 4.1.1常见防伪系统方案介绍

通过第一章的论述和分析我们可以得知，防伪技术的产生主要是为了产品不被假冒伪劣。对于大多数产品来说，采用有效的防伪措施对产品进行保护十分重要。目前，随着生产者和用户对于防伪技术需求的不断提高，在现实生活中出现了各种各样防伪解决方案，其主要包括以下几种：

# （1）基于特殊材料的防伪系统

基于特殊材料的防伪系统主要是利用了特殊材料自身具备的防伪特性和不可复制性。在这种系统的设计过程中，主要是将特殊材料通过印刷嵌入产品包装之中。因此，在实现过程中需要复杂度和难度很高的印刷工艺和印刷技术支持[42]。然而，这种设计的实现，往往还需要许多硬件设备和材料的支持。例如，印刷所需要的防伪设计制版，高精度印刷设备，以及与之相配套的纸张和油墨等各种材料。同时，在实际应用中，这种系统的防伪验证往往还需要人为的操作和人眼的识别。

# （2）基于特殊水印的防伪系统

特殊水印防伪系统的设计主要有两种实现方式。一种是利用一些具有防伪特性的特殊物质，在产品制作过程中将物质添加进去，以此来达到防伪的目的。另一种则是将特殊水印添加到产品当中[43]，从而使得在不影响产品使用的同时，数字水印同样能够被识别出来，例如，在纸币的防伪中就包含特殊水印的防伪方式。但是，在实际的应用当中，不管是第一种方案还是第二种方案都具有一定的局限性。特殊水印的材料大多数成本较高，而且对于环境有一定的影响，从企业的角度出发，特殊水印方案并不是一种理想的解决方案。同时，某些特殊水印二维码还需要一些特殊的仪器，或者需要特殊的方法才能够进行防伪判断，这在一定程度上影响了用户的使用体验。

# （3）基于数字加密的防伪系统

数字加密防伪系统常被用作二维码防伪之中，其防伪设计主要是利用算法对二维码信息进行二次加密，然后由客户端（例如，手机）扫描二维码，在经过解码处理后，最终获得二维码真实信息[44]。这种方式相比较于前两种方式来说，不仅降低了二维码的制作成本，同时不需要专门的设备对二维码进行扫描才能得到结果。因此，本课题的研究主要是通过对数字加密防伪系统设计方案的思考，提出随机涂层二维码防伪系统方案。

# 4.1.2常见数字加密二维码防伪系统方案分析

在实际应用中，常见的数字加密二维码防伪系统的工作流程大致相同，我们将其总结为如图4.1所示。

![](images/7e5c5a764943deb9b443278b76300f3d81812dd822a5bbefe491c432f85b1185.jpg)  
图4.1常见的数字加密二维码防伪系统的工作流程

根据上图我们可以得知，数字加密二维码防伪系统的运行流程主要可以分成以下三个部分：

（1）第一部分：二维码的产生

这一部分主要是由加密二维码的注册中心和提供二维码主要信息的企业共同完成的。企业事先将需要加密的二维码信息内容提供给注册中心，注册中心通过指定的算法将每个二维码信息进行加密操作，从而形成独一无二的加密标识码。注册中心一方面将形成的加密二维码提供给企业，一方面又将二维码原始信息和加密标识码上传到数据库服务器，等待用户后续进行相关验证操作。

# （2）第二部分：二维码的查询

二维码查询部分主要是通过用户对二维码的扫描加以实现。目前，随着科技水平的不断提高，移动互联网得以广泛的普及，在此基础上，用户很容易通过二维码扫描设备或手机等连接互联网。用户通过这些设备对加密后的二维码进行扫描操作，经过二维码解码后的加密信息通过移动互联网发送到服务器。

# （3）第三部分：二维码的验证

二维码的验证部分主要是由用户和数据库服务器一起完成的。在第二部分中，用户将加密后的信息发送到互联网，数据库服务器在接收到这些加密信息后，首先将加密信息按照指定的算法进行解密操作，然后与服务器中的原始数据进行匹配操作，最后将匹配信息发送给用户，从而完成整个二维码验证操作。

在整个系统的流程过程中，我们可以看出系统运行流程中的三个部分是彼此不可分割的。三个部分的不可分割性主要体现在，每个部分都不可能脱离任何一个部分而独立进行工作，只有三个部分共同协作，才能维持整个系统的稳定性。这在一定程度上摆脱了某些不法分子伪造的可能，从而达到防伪的目的。

同时，通过对数字加密二维码防伪系统流程的介绍，我们可以得出以下两个角度的分析结果：

（1）在使用体验上

对于使用体验来说，其主要是针对的是用户在实际使用防伪系统过程中的体验。防伪系统是依托于产品产生，而防伪的目的主要是为了用户不会购买到假冒伪劣产品，因此在整个防伪系统的构成中，用户的实际体验一定程度上反映出防伪系统的适用性等问题。在数字加密二维码防伪系统中，用户在进行防伪验证时，一般包含两种验证方式。一种是防伪二维码需要特殊的扫描仪器进行扫描验证，在这种情况下，防伪系统从本质上决定了其不能被大范围使用的可能。另一种方式则是通过移动设备联网验证，然而联网验证的方式虽然在用户的使用体验上更加的友好，然而，这也是给了许多不法分子的可乘之机，即不法分子可以通过复制防伪二维码的方式进行假冒伪劣。

# （2）在系统可靠性上

在数字加密二维码防伪系统中，不同的防伪验证方式，决定了防伪系统中可靠性侧重点的不同。对于特殊仪器扫描验证方式来说，其可靠性依赖于数字加密解密算法。然而，由于其采用了特殊仪器，所以无论其系统可靠性好坏，在使用体验上决定了其防伪方式不适合大规模使用。而对于联网验证方式来说，其可靠性依赖于数据库中存放的匹配数据以及加密算法两者，然而，其依旧无法杜绝防伪标签被复制的情况，因此，其同样不是一种理想的防伪解决方案。

通过上述的分析，我们不难得出数字加密二维码防伪系统同样存在某些方面的不足，其不足之处主要体现在以下两个方面：

(1)部分数字加密防伪二维码的读取和解密依然依靠某些特殊的二维码识别仪器，用户无法直接进行防伪判断，这一点大大降低了用户的实际体验效果，不利于防伪技术的广泛使用。

（2）数字加密防伪二维码本质上还是印刷在某些平面上（如产品包装盒上），这一点就给了许多不法分子可乘之机。不法分子可以通过复制的手段不断复制“正确”的二维码，这些二维码依然都能够成功通过数据库服务器的验证。即使企业采用了一码仅能验证一次的手段，不法分子也能通过对“正确”二维码的复制，使得“正确”二维码失去应有的作用。

总结上述分析，可以得知，目前存在的常用防伪方案无法从本质上做到真正的防伪，即防伪系统无法在满足用户易用性的同时，可以完全做到防伪标签“防复制”。因此，需要对现有的数字加密二维码防伪方案进行改进，或者重新提出另一种能够同时解决上述问题的解决方案。下文将从用户和企业的实际角度出发，进一步对防伪系统进行需求分析，从而提出一种基于图像处理的随机涂层二维码防伪技术解决方案。

# 4.2防伪系统的需求分析

# 4.2.1防伪系统的功能需求分析

防伪系统的主要面向对象体现在两个方面。一方面，对于防伪系统的用户来说，用户的需求主要体现在能够查询到产品信息和得到产品真伪的验证结果；另一方面，对于企业来说，企业的需求体现在产品信息能够被用户正确查询和防伪标签不会被不法分子盗用等。

对于用户来说，防伪系统存在的主要意义是提供准确可靠地查询服务。用户的具体功能需求可以体现在图4.2所示[45]-[49]。

![](images/10a8f87b1ac39d91045287dd04d2663522d5f291114026b9796a78da69067f4b.jpg)  
图4.2用户需求图例

从图4.2我们可以看出，用户的具体需求大致分为两个部分。两个部分分别介绍如下：

（1）使用体验

从用户的使用体验角度来说，其具体需求主要围绕着用户在实际中使用防伪系统的体验，其需求可以总结为以下几个方面：首先，防伪系统在使用过程中应该做到简洁易用，只有这样，用户才会愿意去主动使用防伪验证方法进行验证，对用户的防伪验证行为具有积极地促进作用。其次，防伪系统应做到具备普遍化，即防伪系统在保证防伪效果的前提下，能够进行大规模的使用，这对于防伪系统的普及具有十分重要的意义。最后，防伪系统的安全性应该高，安全性高的防伪系统不仅决定了防伪系统本身的防伪效果，更决定了用户是否愿意使用防伪系统进行防伪验证。

# （2）查询结果

从查询结果的角度来说，用户对于防伪系统的需求主要体现在防伪系统是否能给出验证结果信息和产品信息。前者对于用户来说，满足了其本身的防伪验证需求，而后者则可以满足用户对于防伪标签中所代表的产品信息的需求。

防伪系统对于企业而言，主要是能够在维护企业经济利益的同时保证企业的合法权益不受到侵害，其具体的功能需求如图4.3所示。

![](images/39c324f47dad997a06dbc3875e223e346e3e6cc106e426200c2d04411f283437.jpg)  
图4.3企业需求图例

根据图4:3所示，我们不难看出，企业的功能需求同样可分为以下两个方面。

（1）防伪标签

从防伪标签的角度来看，企业的需求主要是在满足防伪效果的同时，防伪标签能够做到外观好看且成本低廉，它们共同决定了企业对于防伪系统的投入能力和防伪系统是否适合进行大规模使用。

# （2）数据库

从数据库的角度来看，常用防伪系统主要通过连接互联网，进行数据匹配，从而达到防伪验证的目的。因此，数据库的安全对于企业来说是一个很大的需求，同时，数据库的更新维护保证了企业生产的防伪标签防伪验证的稳定性。

# 4.2.2防伪系统的性能需求分析

当防伪系统需要去满足企业和用户的功能需求时，系统便需要从系统的性能需求分析出发，通过满足系统的性能需求的方式，实现系统的功能需求。

# （1）简单易用性

在防伪系统中，系统的简单易用性直接决定了用户对于防伪系统的接受程度。如果防伪系统没有做到简单易用的话，用户会在无意中对防伪系统的防伪验证产生抵触心理，从而进一步影响了防伪系统的普及。

# （3）普遍兼容性

防伪系统需要在满足防伪效果的同时，尽可能多地做到普遍兼容性，只有这样，才能保证用户在不同设备和不同请款下依然正常使用防伪系统。

# （4）系统可靠性

可靠的系统对于防伪系统来说十分的重要，它直接决定了防伪系统是否能够满足我们生活中的防伪需求。对于可靠的系统来说，它会在保持防伪功能稳定性的同时，对相关数据和技术进行不断的更新。

# 4.2.3防伪系统的安全性需求分析

防伪系统的提出主要是为了保护企业的合法利益和维护用户的“正版”需求，因此对于防伪系统来说，其系统的安全性便显得尤为重要。

防伪系统方案的安全性需求体现在以下几个方面：

（1）防伪标签的产生是惟一的，即对于每一个防伪标签来说都是独一无二的。不仅如此，防伪标签的特征信息与数据库中保存的加密信息都是一一对应的。（2）防伪系统需要采用一定的防伪设计，在最大程度上告别了伪造者通过复制防伪标签的方式进行仿造的可能，这样可以在极大意义上保护了防伪标签中所包含的特殊信息。（3）防伪系统的验证需要是通过互联网进行，用户只需要通过应用商城下载特定的防伪识别App，便可以进行防伪标签的验证。这在保证系统便捷易用的同时，确保了系统的安全性。

# 4.3随机涂层二维码防伪系统的设计方案

通过上文的分析可以得知，当采用数字加密防伪二维码的设计时，我们依然无法解决非法分子采用复制的方式仿造二维码，从这个角度来看，防伪二维码从本质上失去了其防伪特性。虽然，存在一些研究者提出一种基于信息隐藏的二维码防伪方案[50]。这种方案的主要设计思想是采用脆弱性水印的方式使得不法分子无法多次印刷二维码，这从一定程度上解决二维码多次印刷的问题，然而，不法分子依然可以通过拍照“正确”二维码的方式，来达到自己伪造的目的。

因此，在同时满足易用性和真正做到防伪标签防复制的情况下，本文提出了基于图像处理的随机涂层二维码防伪系统解决方案，此方案在解决了常用防伪系统存在的问题的同时，能够满足用户和企业的功能需求，性能需求和安全性需求等。

若采用随机涂层二维码防伪的设计，用户必须通过移动二维码识别设备（如手机）的方式，获得每个二维码独特的防伪特征信息。而对于每个防伪标签来说，用户在手机软件的引导下，分别获得正面90度，正面向左倾斜45度和正面向右倾斜45度这三组特征信息矢量，然后手机将向服务器发送这三组特殊矢量并进行验证。这种防伪二维码的设计，从一定意义上杜绝了不法分子仿造二维码的可能。由于特征矢量的获取依赖于手机的视频流的读取结果，不法分子无法通过复制的手段伪造二维码。随机涂层二维码防伪系统的数据流如图4.4所示。

![](images/679fb4ec3f25810895f953c7fac0593cd3a7bc3595e1fe9eb69e7febe4685557.jpg)  
图4.4随机涂层二维码防伪系统的数据流

根据图4.4所示的系统数据流我们可以得知，系统的主要组成包括服务端，客户端，二维码三个部分，而系统的主要数据流包含以下几个方面：（1）视频流读取：用户在获得随机涂层二维码防伪标签之后，利用从防伪标签的三个特定角度获取包含防伪标签的视频流。(2)特征矢量提取：客户端从视频流中获得三个特定角度中二维码的特征矢量。如果无法获得，则提示用户重新进行检测。（3）特征矢量发送：当客户端正确获得包含三组特征矢量的特征信息时，提示用户已成功获得特征信息，并将特征信息发送至服务端。（4）防伪信息：服务端在获取客户端发送过来的特征信息后，进行相关验证操作。若能正确匹配到数据库信息时，返回客户端验证正确信息，并展示数据库中保存的特征矢量包含的产品信息。反之，告诉客户端验证错误信息。

# 4.4随机涂层二维码防伪系统可行性分析

随机涂层二维码防伪系统作为二维码技术和防伪技术相结合的产物，其产生的可行性主要体现在以下几个方面：

# （1）市场需求方面

从上文对于防伪系统的功能需求、性能需求分析和安全性需求介绍可以得知，该系统能够满足市场中企业和用户两大群体的需求。系统在给用户带来操作上的便携性的同时，系统作为一种理想的防伪系统解决方案，同样符合企业的具体需求。

# （2）技术实现条件方面

该防伪系统从技术实现的角度出发，系统主要涉及二维码技术，图像处理基础和数据库技术。其中，二维码技术和数据库技术是已经成熟的技术体系，它们对于系统的技术实现来说，并不存在技术上的难点。而图像处理技术则是近几年来快速发展的一种技术，系统主要是利用该技术中常用的几种算法，如图像降噪，边缘检测和图像分割等，这些算法能够很容易在各个系统下实现（如Android，iOS等）。

# （3）经济效益方面

随机涂层二维码防伪技术的经济成本主要体现在二维码本身的成本和随机防伪涂层的成本。前者由于二维码本身的低廉性，在成本考虑中并不作为主要影响因素。而后者的随机防伪涂层从成本的角度出发，也同样可以以较为低廉的价格取得较为满意的结果。

# 4.5本章小结

本章主要对随机涂层二维码防伪系统的需求和可行性进行分析，并同时提出系统的设计方案。文中首先对举例阐述常见防伪系统的系统方案和主要工作流程，进而指出目前常用防伪系统所存在的不足之处，然后对防伪系统进行需求分析。在此基础上，提出一种新的防伪技术解决方案，即基于图像处理的随机涂层二维码防伪系统，并且对新提出的防伪系统的设计方案进行阐述，最后分析了防伪系统的可行性。

# 第5章随机涂层二维码防伪系统的设计和实现

# 5.1软件开发运行环境及运行平台

# 5.1.1软件运行环境分析

本研究课题所提出的随机涂层二维码防伪技术系统，主要是通过用户在手机，平板等移动设备运行相关防伪识别软件实现的。而对于防伪识别软件的开发，需要考虑到软件的运行平台系统和系统的版本选择，这些因素直接决定了软件的普遍实用性和后期的升级维护成本。在目前的主流的手机和平板等移动设备的平台系统主要包括iOS和Android两种。同时，相比较于iOS系统来说，Android系统因为其独具的开源性和操作界面的友好性，被更加广泛应用于手机和平板等移动设备。

本研究课题选择Android操作系统作为防伪软件的运行系统。在系统的选择考虑中，除了Android操作系统具有更高的用户群体和更好的开放性之外，其在其他方面也具有一定的选择优势。与系统操作系统相比，一方面，Android操作系统中对于进程回收的内存管理机制使得系统更加具有效率[5I]；另一方面，Android软件开发所采用的Java语言具有很强的跨平台和可移植性。

# 5.1.2软件开发环境和运行平台

在软件开发的主体流程中，我们需要对相关二维码识别算法和图像处理算法进行研究，然后将改进后的算法程序利用Android中的NDK开发进行集成，最后在Android手机上运行实现。因此，软件的开发环境如下：

# （1）电脑配置

Windows10家庭中文版，电脑处理器InterCorei7，电脑运行内存8GB。

（2）开发工具（算法研究）

集成开发环境Visual Studio 2015，图像处理工具库OpenCV3.4.7，二维码识别集成库 ZXing 3.4.0。

（3）开发工具（软件实现）

Android开发环境Android Studio3.5.3，Java8开发工具包，Android开发工具包NDK版本为21.0，Android版本设置android8.0。

（4）开发工具（服务器实现）

数据库软件MySQL，JavaWeb 服务器程序开发IDENetBeans 8.2、服务器软件Tomcat。

在Android版本的选择过程中，如上文所述，我们需要综合考虑软件的适用范围，而根据目前市场上众多手机等移动设备的Android系统版本，本文选择Android9.0作为系统软件开发的版本设置，即运行平台的安卓版本需要高于Android9.0。

# 5.2随机涂层二维码防伪系统的整体架构设计

在随机涂层二维码防伪系统中，其系统的构成主要包含三类：用户、企业和数据库。用户的构成主要通过对手机APP客户端的操作进行，用户通过对于客户端的操作可以实现防伪验证和产品信息展示。企业的构成则是通过制作防伪标签，并且将防伪标签的防伪特征信息和包含的产品信息上传到服务器中，以等待用户的防伪验证和对产品信息的提取。而数据库的构成则是将企业和用户连接到一起，一方面数据库需要保存来自企业的关于防伪标签的相关信息，另一方面数据库还需要对用户发送过来的数据进行验证和反馈。防伪系统正是因为这三类的构成，才使得系统能够实现技术的预期目标。如图5.1所示，显示了防伪系统包含此三类的整体系统架构。

![](images/c26834f768297bc40f7f266e613cb540d2b18133baccb799025224c7d055a916.jpg)  
图5.1防伪系统整体系统架构

根据图5.1所示，我们可以发现，位于企业类的防伪标签特征矢量信息的生成，位于用户类的手机APP软件设计的实现和位于数据库类的防伪验证在整个防伪系统中，占据着重要的地位，它们也是整个系统中软件开发的重点所在。同时，上述三个对象软件的开发，在软件功能层面上存在着许多联系。一方面，企业需要软件对防伪标签的特征矢量信息进行提取，而用户在进行防伪验证操作之前，同样需要先提取防伪标签的特征矢量信息，两者在软件功能的实现上是相同的；另一方面用户需要进行防伪验证，因此用户需要通过手机软件将提取到的特征矢量信息发送到服务器，从而进行防伪验证，两者从侧重点的角度来说，重点在于服务器需要实现相关验证实现。

根据上文的表述可知，防伪系统的实现主要集中在以下两个方面的软件实现：一是系统特征矢量生成的软件实现，其在功能上同时存在于用户手机APP的实现和企业对于特征信息提取的实现；二是服务器端特征矢量验证的软件实现，服务器可以接收来自手机的数据并返回验证信息。

# 5.3系统特征矢量生成模块设计与实现

# 5.3.1系统特征矢量生成模块设计

对于本文提出的防伪系统来说，特征矢量生成模块可以同时用作企业和用户手机APP对于防伪标签特征矢量的提取。下面以企业对特征矢量的提取为例，如图5.2所示。

![](images/7a37aa1fd8e7f39708d1187af2480ed3a7bfe9275d4b5db5283f43b67cc72f4a.jpg)  
图5.2企业特征矢量提取过程图

根据图5.2所示，企业在进行特征矢量的提取过程中，其特征矢量生成的主要过程总结如下：

（1）二维码防伪系统的使用企业根据自己的自身需求，对产品信息进行编号。产品信息主要包含企业信息，产品名称，产品简介，产品内容等。然后调用二维码的生成接口，对产品信息编号进行二维码编码，生成包含产品信息编号的二维码。（2）当包含产品信息的二维码生成之后，生成的二维码将进入涂层生成部分。在此部分当中，二维码表面将生成厚度均匀的且包含5个红色斑点的透明涂层，并且红色斑点随机分布在涂层的不同高度上，从而形成涂层二维码。

（3）涂层生成部分将生成的包含涂层的二维码返回给企业。此时，企业仅仅只有一个包含5个红色斑点的涂层二维码。

（4）企业调用特征矢量生成服务，提取涂层二维码的特征矢量信息。在此过程中，企业主要是控制包含特征矢量生成服务的设备在不同角度对涂层二维码的特征矢量进行提取。例如，分别在正向90度，左斜45度和右斜45度，提取三组特征矢量。

（5）特征矢量生成服务生成三组特征矢量，并将特征矢量返回给企业。

（6）企业将收到的特征矢量信息，二维码所代表的产品信息共同上传至云端，完成整个特征矢量生成过程。

# 5.3.2系统特征矢量生成模块实现

在特征矢量的生成模块中，本文主要采用Java开发语言，在Android 平台上加以实现。在实现过程中，为了充分利用上文关于随机涂层二维码防伪技术的研究成果，本文将利用AndroidNDK进行开发，将研究算法和技术集成到Android中得以调用，从而实现对特征矢量的提取。

NDK(全称 NativeDevelopmentKit)是一种软件开发工具，它主要基于的是原生程序接口。在进行NDK开发过程中，其会提供很多开发工具，可以帮助开发者对C或者 $C { + } { + }$ 的动态库进行快速开发，并将开发出的动态库与java应用共同打包成程序文件。使用AndroidNDK进行开发，可以在提高软件程序性能的同时，更大程度上保护底层代码。本文对特征矢量生成模块的实现，就是通过AndroidNDK开发，从而形成本地编程接口，通过JAVA调用，最终在Android平台上得出最后的特征矢量数据[52]。图5.3所示，为Android 程序中的主要调用流程。

//特征矢量提取函数  
public double[][] qrcode_get（）  
{doubie [][]output=new double[5][]：//采集视频图像格式转换Bitmap bitmap =matToBitmap（mRgba)；int width=bitmap.getwidth（int height=bitmap.getHeight（)：//实例化二维码读取函数BarcodeReader barcodeReader= new BarcodeReader();double[] vec;if(barcodeReader.read(bitmap,width,height)!=null）{//获得返回二维码信息数据（大小，每个黑白方块点坐标及颜色）vec=barcodeReader.read(bitmap,width,height).getVec（）；if(vec.length>）{Mat matmap=Rgba;//获得返回特征矢量值（包含xg，yg，sg）double res[][]= stringFromJNI（matmap.getNativeObjAddr（）,vec）；if(（res.length/）==5）output=res;中return output;  
]

同时，在特征矢量生成过程中，为了形成三组不同角度的特征矢量值，软件将调用Android手机的方向传感器实时数据，引导企业或用户从不同角度获取防伪标签的特征矢量数据。

在手机的方向传感器中，调用函数返回数据为手机三个轴的角度数据，并且三个轴分别表示：方位角、倾斜角和滚动角。如图5.4所示，方位角（Azimuth）表示的是手机按照Z轴旋转的角度，范围为0度到360度；倾斜角（Pitch）表示手机按照X轴旋转的角度，范围为负180度到180度；滚动角（Roll）表示手机按照Y轴旋转的角度，范围为负90度到90度[53]\~[55]。

![](images/f33b739b83d5dd4fee6a5adcb9b3a8f3316c0759f0fccbb286d3fd83b6164a6a.jpg)  
图5.4手机方向传感器坐标系

而在本文的特征矢量生成模块实现中，结合上文的介绍，企业和用户需要从不同角度获取特征矢量信息。对企业来说，主要需要控制旋转角为0度，倾斜角分别在0度、负45度和45度三种情况下，进行特征矢量生成。而对于用户来说，在同上述操作的同时，允许一定的角度误差进行特征矢量提取。图5.5所示分别为三种情况下，进行特征矢量生成的手机截图。

![](images/e3075701ea7c6ea75e957fcad839f088a8fd5c5e05b302a9db1fa7ad1e07cf6b.jpg)  
图5.5三种情况下的手机截图

# 5.4系统特征矢量验证模块设计与实现

# 5.4.1系统特征矢量验证模块设计

在特征矢量的验证过程中，主要是提取防伪标签的特征矢量，然后发送至服务器，与服务器中的特征矢量数据库进行比对验证，从而得到相关验证信息，进而判断防伪标签的真伪性。图5.6所示，为用户在进行防伪验证过程的流程图。

![](images/059c45fe50f146552317c68e5d019cbd5337a9294899f8ecea4a949ecf6cadff.jpg)  
图5.6用户防伪验证流程图

根据图5.6可是，其主要流程可以总结为以下几个方面：

（1）用户打开二维码防伪验证App进行相关验证操作。（2）客户端先提示用户将手机正对二维码前方，获取用户设备正向面对二维码得到的特征矢量信息。

（3）客户端将获取的正对二维码发送至数据库服务器，进行正对二维码真伪初步验证操作。

(4)数据库服务器将上传数据与服务器数据进行比对验证，通过控制误差区间，初步判断二维码是否为真。并将结果发送至客户端。（5）当验证通过时，提醒用户进行设备左斜45度和右斜45度操作，进而获取两组特征矢量信息数据值。（6）客户端再将获取的两组特征矢量信息数据值发送至数据库服务器，从而进行二维码真伪最终验证操作。（6）数据库服务器将两组，通过控制误差区间，判断二维码是否为真。并将结果发送至客户端。（7）当步骤（7）中的验证结果为假时，提示用户二维码为假。反之，提示用户二维码为真，并显示二维码所代表的产品信息。

通过上述特征矢量的验证流程可以看出，在验证过程中主要包含两方面内容：一是提取防伪标签的特征矢量信息，从这方面来说，已经在上文得以实现；二是上传特征矢量信息，并获得来自服务端验证信息。

在提取防伪标签特征矢量过程中，其基本过程与企业提取特征矢量操作相似，即通过手机对用户进行引导，从三个不同角度：正向、左斜45度和右斜45度进行提取，每次提取一定量数据之后，发送到服务器进行防伪验证，当三次验证届通过时，提示用户验证成功，反之验证失败。

在服务器进行防伪验证过程中，本文通过搭建云服务器，利用android中的Volley 网络请求框架进行数据发送和防伪验证结果接收。在云服务器的设计中，本文采用MySQL、Java_Web、Tomcat相结合的方案完成对服务器的设计和实现。在上述中，MySQL是常用的一种开源数据库；JavaWeb是一种使用Java语言进行开发的服务器应用程序，它可以完成对客户端发来的数据进行应答；Tomcat则是一种开源的服务器软件[56]-[58]。服务器验证流程设计，如图5.7所示。

![](images/735c2112dc7da373f7d131ab4ba3a1f5656b7884d2d2690ab739cef0084875b1.jpg)  
图5.7服务器验证流程

根据图5.7所示，其主要流程可以总结为如下所示：

（1）用户客户端通过调用android中的Volley函数，对指定的IP地址和端口号  
发送数据的Http请求，请求中包含当前手机验证角度信息和特征矢量信息。（2）服务器软件Tomcat接收到来自客户端的请求后，按照对应的Javaweb 服  
务器应用程序进行针对性处理（3）Javaweb服务器应用程序根据上述请求，找到程序中与请求相对应的  
Servlet程序模块，进行后续处理。（4）Servlet程序模块根据请求内容调用对应的MySQL数据库，进行数据处理  
等操作，最后将结果发送回客户端。（5）客户端接收到返回结果后，执行后续的判断操作。

# 5.4.2系统特征矢量验证模块实现

根据上述的介绍可知，在二维码特征矢量验证模块中，主要包含两个部分：一是对于特征矢量的提取实现，二是实现对提取数据的服务器验证。前者已经在上文中得以实现，因此本模块的实现主要针对的是特征矢量数据的上传和返回验证。

根据上述表述，可以得知服务器在进行防伪判断过程中，主要有以下几个步骤。首先，企业需要按照指定三个角度对防伪标签进行特征矢量的生成和提取，对于每个角度来说，企业需要采集足够多的特征矢量数据，从而形成服特征矢量数据矩阵，并上传到服务器。然后，用户在进行防伪验证时，将不同角度的数据上传到服务器，服务器会对不同角度特征矢量数据矩阵进行匹配验证，在一定的误差范围内，认为验证结果为真，反之，为假。图5.8表示数据库服务器在进行防伪验证时，部分处理函数。

//服务器特征矢量验证函数   
private Boolean verifyLogin(String jiaoDu,String xzhou,String yzhou)   
{ //获取当前手机角度的数据库数据 Useruser= UserDAo.queryUser（jiaoDu); //特征矢量验证 Boolean zhou_bool; double Y_value $\Bumpeq$ （Double.valueOf(user.getM()））\*（Double.valueof（xzhou））+(Double.valueof（user.getT（)））; doubleY_data=Math.abs(y_value-(Double.valueof(yzhou))）; zhou_bool=y_data<05; //返回验证结果 return null = user && zhou bool;   
1

# 5.5本章小结

本章主要阐述随机涂层二维码防伪系统的设计和实现。文中首先对软件开发环境和运行平台进行介绍，同时对防伪系统的整体框架设计进行阐述，并得出防伪系统中主要的两个部分，包括防伪系统特征矢量生成模块和防伪系统特征矢量验证模块。然后，本章对上述两个部分进行了设计与实现，基本完成了研究课题提出的防伪系统的实现。

# 第6章随机涂层二维码防伪系统的测试

# 6.1防伪系统测试架构和测试环境

# 6.1.1防伪系统测试架构

随机涂层二维码防伪系统测试框架主要由手机端APP和服务器组成。手机端APP在负责提取不同角度足够多的特征矢量信息数据值的同时，还负责通过手机操作验证防伪标签是否为真；服务器则主要负责存储防伪标签不同角度的特征矢量信息数据矩阵和对来自客户端防伪验证请求做出回应。其测试架构如图6.1所示。

![](images/ef58b792a9faf026636e1c3e5f5371a7bba09e161a14334fdd483a7f236bcd37.jpg)  
图6.1防伪系统测试框架

根据图6.1所示，并结合上文所述，可以发现在防伪系统测试过程中客户端验证APP在实现的过程中包含特征矢量生成和提取部分。因此，在防伪系统提取特征矢量信息作为服务器验证信息时，所使用的客户端APP大致与客户端验证APP类似。

根据上述防伪系统测试架构图，可以总结防伪系统的测试主要流程如下：首先由客户端APP在防伪标签的三个角度（正向90度，向左45度，向右45度）提取足够过的特征矢量，并由此得出平均特征矢量信息数据值和数据的均方根误差值，并根据上述数据得出其不同角度的特征矢量信息数据矩阵，然后将其上传到服务器。测试过程主要是测试通过客户端APP进行防伪验证测试时的准确度，由此本文采取重复测试100次防伪标签，并由此得出最终的准确度信息。

# 6.1.2防伪系统测试环境

根据上文的介绍，本研究课题所提出的防伪系统测试部分主要由客户端APP和服务端验证程序组成。如表6.1所示，为本研究课题的测试环境主要相关参数介绍。

表6.1防伪系统测试环境  

<html><body><table><tr><td>客户端测试环境</td><td>服务端测试环境</td></tr><tr><td>华为P20手机 处理器：麒麟970</td><td>腾讯云服务器 处理器：AMD EPVC7K6248-Core Processor</td></tr><tr><td>内存：6GB</td><td>内存：2GB 操作系统：Windows Server 2016Datacenter</td></tr></table></body></html>

# 6.2防伪系统功能测试

防伪系统的功能测试主要包含防伪标签特征矢量生成功能测试和防伪标签特征矢量验证功能测试两部分。前者主要是为了测试程序是否能正常生成防伪标签的特征矢量，而后者则是测试防伪系统能否正常进行防伪验证。但是在实际测试中，防伪标签特征矢量验证功能测试过程中已经包含了对特征矢量生成的测试，因此本文在系统功能测试中，只测试特征矢量验证功能部分。

特征矢量验证功能测试主要是一个基于Android开发的应用软件程序，它主要通过手机摄像头实时采集每一帧图像，并对图像进行处理。在实际操作中，为了程序的正常运行，程序设定了每 $5 0 0 \mathrm { m s }$ 对采集到的数据进行处理。处理过程会经过特征矢量提取和服务器验证两个环节。同时，当三个角度验证完成之后，程序会返回验证结果。当验证通过时，手机界面不仅会显示验证通过，还会显示产品的相关信息。图6.2所示表示防伪系统验证成功时的手机界面显示。

![](images/6a8cf8a8da09963f4d1a7fcecf2329ca4c34dafab1f6e4776c4c9d405bdff79f.jpg)  
图6.2防伪系统验证结果程序界面

在验证过程中，手机界面会实时引导用户进行操作，因此验证操作较为简单。经过测试，防伪系统能够对正确的防伪标签进行验证，并相应返回验证通过时的产品信息。

# 6.3防伪系统性能测试

对于本文提出的防伪系统的性能测试，主要是通过测试其在正常操作使用中，防伪系统中防伪验证所占用的消耗时间。由于手机软件的引导过程中，不当的操作可能会占用更多的时间，对防伪系统性能测试的影响较大。因此，本防伪系统在进行性能测试过程中，主要考察其在不同角度下，系统客户端从识别到返回验证结果的耗时情况。为此，本次此时过程主要从三个不同角度，取10次系统消耗时间的平均值，作为每个角度的系统耗时，因此评判系统的防伪性能。表6.2所示，为最后的性能测试数据结果。

表6.2防伪系统性能测试数据  

<html><body><table><tr><td>防伪系统</td><td>正向验证</td><td>左斜45度验证</td><td>右斜45度验证</td></tr><tr><td>平均耗时(ms)</td><td>295</td><td>313</td><td>308</td></tr></table></body></html>

根据表6.2测试结果可以看出，对于本防伪系统来说，其在不同角度下的防伪验证平均耗时大致相等，且系统的总体验证耗时较短，防伪系统的性能较好，能够满足人们对于防伪系统性能的需求。

# 6.4防伪系统防伪测试

# 6.4.1防伪系统防伪准确性测试

在进行防伪系统的防伪准确性测试过程中，主要是测试系统的防伪效果，并以此来判断出防伪系统是否达到期望的防伪效果，即在满足用户可以直接获取防伪验证结果的同时，系统可以做到真正的防复制效果。

![](images/a345aa8071364f66a45e83ed77b67b0a52f989af5a6aa827f4e3afb0b023a582.jpg)  
图6.3测试所用防伪标签

此测试的对象为包含正确信息的随机红色斑点涂层二维码，防伪标签如图6.3所示，测试过程可以表述如下：

（1)按照防伪系统程序的引导，分别从手机正对防伪标签，手机向左倾斜45度对准防伪标签，手机向右倾斜45度对准防伪标签三个方向对防伪标签的特征矢量进行提取，同时每个方向提取的特征矢量数据为100条。

（2）对每个方向的100条特征矢量数据，分别进行平均运算，得到每个方向特征矢量数据的平均值，从而形成每个方向的特征矢量数据矩阵。同时，对于正对方向，记录其包含特征信息的3x5 矩阵数据，其中，3表示特征矢量中的三个数据值，分别为红色涂层颗粒的重心点坐标 $( \mathrm { X g , Y \underline { { \mathrm { g } } } ) }$ 和红色涂层颗粒的面积Sq，5表示防伪标签的5个随机红色涂层颗粒。而对于向左倾斜45度和向右倾斜45度，记录其包含特征信息的2x5 矩阵数据，其中不包含红色涂层颗粒的面积 Sq数据，其他与正对方向矩阵数据类似。同时，计算所有方向数据的均方根误差，并以此得到其误差控制范围。最后将3个方向的特征矢量信息矩阵和误差范围区间值上传到服务器。

（3）当需要进行防伪验证时，再次按照系统程序的引导，首先让手机正对防伪标签，此时获得其特征矢量数据矩阵，并上传到服务器进行验证。当验证不通过时，告诉用户防伪标签为假，反之，提示用户继续开始手机向左倾斜45度和手机向右倾斜45度验证。

（5）当上述所有验证全部结束后，防伪系统程序显示最终的验证结果。

（6）重复操作（3）至操作（5)，并计算最终的防伪准确度。

根据上述的防伪测试过程，可以得到如表6.3至表6.5（表中单位为：二维码的单个黑白格）所示，防伪系统中的手机在不同角度下，采集100条数据，获得不同手机角度的特征矢量平均值和均方根误差值。

表6.3防伪系统特征矢量平均值和均方根误差值（正对防伪标签）  

<html><body><table><tr><td rowspan="2">编号</td><td colspan="2">Xg</td><td colspan="2">Yg</td><td colspan="2">Sq</td></tr><tr><td>特征值</td><td>RMSE</td><td>特征值</td><td>RMSE</td><td>特征值</td><td>RMSE</td></tr><tr><td>1</td><td>2.769465058</td><td>0.018337492</td><td>14.21724175</td><td>0.027020261</td><td>3.708498504</td><td>0.051410968</td></tr><tr><td>2</td><td>6.387323413</td><td>0.018637312</td><td>19.49253468</td><td>0.020664282</td><td>2.912516196</td><td>0.043889954</td></tr><tr><td>3</td><td>12.4491433</td><td>0.022228233</td><td>24.44240772</td><td>0.018821088</td><td>3.183821692</td><td>0.042762084</td></tr><tr><td>4</td><td>16.82450739</td><td>0.025503626</td><td>5.148415866</td><td>0.016934411</td><td>3.424251678</td><td>0.051115121</td></tr><tr><td>5</td><td>23.33789959</td><td>0.019496043</td><td>11.5533224</td><td>0.018144641</td><td>3.12472508</td><td>0.040045187</td></tr></table></body></html>

表6.4防伪系统特征矢量平均值和均方根误差值（向左倾斜45-度对准防伪标签）  

<html><body><table><tr><td rowspan="2">编号</td><td colspan="2">Xg</td><td colspan="2">Yg</td><td colspan="2">Sq</td></tr><tr><td>特征值</td><td>RMSE</td><td>特征值</td><td>RMSE</td><td>特征值</td><td>RMSE</td></tr><tr><td>1</td><td>2.507027965</td><td>0.031232277</td><td>14.84514551</td><td>0.02498827</td><td>3.242119801</td><td>0.047468779</td></tr><tr><td>2</td><td>6.063244424</td><td>0.031689211</td><td>20.2686153</td><td>0.022393414</td><td>2.830580757</td><td>0.077801877</td></tr><tr><td>3</td><td>12.11737226</td><td>0.036836777</td><td>25.2395071</td><td>0.022025187</td><td>3.150331557</td><td>0.07058159</td></tr><tr><td>4</td><td>16.56212046</td><td>0.025486614</td><td>5.919299965</td><td>0.024475252</td><td>3.52202539</td><td>0.050239463</td></tr><tr><td>5</td><td>23.06747379</td><td>0.02532696</td><td>12.28499179</td><td>0.020114618</td><td>3.040669553</td><td>0.061649607</td></tr></table></body></html>

表6.5防伪系统特征矢量平均值和均方根误差值（向右倾斜45度对准防伪标签）  

<html><body><table><tr><td rowspan="2">编号</td><td colspan="2">Xg</td><td colspan="2">Yg</td><td colspan="2">Sq</td></tr><tr><td>特征值</td><td>RMSE</td><td>特征值</td><td>RMSE</td><td>特征值</td><td>RMSE</td></tr><tr><td>1</td><td>2.520818827</td><td>0.027556038</td><td>12.62170407</td><td>0.056164346</td><td>4.624069037</td><td>0.12093262</td></tr><tr><td>2</td><td>6.161781392</td><td>0.020709574</td><td>17.76361609</td><td>0.049223543</td><td>3.457416532</td><td>0.099878569</td></tr><tr><td>3</td><td>12.27379761</td><td>0.022438848</td><td>22.55390768</td><td>0.0411642</td><td>3.996456585</td><td>0.058853864</td></tr><tr><td>4</td><td>16.67703409</td><td>0.030814474</td><td>3.279810908</td><td>0.036329602</td><td>4.730454264</td><td>0.126346066</td></tr><tr><td>5</td><td>23.27128557</td><td>0.03094298</td><td>9.918532753</td><td>0.043445141</td><td>3.881043987</td><td>0.160425879</td></tr></table></body></html>

同时按照上述流程，根据表6.3至表6.5的数据信息，确定服务器中所存数据的具体值和判断误差范围。同时对防伪标签进行100次不同角度测试，最终得出如表6.6所示的防伪系统准确度测试数据。

表6.6防伪系统准确度测试数据  

<html><body><table><tr><td>防伪系统</td><td>准确度</td></tr><tr><td>含有5个红色随机涂层的防伪标签</td><td>0.98</td></tr></table></body></html>

根据上述的测试结果，本防伪系统采用5个红色随机涂层制作的防伪标签，其防伪准确度为0.98，已经能充分满足防伪的实际需求。本文提出的防伪系统解决方案是稳定有效的。

同时，为了验证防伪系统的防复制功能，本文将直接复制上文的防伪标签，从而形成包含随机红色斑点的二维码图像（无涂层)，并按照上述的测试流程，测试其防复制效果。其最终数据如表6.7所示。

表6.7复制防伪标签测试数据  

<html><body><table><tr><td>防伪系统</td><td>通过率</td></tr><tr><td>复制防伪标签</td><td>0</td></tr></table></body></html>

从图6.7显示测试数据我们可以看出，当直接复制本课题研究所提出的防伪标签时，防伪系统对于复制防伪标签的通过率为0,即防伪系统具备完全防止复制的能力。

# 6.4.2防伪系统在不同光照条件下防伪测试

在本课题提到的防伪系统解决方案中，因为包含图像处理部分，因此防伪验证结果可能会受到光照条件的影响而不同。所以，在防伪系统的防伪测试中，同时进行了同种设备在不同光照条件下的防伪测试。如图6.4所示，分别显示强光，正常光，弱光，微弱光四种不同光照条件下的手机程序运行界面。

![](images/a56714d0ffff50b6a33b61df62ac7cb8b7bc8281c96c2a6a71786f14ad6b987b.jpg)  
6.4不同光照条件下手机软件运行界面

同时，对四种不同光照条件下，防伪系统的防伪准确度测试结果如下，表6.8所示。

表6.8不同光照条件下防伪系统准确度测试  

<html><body><table><tr><td>编号</td><td>光照条件</td><td>准确度</td></tr><tr><td>1</td><td>正常光（灯光）</td><td>0.98</td></tr><tr><td>2</td><td>正常光（日光）</td><td>0.98</td></tr><tr><td>3</td><td>弱光</td><td>0.97</td></tr><tr><td>4</td><td>微弱光</td><td>无法识别</td></tr></table></body></html>

根据表5.4的测试结果，我们可以得出：

光照对于防伪系统的准确度有一定的影响，在微弱光条件下影响较大，防伪系统无法正常运行。在其他光照条件下，防伪系统能够正常工作，光照条件对于防伪系统准确度影响较小。分析上述现象的原因，主要是由于不同的光照条件影响防伪标签中随机红色涂层颗粒的识别。但是，在日常生活中，防伪系统的运行环境大多为正常光或者弱光，在这种情况下，防伪系统能够满足人们的防伪需求。

# 6.4.3防伪系统在不同设备条件下防伪测试

为了验证防伪系统对不同设备的兼容性，本文测试了在多个不同型号的手机设备下，防伪系统的防伪效果。其测试对象如下（对于多摄像头手机设备，以下只列举其主摄像头像素值)：

（1）华为P20：Android10系统，6GB运行内存，麒麟970处理器，摄像头1200万像素；

（2）华为nova5ipro：Android9系统，8GB运行内存，麒麟810 处理器，摄像头4800万像素；（3）vivoX27：Android9系统，8GB运行内存，晓龙710处理器，摄像头4800万像素；（4）vivo iqoo Neo：Android9系统，6GB运行内存，晓龙845处理器，摄像头1200万像素。通过上述在不同设备下，对防伪系统的测试表示，此四种不同的设备皆可以完成防伪验证，并给出正确的防伪判断结果。但是由于不同设备的性能和手机像素等硬件设备的不同，其防伪验证测试速度会有些许的不同。

# 6.5本章小结

本章主要介绍了随机涂层二维码防伪系统的相关测试。文中首先对防伪系统测试的测试框架和测试环境进行介绍，然后分别对防伪系统进行功能介绍和性能介绍，同时重点对防伪系统的防伪准确度进行测试，并在不同环境光和不同设备条件下进行进一步准确度测试。最后结果表明，本研究课题所提出的防伪系统能够满足人们对防伪技术的需求。

# 第7章总结与展望

# 7.1本文工作总结

本文在介绍并分析了国内外现有防伪技术的主要原理和实现方式的基础上，总结出目前所采用的防伪技术解决方案所存在的主要问题，即用户无法直接判断或防伪技术无法完全做到防复制功能，从而提出并实现一种解决上述问题的新型防伪技术—一基于图像处理的随机涂层二维码防伪系统。该系统主要依赖于开发的手机端APP和服务端应用程序进行防伪验证，具备完全防复制，操作便捷和识别率高等特点。同时，在本研究课题的研究和实现过程中，所做出的工作及取得的结果主要包括以下几个方面。

（1）对目前广泛采用的几种防伪技术解决方案进行介绍，总结出其主要技术原理和应用范围，指出其中的不足之处，并针对这些不足，提出自己的防伪技术解决方案。

（2）在介绍了本文所涉及的图像处理和二维码基础知识的前提下，对本文所提出的基于图像处理的随机涂层二维码防伪技术的研究进行了介绍，并重点对防伪系统方案中的随机涂层特征信息的提取和验证的研究进行了阐述。最后验证并确定了最终的防伪技术实现方法。

（3）对防伪系统的进行了需求分析和可行性分析，确定了防伪系统存在的必要性和可实现性。同时对防伪系统的初步方案进行了介绍。

(4)在阐述了本课题研究所提出了防伪系统解决方案的整体设计方案的基础上，对系统的各个模块进行了设计和实现。并最终通过了预期的测试目标。

通过本文最后的实际测试结果表明，防伪系统的防伪准确度能够达到0.98，且能够做到真正的防伪防复制功能。同时，防伪系统受一定范围内光照条件的影响，但是对于日常生活中的环境光，本防伪系统同样具备较高的防伪准确度，且本防伪系统能够在不同的Android设备下完整运行。防伪系统能够达到预期的防伪效果要求。

# 7.2不足和展望

本研究课题所提出的防伪系统解决方案，在研究和实现过程中，依然还存在着一些不足之处可以进行进一步的改善和提高：

（1）本文所提出的防伪解决方案，在进行防伪标签特征信息提取时，会由于光照等外界环境的影响，使得防伪标签中有色随机涂层颗粒在进行图像处理过程中，产生一定的误差。虽然本文通过基于区域增长的图像分割方案，尽可能地降低了此误差，但是在下一步工作中，希望将其与人工智能等技术相结合，从而进一步降低此误差，使得本防伪系统能够适应更加恶劣的环境光影响。

（2）在对防伪系统进行测试过程中，由于条件受限等各方面影响，在进行防伪系统防伪准确度测试中，制作的防伪标签并非完全理想，进而影响最后的防伪准确度测试结果。下一步工作，为了进一步更加精确地了解本系统的防伪准确度，将制作更加理想的防伪标签。

（3)目前本防伪系统在实现过程中，由于作者本身所掌握的编程语言范围有限，在客户端的实现中，仅仅只是实现了Android运行环境这一种平台版本。为了防伪系统更加适用于不同手机设备用户，在下一步开发实现工作中，将进一步实现同样稳定可靠地在iOS系统环境下运行的手机APP。

# 参考文献

[1]杨昌荣．探究信息不对称下的假冒伪劣现象[J]．现代商业,2019(16):160-161.   
[2]周劲松．点阵防伪码的设计与实现[D].浙江大学,2016.   
[3] 张理智．论假冒伪劣产品的成因及其治理[J].经济研究,1994(01):51-57.   
[4] 芦佳,卫强,陈兵.基于RFID技术的防伪平台的设计与实现[J]．计算机技术与发 展,2012,22(05):233-236+241.   
[5] Jordan,Fréderic,MeylanR,Kutter M.METHOD FOR PREVENTING COUNTERFEITING OR ALTERATION OFAPRINTED ORENGRAVED SURFACE[J]. 2010.   
[6]谭俊峤.国内外防伪技术的市场应用及其发展前景[J].今日印刷,2006(07):2-5.   
[7]朱则刚.探秘印刷防伪油墨及其防伪技术[J].印刷质量与标准化,2015(03):8-15.   
[8] Andres J,Hersch RD,Moser JE, et al.A New Anti-Counterfeiting Feature Relying on Invisible Luminescent Full Color Images Printed with Lanthanide-Based Inks[J]. Advanced Functional Materials, 2014, 24(32):5029-5036.   
[9]陈蕊丽.浅谈我国的印刷防伪技术及发展趋势[J].中国防伪报道,2004(06):11-13.   
[10]郭彦峰.香烟类商品的组合防伪包装[J].包装工程,2002(01):34-37.   
[11].电码防伪技术[J].中国防伪,2005(01):36-37.   
[12]Qiwei L . Research and Design on Radio Frequency Identification Reader[C]// IEEE International Workshop on Anti-counterfeiting. 0.   
[13]Devadas S,Suh E,Paral S, et al.Design and Implementation of PUF-Based Unclonable RFID ICs for Anti-Counterfeiting and Security Applications[C]// RFID, 2008 IEEE International Conference on. IEEE,2008.   
[14]Chunying Kang. Research on-Generation Algorithm of Bmp Format Twodimensional Code Image[C]// International Conference on Fuzzy Systems & Knowledge Discovery. IEEE Computer Society, 2009.   
[15]Chen T .The Application of Bar Code Forgery-Proof Technology in the Product Sales Management[M. IEEE Computer Society,2008.   
[16]Xuechen H . The Two-Dimensional Bar Code Application in Book Management[C]// International Conference on Web Information Systems & Mining.IEEE,2010.   
[17]肖菲菲,刘真.二维码防伪技术在可变数据印刷中的应用[J].包装工 程,2011,32(21):102-105+109.   
[18]于英政.QR二维码相关技术的研究[D].北京交通大学,2014.   
[19]Tiwari S .An Introduction to QR Code Technology[C]//International Conference on Information Technology. IEEE,2017.   
[20]Liu Y, Yang J,Liu M.Recognition of QR Code with Mobile Phones[C]// Control & Decision Conference.IEEE, 2008.   
[21]Liu T Y, Tan TH, Chu YL . QR Code and Augmented Reality-Supported Mobile English Learning System[C]//Mobile Multimedia Processing: Fundamentals, Methods,& Applications. Springer Berlin Heidelberg, 2008.   
[22] Tarjan L,?enk, Ivana, Tegeltija S,et al. A readability analysis for QR code application in a traceability system[J]. Computers and Electronics in Agriculture, 2014, 109:1-11.   
[23]Han S,Bae HJ,Kim J, et al. Biomedical Applications: Lithographically Encoded Polymer Microtaggant Using High - Capacity and Error - Correctable QR Code for Anti - Counterfeiting of Drugs (Adv. Mater. 44/2012)[J]. advanced materials, 2012, 24(44):5924-5929.   
[24]王英，曾光宇．图像去噪算法研究[J]．电脑与信息技术,2011(04):12-16.   
[25]关新平，赵立兴，唐英干．图像去噪混合滤波方法[J]．中国图象图形学报, 2005(03):69-74.   
[26]吴玉莲.图像处理的中值滤波方法及其应用.Diss.西安：西安电子科技大学, 2006.   
[27]贺东霞.数字图像去噪算法的研究与应用[D].Diss.延安大学,2015.   
[28]林开颜,吴军辉,徐立鸿.彩色图像分割方法综述[J].中国图象图形学报,2005(01):1- 10.   
[29]Schwarz M W, Cowan WB ,Beatty JC .An experimental comparison of RGB, YIQ,LAB, HSV, and opponent colour models[J]. ACM Transactions on Graphics, 1987, 6(2):123-158.   
[30]Soleimanizadeh S,MohamadD, SabaT,et.al.RecognitionofPartially_Occluded. Objects Based on the Three Different Color Spaces (RGB, YCbCr,HSV)[J]. 3d Research, 2015, 6(3):22.   
[31]谢鹏鹤．图像阈值分割算法研究[D].湘潭大学,2012.   
[32]彭志勇,常发亮,刘洪彬,别秀德.基于HSV模型和特征点匹配的行人重识别算法 [J].光电子·激光,2015,26(08):1575-1582.   
[33]段瑞玲,李庆祥,李玉和.图像边缘检测方法研究综述[J].光学技术,2005(03):415- 419.   
[34]张美静．亚像素边缘检测技术研究[D].沈阳理工大学,2013.   
[35] Tang J .A Color Image Segmentation algorithm Based on Region Growing[C]// International Conference on Computer Engineering & Technology. IEEE, 2010.

[36]罗希平,田捷,诸葛婴,王靖,戴汝为.图像分割方法综述[J].模式识别与人工智能，1999,12(03):300-312

[37]牛彦.关于透视变换的研究[J.计算机辅助设计与图形学学报,2001(06):549-551.[38]代勤,王延杰,韩广良.基于改进Hough变换和透视变换的透视图像矫正[J].液晶

与显示,2012,27(04):552-556.[39]孔贝贝.ZXing条形码扫描技术在移动数字图书馆中的应用[J].电脑知识与技术,2016,12(27):196-198.

[40]刘慧英,王小波.基于OpenCV的车辆轮廓检测[J].科学技术与工

程,2010,10(12):2987-2991.

[41]常胜利.多边形重心坐标的求法[J].高等数学研究,2005(02):21-23.[42]关箭,陈永仁,张晓明．二维码防伪技术在商品包装上的发展应用[J].科技传

播 $, 2 0 1 3 , 5 ( 2 2 ) ; 1 7 1 + 1 6 7 .$

[43]吕伟．嵌入数字水印的可变二维码技术研发[J].数字印刷,2017(10):37-38.  
[44]齐年强.RSA算法在二维码防伪技术中的应用研究[D].南京邮电大学,2017.  
[45]赵晓琼.基于异形二维码的商业防伪研究与实现[D].西安理工大学,2018.  
[46]付延松．基于移动端的二维码防伪系统设计[D].杭州电子科技大学,2015.  
[47]李陈伟.基于二维码的图书防伪技术研究[D].南京师范大学,2014.[48]李鹏．基于商密二维码和数字水印的防伪图码的研究与设计[D].吉林大学,2013.  
[49]任乐义．基于数字加网的半色调防伪技术的研究[D].南京林业大学,2012.

[50]沈嘉文.基于信息隐藏的二维码防伪系统研究与实现[D].电子科技大学,2019.[51]宋平波,李云,杨豪杰.Android内存管理机制研究[J].移动通信,2015,39(07):92-96.[52]赵宏伟.AndroidNDK开发环境实现与应用[J].电脑知识与技术,2010,6(35):10055-

10057+10060:

[53]陈三清,张靖.基于Android智能手机的方向传感器应用开发[J].无线互联科

技,2017(18):58-60.

[54]王丽华.安卓内置方向传感器应用——指南针[J].科技经济市场,2015(12):16-18.[55]洪超.基于多传感器的安卓平台室内导航技术研究[D].电子科技大学,2015.[56]王玉英.基于JSP的MySQL数据库访问技术[J].现代计算机(专业

版),2010(14):67-70.

[57]赵鹤芹.设计动态网站的最佳方案:Apache+PHP+MySQL[J].计算机工程与设计 $2 0 0 7 ( 0 4 ) { : } 9 3 3 { - } 9 3 4 { + } 9 3 8 .$

[58]边清刚,潘东华.Tomcat和Apache集成支持JSP技术探讨[J].计算机应用研究,2003(06):12-14.

# 致谢

时光匆匆，短短两年的研究生生涯即将结束。在这短短的两年时光中，在老师和师兄师姐的帮助下，自己收获了很多，也成长了很多。在此，对他们的帮助表示诚挚的感谢。

在两年的研究生时光里，最感谢的是我的研究生导师，孙向明教授。这两年来，在老师的教导和帮助下，自己不仅学会了如何开展自己的科研活动，更学会了应该以怎样的态度对待自己的科研学习。在研究生期间，老师不仅通过循循善诱的方式引导着自己去学会开展科研，而且有时还会通过手把手教写代码的方式让自己更加深入的体会到代码编写的流程和方法。同时，自己在科研活动中的某些自身缺点，也是在老师的提醒下发现并且慢慢改正，老师教会了我以正确的心态对待自己的科研。老师对我的这些教导不仅帮助了我顺利地完成了自己的研究生阶段学习，更是对我以后的工作和学习产生了重要的影响，让我拥有了更加自信和积极地心态对待自己的未来。

当然也特别感谢黄光明老师、裴骅老师、王东老师、郭迪老师、孙大明老师对我研究生阶段学习的帮助，正是因为他们有形的帮助或者无形的影响，让我更加顺利地完成自己的研究生生涯。

同时，特别感谢实验室师兄师姐对我平时学习的帮助，感谢樊艳师姐、子轩师姐、干干、司马师兄在学习的过程中给与不同的关心和帮助。正是因为他们无私的帮助给了我前进的动力。

最后，在今年这个特殊的年份里，因为疫情的原因是我无法按时返校。因此，特别感谢家人在疫情期间对我学习上的支持和感谢，感谢程程表弟和思杰表弟在我学习低谷的时候，给了我不断地鼓励。

两年的研究生生涯马上结束，我会以更加高昂的姿态，在老师和同学们的帮助下，在家人们的陪伴下，努力向前！