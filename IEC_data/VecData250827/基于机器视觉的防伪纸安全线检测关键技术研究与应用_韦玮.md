# 机械科学研究总院硕士学位论文

基于机器视觉的防伪纸安全线  
检测关键技术研究与应用  
Research and Application of Key Technical of  
Antifalsification Paper Security Thread Inspection  
Based on Machine Vision

培养单位：机械工业自动化研究所专 业：控制理论与控制工程研究方向：工业自动化系统集成研究生：韦玮指导教师：谢兵兵研究员协助指导教师：王文生高级工程师

# 机械科学研究院硕士学位论文

基于机器视觉的防伪纸安全线  
检测关键技术研究与应用  
Research and Application of Key Technical of  
Antifalsification Paper Security Thread Inspection  
Based on Machine Vision

培养单位：北京机械工业自动化研究所专 业：控制理论与控制工程研究方向：工业自动化系统集成研究生: 韦玮指导教师： 谢兵兵 研究员协助指导教师： 王文生 高级工程师二〇〇七年 七月 十五日

# 机械科学研究总院

本论文经答辩委员会全体委员审查，确认符合机械科学研究总院硕士学位论文质量要求

答辩委员会签名：

主席：（工作单位职称）相延飞 北京师范大学这明G研克中

委员：

康书 中国机电一体的动会 讲高  
郑心 北京机械业自动化研务所 开高  
长数全 张影 车械化的 2  
导师： 谢兴2文生

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

# 独创性声明

，本人声明所呈交的学位论文是本人在导师指导下进行的研究工作及取得的研究成果。据我所知，除了文中特别加以标注和致谢的地方外，论文中不包含其他人已经发表或撰写过的研究成果，也不包含为获得机械科学研究院或其他教育机构的学位或证书而使用过的材料。与我一同工作的同志对本研究所做的任何贡献均已在论文中作了明确的说明并表示谢意。

# 学位论文版权使用授权书

本学位论文作者完全了解机械科学研究院有关保留、使用学位论文的规定，有权保留并向国家有关部门或机构送交论文的复印件和磁盘，允许论文被查阅和借阅。本人授权机械科学研究院可以将学位论文的全部或部分内容编入有关数据库进行检索，可以采用影印、缩印或扫描等复制手段保存、汇编学位论文。

（保密的学位论文在解密后适用本授权书）

学位论文作者签名：丰签字日期： $2 0 0 7$ 年7月15日

![](images/70faeaef714bcd7993d3c01c9b923de6e4bcf84d88eab53db0d816db5b3d1cf0.jpg)

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

# 基于机器视觉的防伪纸安全线检测关键技术研究

# 摘要

目前，我国防伪纸张安全线的检测绝大部分依靠人力完成，检测速度慢，易漏检。本文提出了一种基于机器视觉技术的低成本/高性能的实时自动检测方法，对自动检测系统的构成、高清晰度图像的获取以及图像的实时处理算法等进行了比较深入的研究，在国内首次成功地解决了防伪纸张安全线在线自动检测的难题。该系统具有实时在线、高速、非接触和全自动测量的特点。

本文在以下几个方面进行了深入的研究和讨论，主要内容有：

(1)基于线扫描相机的机器视觉系统的构成；(2)适用于防伪纸全息开窗安全线检测的照明方法和高清晰度图像的获取；(3)防伪纸全息开窗安全线图像处理的算法，包括：阈值化、模版匹配、Blob 分析和边缘检测等。本文通过理论研究和实验分析，证明了使用基于线扫描相机的机器视觉系统用于防伪线全息开窗安全线检测的可行性。

关键词：机器视觉 全息安全线 线扫描相机 阈值化 模版匹配 Blob 边缘检测

# Research on Key Technical of Antifalsification Paper Security Thread Inspection Based on Machine Vision

ABSTRACT

Now in China, Most inspection on antifalsifiaction paper security thread is made manually. The.inspection is slow and easy to make mistake. In this paper，a real-time inspect method which is based on the machine vision technical has been put forward，this method is low-cost and high-performance.We have researched on the frame of the inspection system, how to get the high-quality image and the real-time image processing arithmetic. In china, the problem of real-time inspection of antifalsifiaction paper security thread has been successfully solved for the first time. The system has the features like real-time online, high-speed， no contact，automatic inspetion.

This paper has discussed the next points:

(1） The research on the frame of a type of machine vision system which based on line-scan camera.   
(2) The lighting method which is fit to the holographic windowed security thread that used in antifalsifiaction paper and the way to get high-quality image.   
(3) Image processing arithmetic such as thresholding， model match， Blob analysis and edge detection.

In this paper,author proved the feasibility of using the machine vision system based on line-scan camera to inspect the holographic windowed security thread that used in antifalsifiaction paper.

KEY WORD: machine vision holographic windowed security thread Line-scan camera thresholding model match Blob analysis edge detection

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

# 目录

摘要 IV ABSTRACT

第一章绪论.  
1.1课题背景  
1.2机器视觉简介. 3  
1.3本文研究内容. 4  
第二章高质量安全线图像的获取. 5  
2.1机器视觉系统的分类 5  
2.1.1机器视觉系统运行环境的分类， 5  
2.1.2工业相机的分类. 5  
2.2用于安全线检测的机器视觉系统 7  
2.2.1相机类型和运行环境的选择. 7  
2.2.2防伪纸安全线在线检测机器视觉系统的结构. 八  
2.3机器视觉系统采集的图像 12  
2.4小结. 13  
第三章 安全线图像的处理与分析 14  
3.1图像分割 14  
3.1.2阈值确定 16  
3.1.3安全线图像阈值化. 18  
3.2模板匹配 19  
3.2.1 去均值归一化相关法. 21  
3.2.2分层搜索 22  
3.3Blob分析. 24  
3.3.1 Blob分析概念 25  
3.3.2Blob处理结果分析 26

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

3.4尺寸测量 26

3.4.1边缘检测的概念 27  
3.4.2边缘点的定义. 27  
3.4.3边缘模型分类及其特征 28  
3.4.4 边缘检测算子 30  
3.4.5安全线全息面窗口尺寸的测量 34  
3.5小结. 35

# 第四章防伪纸安全线机器视觉在线检测实验系统． .36

4.1实验系统结构. 36  
4.2实验结果 37  
第五章总结与展望， 38  
参考文献. 39

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

# 符号清单

T—阈值  
$\mathbf { f } \left( \mathbf { x } , \mathbf { y } \right)$ ——在图像坐标 $( \mathbf { x } , \mathbf { y } )$ 处的亮度值  
（204号 $\sigma _ { \mathrm { w } } ^ { 2 }$ —一类内方差  
$\sigma _ { \mathfrak { B } } ^ { 2 }$ —一类间方差  
$\sigma _ { \Sigma } ^ { 2 }$ —一总体方差  
μ一—平均灰度  
$H _ { T } ( t )$ —一在阈值 $\mathrm { \Omega } _ { \mathrm { t } }$ 处的熵  
Pg(u,v)—一去均值归一化互相关法的匹配度量值  
$\nabla f ( x , y ) \mathrm { -- } \left( { \tt x } , { \tt y } \right)$ 处的梯度  
$\sigma$ —一滤波尺度

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

# 插图清单

图1.1防伪纸上安全线窗口的示意图·  
图1.2合格的安全线窗口与有纸病的窗口图像·  
图1.3典型的机器视觉系统… 4  
图2.1防伪纸安全线在线检测机器视觉系统结构图… :8  
图 2.2镜面反射和漫反射 .10  
图2.3亮域照明· ·10  
图2.4暗域照明… :10  
图2.5背光照明 11  
图2.6安全线检测照明方式示意图. 11  
图 2.7一大张防伪纸安全线及其局部放大的图像… ·12  
图2.8反线图像· ·12  
图2.9粗线图像… :13  
图2.10埋浆图像· :13.  
图3.1阈值化处理后的图像 ..15  
图3.2安全线图像直方图 18  
图3.3安全线图像阈值化的结果 :19  
图3.4无效窗口的图像· :20  
图3.5有效窗口位置· 20  
图3.6分层搜索 23  
图3.7模版图像 23  
图3.8进行模版匹配的搜索范围… 24  
图3.9模版匹配定位的结果… ·24  
图3.10Blob的面积和周… :25  
图3.11Blob分析前后的对比图 …26  
图3.12阶跃边缘· :28  
图3.13高斯函数平滑后的阶跃边缘· …28  
图3.14阶跃边缘的一阶导数 …29

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

图3.15阶跃边缘的二阶导数· 29  
图3.16斜坡边缘模型… ·29  
图3.17高斯函数平滑后的斜坡边缘· ·29  
图3.18斜坡边缘的一阶导数… ·29  
图3.19斜坡边缘的二阶导数· 30  
图3.20三角型屋脊边缘· ·30  
图3.21高斯平滑后的三角型屋脊边缘· ·30  
图3.22三角型屋脊边缘的一阶导数· 30  
图3.23三角型屋脊边缘的二阶导数 30  
图3.24 Roberts算子· 32  
图3.25 Sobel算子 32  
图3.26 Prewitt算子. 33  
图3.27 Laplacian算子· 33  
图3.28应用不同边缘检测算子的处理结果 35  
图4.1防伪纸安全线机器视觉在线检测实验系统结构图· 36  
图4.2防伪纸安全线机器视觉在线检测实验系统安装示意图· 37

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

# 第一章绪论

# 1.1课题背景

防伪纸，是指其表面含有标记或内层隐藏暗记(水印、图案、号码、花纹等)，不易仿造或作假使用的一类特种纸的统称。最早的防伪纸是从金融领域开始的，那时主要用在纸币印制上。后来，社会上一些不法之徒乘机制造假冒产品，以至严重地干扰市场秩序，破坏了各种有价证券的流通和有损了名牌产品商标的信誉，从而引起经济和刑事案件屡屡发生。为了制止假冒行为带来的损失，也为了维持社会稳定，必须加强和扩大对防伪纸的研制和生产，于是便有了众多防伪纸的问世和应用。

防伪纸的主要品种有：钞票纸、安全纸、保密纸、票据纸、证券纸、特殊水印纸、彩虹纸、防复印纸、激光全息防伪纸等。

全息开窗安全线是防伪纸的重要防伪手段。全息开窗安全线是在抄纸的同时将安全线抄入纸内，成为防伪纸结构的组成部分。安全线一段埋置于纸内，一段露在纸面，露出的部分是银白色的全息面，上面通常有微型的字符。其制作的技术要求很高，使伪造难以得逞。图1.1为防伪纸机生产时一幅防伪纸上安全线窗口的示意图。

![](images/020ee025084d69894fbc989e856fb74c6ffc11c2ab7b4950b67e8bdae4028418.jpg)  
图1.1防伪纸上安全线窗口的示意图

在生产过程中，防伪纸全息开窗安全线可能出现以下几种质量问题，需要进行检测：

1）“反线”(图1.2b)：合格的全息开窗安全线露在外面的部分为全息面，上面一般有微型文字。反线指的是全息开窗安全线反转，全息面被埋在纸内。

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

2)“窗口”开埋尺寸是否合格(图1.2c)：在生产防伪纸的过程中，可能会有纸浆覆盖在全息面上，造成全息面不完整或尺寸不合格。

3)安全线拉伸变形(图1.2d)：在防伪纸的生产过程中，全息开窗安全线由于种种原因受力不均，会拉伸变细。

4)出现双线和粗线(图1.2e)。

![](images/5ee661d6c0f9704c10303c97a0798f086ca3e23ea42637ae3810ed227c1f7203.jpg)  
图1.2合格的安全线窗口与有纸病的窗口图像

当前，在防伪纸的生产中，检测全息开窗安全线的合格与否主要是通过选纸工人的肉眼来判断。由于全息开窗安全线的正反面颜色相近，差别仅在于全息面能反光而反面不反光，判别比较困难。长时间工作后眼睛很容易疲劳，更难进行正确的判断。而且全息开窗安全线的一些尺寸的指标，人眼不可能准确的测量出来。微小的缺陷用人眼同样很难识别出来。“反线”的时候，由于安全线的正面反面颜色基本一样，只是有没有全息面的差别，眼睛要很仔细才能区别出来。鉴于防伪纸常常用于比较重要的场合，对出厂产品的质量要求非常高，若有病纸出厂会引起非常严重的后果。因此，这样的人工事后离线检测已经不能满足生产的需要。此外，因为是离线检测，一旦发现问题再去调整工艺往往为时已晚，大批废品已经出现。为了减少废品降低成本，进行在线检测也是必不可少的。

对防伪纸安全线进行在线检测的困难在于防伪纸机生产线的运行速度快，并且整个生产线在生产过程中存在剧烈的振动。防伪纸机在正常工作时的速度最高可达1m/s，一幅防伪纸的长度略小于600毫米，这就要求自动检测系统必须在少于600毫秒的时间内完成信号的采集、处理并给出判断结果。出于不合格的防伪纸出厂会引起很严重的问题，因此，用户的要求自动检测系统必须达到零漏检，不合格的防伪纸必须检测出来，并且误检率不能超过方分之五，这就要求自动检测系统必须十分准确。在开始本文所做的研究工作之前，国内已经有几家单位进行了对防伪纸全息安全线的在线自动检测的研究，但是都没有成功，某防伪纸厂引进的英国NOCAN公司的检测装置也没有能够解决全息安全线的检测问题。

本文研究的目的就是找到一种不会疲劳、高速、精确、可靠的在线、实时的办法对全息开窗安全线进行检测。

# 1.2机器视觉简介

机器视觉是在没有人类干预的情况下使用计算机来处理和分析图像信息并做出结论。简而言之，机器视觉就是用机器代替人眼来做测量和判断。机器视觉作为一个重要的检验方法在发达国家已经得到了广泛的应用。在现代工业自动化生产中,涉及到各种各样的检查、测量和零件识别应用。这类应用的共同特点是连续、大批量生产并对外观质量的要求非常高。通常这种带有高度重复性和智能性的工作只能靠人工检测来完成，在一些工厂的现代化流水线后面常常可看到数以百计甚至逾千的检测工人来执行这道工序。这在给工厂增加了巨额的人工成本和管理成本的同时，却仍然不能保证100%的检验合格率(即“零缺陷”）。如我国的钞票纸厂往往都有数百名检纸工在检验台前忙碌。当需要进行微小尺寸的精确快速测量、形状匹配、颜色辨识等精细检测时，用人的肉眼是根本无法连续稳定地进行的，采用其它物理量传感器也难有用武之地。将计算机的快速性、可靠性、结果的可重复性，与人类视觉的高度智能化和抽象能力相结合，由此产生了机器视觉的概念]。

一个成功的机器视觉系统是一个经过细致工程处理来满足一系列明确要求的系统。当这些要求完全确定后，这个系统就设计并建立来满足这些精确的要求。机器视觉的优点包括以下几点：

1）精度高。  
2) 连续性。  
3) 成本效率高。  
4) 灵活性[]。

机器视觉技术用计算机来分析一个图像，并根据分析得出结论。现今机器视觉有两种应用：机器视觉系统用来探测部件，即更精确地观察目标，并对哪些部件合格可以通过，哪些需要废弃做出有效的决定；机器视觉系统也可以用来创造一个部件，即运用复杂光学器件和软件结合直接指导制造过程。

尽管机器视觉应用各异，但都包括以下几个过程：

1）图像采集;

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

2) 图像处理；  
3) 特征提取;  
4 判断和控制。

典型的机器视觉系统（见图1.3）一般包括如下部分：光源，镜头,CCD（CMOS）照相机，图像处理单元(或图像采集卡），图像处理软件,监视器,通讯／输入输出单元等。

![](images/9c7cd8897d8c74287ae70f9626b4593bdfe3ead0fde90bb8fc672b7fa00b7354.jpg)  
图1.3典型的机器视觉系统

# 1.3本文研究内容

本课题旨在研究利用机器视觉技术解决防伪纸张中安全线的实时在线检测问题。全文内容如下：

第一章绪论，介绍课题研究的背景和意义，以及机器视觉的相关内容。

第二章高质量安全线图像的获取，介绍通过线扫描相机和专门设计的照明方式获取防伪纸安全线图像。

第三章安全线图像的处理分析，介绍通过对图像进行处理获取需要的信息对防伪纸安全线的纸病进行检测判断。

第四章防伪纸安全线机器视觉在线检测实验系统，介绍根据第二章和第三章的研究结果所研制的一个防伪纸安全线机器视觉在线检测实验系统，并给出了最终的实验结果。

第五章总结与展望。

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

# 第二章高质量安全线图像的获取

图像是机器视觉技术的基础。高质量的图像能够大大减轻后续的图像处理与分析的难度和工作量，而低质量的图像不但会大大增加图像处理与分析的难度与工作量，甚至可能导致机器视觉系统完全不能得出正确的判断结果。因此，要得到准确的判断结果，必须获取高质量的安全线图像。

# 2.1机器视觉系统的分类

为了获得高质量的安全线图像必须选择合适的机器视觉系统。

机器视觉系统一般包括图像采集系统、图像处理部分、通信和I/0部分以及输入输出和执行机构等。图像采集环节负责将对象的可视化图像和特征转换为能被计算机处理的一系列数据。由于机器视觉系统强调速度和精度，因此图像采集系统需要及时、准确地提供清晰图像。图像采集系统一般由光源、镜头、摄像机、图像采集卡等组成。按照不同的原则，机器视觉系统的分类可以有以下几种：

# 2.1.1.机器视觉系统运行环境的分类

按机器视觉系统的运行环境分类，可分为PC－BASED 视觉系统和嵌入式视觉系统。

基于PC的视觉系统利用了PC的开放性、高度的编程灵活性和良好的图形界面(Widows或者Linux系统),同时系统总体成本较低。基于PC的机器视觉系统在特殊和复杂的应用等高端领域中占主导地位。PC-Based系统内含高性能图像采集卡，一般可接多个相机，并提供库函数支持。

在嵌入式视觉系统中，图像处理算法加载在专门的硬件上，这些硬件包括电源模块、输入/输出模块、相机控制模块、图像控制模块等不同单元，所以嵌入式系统也叫智能相机。系统硬件一般利用高速专用ASIC或嵌入式计算机进行图像处理，系统软件固化在图像处理器中,通过类似于游戏键盘的简单装置对显示在监视器中的菜单进行配置，或在PC上开发软件然后下载。

# 2.1.2工业相机的分类

（1）以图像传感器分类:CCD相机与CMOS相机。CCD 相机：使用CCD式感光芯片为图像传感器的相机。CMOS相机：使用CM0S式感光芯片为图像传感器的相机。CCD 相机，是目前绝大多数机器视觉系统中所使用的相机。现在市场上公开销售的CCD 相机，无论是在图像格式、分辨率还是敏感度等各个方面都有着广阔的选择空间。

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

可以这样说：CCD相机所提供给我们的优越性能，可以满足 $9 9 \%$ 的项目要求.

与CCD相机相比，虽然CMOS相机有着如：工艺简单、成本低廉、低功耗、系统整合性好、区域读取图像灵活等诸多优点。但由于生产工艺上的差距，CMOS目前在除噪及灵敏度方面仍逊丁CCD,因此使得CMOS相机现在主要处于民用阶段。最近，随着工艺水平的提高，许多型号的高性能CMOS相机进入工业相机市场，但是对于整个市场来说，主流产品还是CCD相机。

(2）以图像颜色分类：单色相机与彩色相机。

单色相机：输出图像为单色图像的相机。

彩色相机：输出图像为彩色图像的相机。

多数彩色CCD相机所采用的技术，是在单一传感器前装置一系列彩色滤片，从而使不同色彩的光进入到不同CCD点像素中去，也就是说不同像素中所感受到的只是某一种单色光的灰度。

就目前的生产工艺来说，滤片的使用使得彩色相机的灵敏度远低于单色相机。同时由于彩色相机中的像素只能“存放”一种色光的灰度值，因此彩色相机的分辨率也远远不及单色相机。这便使得彩色相机目前只能用于需要“色彩认识”的系统，还不能被普通使用于高精度的测量、定位等系统。

（3）以传感器型式分类：面扫描相机与线扫描相机。

“面扫描相机：CCD感光芯片上的点阵呈面状分布的相机，其所成图像为二维“面”图像。

线扫描相机：CCD感光芯片上的点阵呈线状(一行或两行)分布的相机，其所成图像为一维“线”图像。顾名思义，线扫描相机里的CCD感光芯片是线状的(或是两条线)，但这条线的分辨率却可以很高:1k、2k、4k甚至更高。线扫描相机一次拍出的图像只是一条线。为了得到完整的二维图像，需要移动被测物或相机本身，同时间断地拍照。

与面扫描相机一次成像不同，线扫描相机需要多次拍摄，然后将所得的“线”图像拼成一幅完整的二维图像。因此，线扫描相机更多地被用于分辨率要求极高的项目里。同时它还需要大口径镜头、强亮度灯源，以适应其非常高的成像速度。

（4）以传输方式分类：模拟信号相机与数字信号相机。

模拟信号相机：在模拟信号相机中，从传感器中传出的信号，被转换成模拟电压信号，即普通视频信号，后再传到图像采集卡中。

数字信号相机：在数字信号相机中，信号自传感器中的每一个像素输出后，在相机内部就被数字化了，数字化之后的图像可直接被计算机所接受。

模拟信号相机的成本一般上低于数字信号相机。但是在除噪、速度方面则比数字信号相机差。如我们常常听到的，FTA，RS-17O，NTSC，CCTR，PAI，都是常用模拟信号传输标准。数字信号相机除了在除噪及速度方面优于模拟信号相机外，由于是数字信号传输方式，因此在计算机中所得到的由数字信号相机拍出的图像，更加“逼真”。而且，

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

数字信号相机在分辨率及成像速度方面有更多选择。数字信号相机取代模拟信号相机，是不可逆转的大趋势[2]。

# 2.2用于安全线检测的机器视觉系统

# 2.2.1相机类型和运行环境的选择

为了满足防伪纸安全线在线检测的需求，首先从相机开始选择合适的机器视觉系统方案。

因为在防伪纸安全线的检测中，色彩的信息并不重要，所以，选用单色相机。

虽然在将来，CMOS相机会取代CCD 相机成为工业相机的主流，但是就自前而言，CCD 相机占据着大部分市场，有很多厂家的很多型号可以选择。因此，选用CCD相机。

防伪纸是按照一大幅纸生产，每幅纸上有多张单元防伪纸，也就是说有多条安全线。某型防伪纸，每幅纸横向有5条安全线，两边的安全线距离600多毫米，而安全线本身只有2毫米左右宽，要准确检测出安全线的尺寸参数，需要分辨率足够高，即要求CCD相机的横向像素要比较多。如果选用面阵CCD相机，就需要为每一根安全线安装一个相机，这样成本就会很高。除此之外，由于面阵相机是一次成像，为了检测每张防伪纸的安全线，需要把整张防伪纸的纵向都要采集下来，并且又要求有一定的分辨率，这样就需要1024$\times 7 6 8$ 像素以上的相机，而当前的分辨率为 $1 0 2 4 \times 7 6 8$ 的主流相机每秒一般只能采集16帧图像，再加上图像处理的时间，其测量周期已经大于生产中每张防伪纸在生产线上走过的时间。所以，选用线阵CCD相机是较好的选择。线阵相机在横向方向上像素可以做得很多，能够满足这个应用的需要。

当前对高分辨率线阵相机支持较好的是基于PC的图像采集卡系统，嵌入式视觉系统目前对高分辨率的线阵相机支持的产品很少。嵌入式系统的图像处理功能都是比较常用的功能，通用性较好，而PC-BASED的系统除了可以拥有通用的功能外还能够自主开发针对特殊应用的算法，因此在灵活性和功能上PC-BASED的系统占有优势。

因此，选用基于PC和图像采集卡的机器视觉系统。

# 2.2.2防伪纸安全线在线检测机器视觉系统的结构

如图2.1所示，防伪纸安全线在线检测机器视觉系统由插有图像采集卡的工控机、编码器、线扫描相机、专用照明光源和横切标记传感器组成。

横切标记传感器和编码器用于产生线扫描相机拍摄所需的帧触发信号和线触发信号。

# (1）取像模式

系统采用的图像采集卡可以有六种取像模式：

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

1）固定线扫描频率模式。2）可变线扫描频率模式。3）有帧触发的固定线扫描频率模式。在该模式下，所成的每帧图像纵向线数固定，需要提供一个开始触发信号，触发帧的拍摄，当扫描的线数达到设定数值时，结束扫描，线扫描的频率固定。4）有帧触发的变线扫描频率模式。在该模式下，所成的每帧图像纵向线数固定，需要提供一个开始触发信号，触发帧的拍摄，当扫描的线数达到设定数值时，结束扫描，线扫描的频率由外部的线触发信号决定。5）帧大小可变的固定线扫描频率模式。在该模式下，所成的每帧图像纵向线数可变，需要提供一个开始触发信号，触发帧的拍摄，一个结束触发信号，结束帧的拍摄，线扫描的频率固定。6）帧大小可变的可变线扫描频率模式。在该模式下，所成的每帧图像纵向线数可变，需要提供一个开始触发信号，触发帧的拍摄，一个结束触发信号，结束帧的拍摄，线扫描的频率由外部的线触发信号决定[3]。

![](images/c9a826a4eb1f89a53a51b83b30772ab8b27bb00acbc74c86835c4b126668b3b6.jpg)  
图2.1防伪纸安全线在线检测机器视觉系统结构示意图

对于生产线上的防伪纸，每大张纸的长度是一定的，在每两张纸的连接处由一个叫做横切标记的记号来标记每张纸的开始和结束。防伪纸在生产线上运行的速度是可变的，实际生产中的速度变化范围很大。

因此，系统使用图像采集卡的第四种模式：有帧触发的变线扫描频率模式。为了获

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

取触发帧的开始信号，使用一个激光光幕传感器来检测横切标记；为了获取线触发信号，使用编码器来检测生产线上防伪纸的运行的速度，利用编码器产生的脉冲来触发线扫描。

# (2）光源

照明是机器视觉应用中非常重要的部分，照明系统的作用是为了使目标得到充分的光照，以保证像平面有足够的照度。良好的照明能够保证图像的质量，大大减轻后续图像处理的工作量，而低质量的照明不仅会加重后续图像处理的工作量，甚至可能使后续图像处理不能得到正确的结果。

机器视觉应用中常用的光源有以下几种：

1）LED(发光二极管)：优点是单色性好，寿命长，发热小，发光一致性好，随着使用时间的增加变化很小；缺点是目前价格与其它光源相比较高，发光强度较小。

2）荧光灯：荧光灯的发光频谱很宽，寿命中等，输出光强可以调节，随着使用时间的增加光强会衰减，成本低。

3）卤素灯：卤素灯有亮度高、发光效率高、形体小、成本低等优点，缺点是发热大，随着使用时间的增加光强会衰减，在大功率输出时寿命低。

4）氙闪光灯：氙闪光灯发出的高亮度的闪光，发光频谱很宽，寿命很长。

5）钨丝白炽灯：钨丝白炽灯发光频谱很宽，发光效率低，发热量大，随着使用时间的增加光强会衰减，成本低[4]。

一使用交流电源的光源受交流频率的影响会有频闪，对于采用线扫描相机的系统，每采集一线图像时间是非常短的，频闪对于采集的图像质量影响很大，因此，在使用线扫描相机时，要使用直流电源的光源。

# (3）照明方式

机器视觉系统常用的照明方式可分为透射式照明和反射式照明。

1）反射式照明：反射式照明按光反射的类型可以分为镜面反射和漫反射（见图2.2)。

镜面反射明亮但不稳定。明亮是因为反射强度与光源强度相当；不稳定是由于发光体，物体和透镜之间一个小角度的改变就可能引起镜面反射完全消失。因此使用镜面反射时，必须控制好这些角度。

漫反射暗淡但稳定。漫反射的反射强度减少到光源的0.1-0.001，且反射强度随着角度的变化而变化缓慢。

反射式照明按照明方向又可以分为亮域照明(见图2.3)和暗域照明(见图 2.4)。在亮域照明中，光线近似垂直于物体表面。整个物体显得明亮，特征以连续的灰度显示。常规的空间照明属于亮域照明，这类照明通常适用于常规的视觉应用。在暗域照明中，光源沿着近似平行于物体表面的方向进行照明，纹理和其他高角特征显得明亮，而物体的大部分显得黑暗。暗域照明适用于表面污物、刮痕和其他的小突起特征的检测[]。

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

![](images/95ed530ddfba3c218c9830e954cffc9937f55417aa71e8d3fa77c0b4152ca6cb.jpg)

![](images/e69187938e762e39dab167a7e2ca8a2868b42476f088786341f89fb9a9790c2b.jpg)  
图2.2镜面反射和漫反射

![](images/8e2820bf61416d1d8276117f766fd29577a1461dc042a9327bb9da53567e0c3c.jpg)  
图2.3亮域照明  
图2.4暗域照明

2）透射式照明：背光照明也是一种常用的照明方式(见图 2.5)。背光照明主要用于需要突出物体边缘的应用。

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

拉1二

全息安全线的正面即露在纸外的窗口部分的全息面反光性能很好，就像一面小镜子，而其反面的反光性能则和防伪纸本身差不多。根据全息安全线这一特性，使用亮域照明和镜面反射的方式就可以将全息安全线的正面与反面及防伪纸张区别出来，而通过测量全息面的宽度就可以判断安全线是否拉伸。本系统所采用的照明方式见图2.6。在实际应用中，线扫描相机拍摄的位置是在一个表面平整的大不锈钢滚轮上，防伪纸受张力作用紧紧贴在滚轮上，这样就可以保证光源、纸面和相机之间的角度基本保持不变，光源发出的光经过全息面的镜面反射始终被相机接收到。

![](images/ee5c2411960bde8eb14ee5ef5ce8dcfa35ae5b37e5f79ad6655205ef5a3852c9.jpg)  
图2.5背光照明  
图2.6安全线检测照明方式示意图

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

为了避免环境光的影响，在镜头前加装了滤光镜，滤光镜能透过红色LED光源发出的波长的光，其它波长的光则不能透过透光镜，这样，大大减小了环境光的干扰。

# 2.3机器视觉系统采集的图像

采用上述配置构成的安全线在线检测系统可以获取质量相当高的图像，这就为进一步的图象处理及判别奠定了良好的基础。该系统所采集的一大张防伪纸安全线的图像及其局部放大的图像如图2.7所示。

![](images/3091faf72782fedb0907db4704722f1a658be93e622f01cc34e1898410ef95f6.jpg)  
图2.7一大张防伪纸安全线及其局部放大的图像

从图中可以看出，安全线的全息面相对于纸面要明亮许多，这个亮度的差别已经足够进行后续的处理了。

图2.8所示为出现反线时的图像。右边红框内图像为左边红框内图像的放大。在左边的图中可以看出，左上部的安全线少了一部分窗口，而从右边放大的图中仔细看还可以看见上部有隐约的反线。

![](images/0795580853e0a07ffad7f845c2220a21b5c0372457aa7c9c2c4fe543aaa2dfbc.jpg)  
图2.8反线图像

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

图2.9所示为出现粗线时的图像，左边的图像可以清楚看见是两根安全线重叠在了一起，当两根线分开不重叠时的纸病则称为双线，其实和粗线是同一种类型的问题，只是稍有不同。图的右边为正常的安全线图像。

![](images/a1ec8d4af1eb3c9da851dd2afa03141d51d27a71be294cc35c88e4c9b2f749af.jpg)  
图2.9粗线图像

图2.10所示为出现埋浆时的图像。从图中左边放大部分可以看到全息面被纸浆遮去的部分比正常全息面的显得暗淡许多，大部分甚至完全看不见。

![](images/7cc9ffb7924a7de060fef32f4b62cd97d7e67c5f7a46194b3dd40d647bd0c427.jpg)  
图2.10埋浆图像

# 2.4小结

本章首先介绍了机器视觉系统和工业相机以及光源和照明方式的分类。针对防伪纸全息安全线的特性选择合适的系统结构、硬件以及照明方式。最后给出了在实际生产中应用本系统采集到的图像。

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

# 第三章安全线图像的处理与分析

# 3.1图像分割

在对图像数据进行分析之前，图像分割是最重要的步骤之一，它的主要目标是将图像划分为与其中含有的真实世界的物体或区域有强相关性的组成部分。图像分割的目标可以定位于完全分割，其结果是一组唯一对应于输入图像中物体的互不相交的区域；也可以将目标定位于部分分割，其中的区域并不直接对应于图像物体。

为了获得完全分割，必须与使用有关问题领域的专门知识的较高层次处理相协作。但是，有完整的一类分割问题可以仅用低层处理就可以成功解决。在这种情况下，通常图像由在均匀背景上的对比度强的物体组成。这时，可以使用简单的全局方法，就可以得到将图像划分为物体和背景的完全分割。这种处理是与上下文无关的，没有使用有关物体的模型，有关分割结果的期望知识对最终的分割也没有贡献。

如果目标是部分分割，则图像被划分为分开的相对于某个选择的性质是同态的区域，可选择的性质可以是亮度、色彩、反射率、纹理等。如果处理的是复杂场景的图像，例如城市场景的航拍照片，其结果也许是一组可能有重叠的同态区域，这样部分分割的图像必须经过进一步处理，并借助于高层信息找到最终的图像分割。

对于防伪纸安全线的检测来说，从图2.7至图2.10可以看出，我们所感兴趣的安全线全息面窗口是在比较均匀的背景.上的对比度强的物体，因此，我们分割图像的目标是完全分割。

图像数据的不确定性是主要的分割问题之一，通常伴随着信息噪声。分割方法根据所使用的主要特征可以划分为三组：第一组是有关图像或图像部分的全局知识，这种知识一般由图像特征的直方图来表达。第二组是基于边缘的分割。第三组是基于区域的分割，在边缘检测或区域增长中可以使用多种不同的特征，例如亮度、纹理和速度场等。

常用的图像分割的方法有：

1）阈值化  
2）基于边缘的分割  
3）基于区域的分割  
4）匹配  
5）高级最优边界与表面检测方法 15

阈值化是最简单的分割处理，计算代价小速度快。用一个被称为阈值的亮度常量来分割物体和背景。当物体彼此不接触，且它们的灰度与背景的灰度明显不同时，阈值化就是一个合适的分割方法。从图2.7至图2.10可以看出，防伪纸安全线的图像正是属于这一类，因此，我们使用阈值化来将所感兴趣的安全线全息面窗口从背景中分割出来。

# 3.1.1图像阈值化

图像阈值化分割是一种最常用，同时也是最简单的图像分割方法，它特别适用于目标和背景占据不同灰度级范围的图像。它不仅可以极大的压缩数据量，而且也大大简化了分析和处理步骤，因此在很多情况下，是进行图像分析、特征提取与模式识别之前的必要的图像预处理过程。图像阈值化的目的是要按照灰度级，对像素集合进行一个划分，得到的每个子集形成一个与现实景物相对应的区域，各个区域内部具有一致的属性，而相邻区域布局有这种一致属性。这样的划分可以通过从灰度级出发选取一个或多个阈值来实现。

阈值分割法的基本原理是：通过设定不同的特征阈值，把图像像素点分为若干类.常用的特征包括：直接来自原始图像的灰度或彩色特征；由原始灰度或彩色值变换得到的特征.设原始图像为 $\mathbf { f } \left( \mathbf { x } , \mathbf { y } \right)$ ，按照一定的准则在 $\mathbf { f } \left( \mathbf { x } , \mathbf { y } \right)$ 中找到特征值 $\intercal$ ，将图像分割为两个部分，分割后的图像为：

$$
g ( x , y ) = \left\{ { \begin{array} { l l } { b _ { 0 } \quad } & { f ( x , y ) < t } \\ { b _ { 1 } \quad } & { f ( x , y ) \geq t } \end{array} } \right.
$$

若取： $b _ { 0 } = 0$ （黑）， $b _ { 1 } = 1$ （白），即为我们通常所说的图像二值化(图3.1）。

一般意义下，阈值运算可以看作是对图像中某点的灰度、该点的某种局部特性以及该点在图像中的位置的一种函数，这种阈值函数可记作：

$$
\mathbb { T } \left( \mathbf { x } , \mathbf { y } , \mathbb { N } \left( \mathbf { x } , \mathbf { y } \right) , \mathbb { f } \left( \mathbf { x } , \mathbf { y } \right) \right)
$$

式中， $\mathbf { f } \left( \mathbf { x } , \mathbf { y } \right)$ 是点 $( \mathbf { x } , \mathbf { y } )$ 的灰度值； $\mathbb { N } \left( \mathbf { x } , \mathbf { y } \right)$ 是点 $( \mathbf { x } , \mathbf { y } )$ 的局部邻域特性.根据对 $\intercal$ 的不同约束，可以得到3种不同类型的阈值，即：

24733 24733（原始图像） （阈值分割后的二值化图像）

（1）点相关的全局阈值 $\scriptstyle \mathsf { T } = \mathsf { T } \left( \mathbf { f } \left( \mathbf { x } , \mathbf { y } \right) \right)$ ） (只与点的灰度值有关)(2）区域相关的全局阈值 $\mathsf { T } \mathop { = } \intercal \left( \mathsf { N } \left( \mathbf { x } , \mathbf { y } \right) , \mathrm { f } \left( \mathbf { x } , \mathbf { y } \right) \right)$ （与点的灰度值和该点的局部邻域特征有关)(3）局部阈值或动态阈值 $\mathsf { T } \mathrm { = } \mathsf { T } \left( \mathbf { x } , \mathbf { y } , \mathsf { N } \left( \mathbf { x } , \mathbf { y } \right) , \mathsf { f } \left( \mathbf { x } , \mathbf { y } \right) \right)$ （与点的位置、该点的灰度值和该点邻域特征有关)

# 3.1.2阈值确定

图像阈值化如同其他图像分割算法一样，没有一个现有方法对各种各样的图像都能得到令人满意的结果，甚至也没有个理论指导我们选择特定方法处理特定图像。

所有这些阈值化方法，根据使用的是图像的局部信息还是整体信息，可以分为上下文无关(non-contextual)方法(也叫做基于点(point-dependent)的方法)和上下文相关(contextual)方法(也叫做基于区域(region-dependent)的方法);根据对全图使用统一阈值还是对不同区域使用不同闻值，可以分为全局阈值方法(globalthresholding)和局部阈值方法(localthresholding，也叫做自适应阈值方法adaptivethresholding);另外，还可以分为双阈值方法(bileverthresholding)和多阈值方法(multithresholding)

常用的全局阈值确定方法有：

1）交互实验法。如果分割之前知道图像的一些特征，那么阈值确定比较简单，只要试验不同的阈值，然后看是否满足已知特征即可。比如一张打印纸，如果已知打印的字符占一张纸上的面积的百分比，就可以找到合适的阈值，使该条件得到满足。再比如，如果知道前景的平均灰度，那么就可以进行逐一的阈值实验，直到找到合适的阈值。不过这种方法需要知道图像的某些特征，而很多时候是事前不可知的。

2） $\mathfrak { p }$ 率阈值化法(p-tile thresholding)。1962年Doylel提出的p率阈值化法使目标或背景的像素比例等于其先验概率来设定阈值，简单高效，但是对于先验概率难于估计的图像却无能为力。例如，根据先验知识，知道图像目标与背景像素的比例为 $P _ { 0 } / P _ { B }$ ，则可根据此条件直接在图像直方图上找到合适的阈值T，使 $\mathbf { f } \left( \mathbf { x } , \mathbf { y } \right) \geqslant \mathbf { T }$ 的像素为目标， $\mathbf { f } \left( \mathbf { x } , \mathbf { y } \right) < \mathbb { T }$ 的像素为背景。

3）迭代法。将初始阈值选取为图像的平均灰度 $\mathbf { T } _ { 0 }$ ，然后用 $\Upsilon _ { \mathfrak { o } }$ 将图像的像素点分作两部分，计算两部分各自的平均灰度，小于 $\mathbf { T } _ { 0 }$ 的部分为 $\mathbf { T _ { A } }$ ，大于 ${ \bf T } _ { 0 }$ 的部分为 $T _ { \mathfrak { s } }$ ，计算 $\mathrm { { T } _ { 1 } = \frac { \mathrm { { T } _ { A } + \mathrm { { T } _ { B } } } } { 2 } }$ ，将 $\mathbf { T } _ { 1 }$ 作为新的全局阈值代替 ${ \bf T } _ { 0 }$ ，重复以上过程，如此迭代，直至 $\mathbf { T _ { k } }$ 收敛，即 $\mathbf { T } _ { \mathbf { k } + 1 } = \mathbf { T } _ { \mathbf { k } }$ 。

4）直方图法。如果前景物体内部灰度值分布比较均匀，背景灰度值的分布也是比较均匀的，这个图像的灰度直方图将有明显双峰。当一幅图像的直方图具有双峰时，可以选择两峰之间的谷点作为门限值。该方法简单，但是当两个峰值相差很远时不适用，因为前景和背景很可能有一部分灰度值是共有的。随着区域分割研究的不断深入，图像并行分割不但可以有一个阈值，还可以有多个阈值。

采用一个阈值的方法比较容易受到噪声的影响，这些影响会在直方图中出现虚极值而导致阈值选取的误差。用直方图分析的方法，可以从直方图上看见多个峰值，而每两个峰值之间的谷点就可以作为分割的阈值。在适当的谷点位置，选择一个阈值。多个峰值带来了另外一个问题，如何利用这些阈值进行图像分割。一般而言，这些阈值的选取和应用要根据实际情况，具体判定。

5）最大类间方差法。由 $0 \mathrm { t } \mathsf { s u } ^ { \mathtt { f } \mathtt { f } \mathtt { j } }$ 于1978年提出的最大类间方差法以其计算简单、稳定有效，一直广为使用。从模式识别的角度看，最佳阈值应当产生最佳的目标类与背景类的分离性能，此性能我们用类别方差来表征，为此引入类内方差$\sigma _ { \mathbf { w } } ^ { 2 }$ 、类间方差 $\sigma _ { \mathfrak { B } } ^ { 2 }$ 和总体方差 $\sigma _ { \Sigma } ^ { 2 }$ ，并定义三个等效的准则测量：

$$
\lambda = \frac { \sigma _ { \mathrm { B } } ^ { 2 } } { \sigma _ { \mathrm { w } } ^ { 2 } } , ~ \kappa = \frac { \sigma _ { \Sigma } ^ { 2 } } { \sigma _ { \mathrm { w } } ^ { 2 } } , ~ \eta = \frac { \sigma _ { \mathrm { B } } ^ { 2 } } { \sigma _ { \Sigma } ^ { 2 } }
$$

考虑到计算量，人们一般通过优化第三个准则获取阈值。此方法也有其缺陷，Kittler和Illingworth的实验揭示:当图像中目标与背景的大小之比很小时方法失效。

在实际运用中，往往使用以下简化计算公式：

$$
\mathfrak { C } ^ { 2 } ( \mathrm { T } ) = \mathrm { W } _ { \mathrm { A } } \left( \mu _ { \mathfrak { a } } - \mu \right) ^ { 2 } + \mathrm { W } _ { \mathrm { B } } \left( \mu _ { \mathfrak { b } } - \mu \right) ^ { 2 }
$$

其中， $\bullet ^ { 2 }$ 为两类间最大方差， $\mathbf { \bar { W } } _ { \mathbf { \bar { A } } }$ 为 $\mathtt { A }$ 类概率， $\mu _ { \mathrm { a } } ^ { - }$ 为A类平均灰度， ${ \bf W _ { \theta _ { B } } }$ 为B类概率， $\mu _ { \mathrm { { b } } }$ 为 $B$ 类平均灰度， $\mu$ 为图像总体平均灰度。即阈值 $\uparrow$ 将图像分成A,B两部分，使得两类总方差 $\sigma ^ { 2 } ( \mathrm { T } )$ 取最大值的 $\intercal$ ，即为最佳分割阈值。

6）熵方法。80年代以来，许多学者将Shannon信息熵的概念应用于图像阈值化，其基本思想都是利用图像的灰度分布密度函数定义图像的信息熵，根据假设的不同或视角的不同提出不同的熵准则，最后通过优化该准则得到阈值。Pun[9]通过使后验熵的上限最大来确定阈值。Kapur等人[0]的方法假定目标和背景服从两个不同的概率分布 ${ \frac { P _ { 0 } } { P _ { \prime } } } , \ { \frac { P _ { 1 } } { P _ { \prime } } } , \ \cdots , \ { \frac { P _ { \prime } } { P _ { \prime } } }$ 和 ${ \frac { P _ { t + 1 } } { | - P _ { t } } } , { \frac { P _ { t + 2 } } { 1 - P _ { t } } } , \cdots , { \frac { P _ { t + t } } { 1 - P _ { t } } }$ P定义

$$
H _ { \boldsymbol { B } } ( t ) = - \sum _ { i = 0 } ^ { t } \frac { p _ { i } } { p _ { t } } \mathrm { l o g } _ { 2 } \frac { p _ { i } } { p _ { t } } , H _ { \boldsymbol { \mu } } ( t ) = - \sum _ { i = t + 1 } ^ { t - 1 } \frac { p _ { i } } { 1 - p } \mathrm { l o g } _ { 2 } \frac { p _ { i } } { 1 - p _ { t } }
$$

使得熵

$$
H _ { T } ( t ) = H _ { B } ( t ) + H _ { W } ( t )
$$

达到最大，求得最佳阈值。  
此方法又称为KSW熵方法。

7）矩量保持法。矩量保持(moment-preserving)法(]，即矩守恒阈值法，是

1985年提出的，其基本思想是最佳的阈值应该使分割前后图像的矩量保持不变，由此可以得到一组矩量保持方程，求解该方程组就可以得到最佳阈值。

8）模糊集方法。模糊集理论较好的描述了人类视觉中的模糊性和随机性，因此在图像阈值化领域受到了广泛的关注。模糊集阈值化方法的基本思想是，选择一种S状的隶属度函数定义模糊集，隶属度为0.5的灰度级对应了阈值，当然在上述隶属度函数的表达式中阈值是一个未知的参数;然后在此模糊集上定义某种准则函数(例如整个图像的总体模糊度)，通过优化准则函数来确定最佳阈值。

全局阈值的确定方法，除上述主要几种之外还许多，但大多都是以上述基本方法为基础，做出的改进方法或者对算法的优化，如使用递推方法以降低算法复杂性。近年来有一些新的研究手段被引入到阈值选取中，比如人工智能、神经网络、数学形态学、小波分析与变换等等。

# 3.1.3安全线图像阈值化

综合上述的阈值确定方法，考虑到防伪纸安全线图像目标和背景的差别情况，选用交互实验法和直方图法相结合来实现安全线图像的阈值化。

![](images/ff4927efe10c57c385e3d0daf570b8871219dd291d1f9c52aba0391468fd6778.jpg)  
图3.2为图2.7的直方图。  
图3.2安全线图像直方图

根据图3.2所示直方图，再经过反复试验，我们确定阈值为46。图3.3所示为图2.7的安全线图像阈值化的结果，我们可以看到，作为目标的全息面窗口都显示为白(1)，背景显示为黑(0)。

![](images/6dae3303bc9798f835c8a309b72d012497d16979fe3e4fc945872cbba52cc5ef.jpg)  
基于机器视觉的防伪纸安全线检测关键技术研究与应用  
图3.3安全线图像阈值化的结果

# 3.2模板匹配

一在上一章提到，线扫描相机的拍摄位置是在一个大不锈钢滚轮上，由于机械安装的原因，检测横切标记的传感器不能安装在距离相机拍摄太近的位置，而是安装在距离拍摄位置2米多的前方。这样当检测到横切标记时，还要延长一段距离等被检测到横切标记的纸走到拍摄位置时才触发帧的拍摄。大张防伪纸在横切标记前后会有3个无用的安全线全息面窗口，由于工艺的原因，这几个窗口质量很差，多数都有埋浆的问题，甚至整个窗口都被埋掉。因为这几个窗口所在的纸张部分在印刷时会被切掉，所以这几个窗口是不在纸张质量考虑范围内的。因此，延长的距离还包括去掉这一段纸的长度。

由于以下原因使得每一次拍摄的图像并不能总保持到横切标记的距离一定，会有几毫米的差别，有时能到十多毫米：

1）每张纸的窗口到横切标记的距离并不一致，有所谓的“大小纸”的问题，即相隔两张防伪纸的第一个全息安全线窗口到横切标记的距离是不一样的，根据纸的类别不同相差6至7毫米，并且有0.5毫米的公差。  
2）大张防伪纸的长度并不是很一致,有2毫米的公差，在2米多的长度内有4张大纸，4张大纸的误差加起来有时会很大，

为了保证能把有效的窗口都拍摄进来，在设置拍摄帧的长度和开始位置时，不能限制得太紧，但这样一来有时图像中就会出现前面提及的无用的窗口。图3.4为横切标记附近出现的无用窗口的图像。无用窗口的出现给有效窗口的统计带来了麻烦。为了解决这一问题，我们通过图像处理的办法来去掉这几个窗口。

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

![](images/1c74389f46a5ae8c30bae72cbe867aadd50dd0da5611771f3f2e2ed457531267.jpg)  
图3.4无效窗口的图像

我们采用的办法是先确定图像最上方和最下方的有效窗口位置，然后只处理在这个有效范围内的安全线全息面窗口的信息，忽略掉其他范围的全息面窗口信息。这样，就达到了忽略无用窗口的目的。

如图3.5所示，当确定左上角和右下角红框所示范围内的全息面窗口组的位置后，图像最上方和最下方的有效窗口位置也就可以确定下来。通过分析图像，可以发现良好的安全线窗口特征基本一致，所以，可以使用模板匹配的方法来确定图像最上方和最下方的有效窗口位置。

![](images/d8af3ec580c2a40bcc83052b72ac5043149a505ecce9f1f5191b6976e9162f85.jpg)  
图3.5有效窗口位置

所谓模板匹配就是把两个不同的传感器从同一拍摄目标录取下来的两幅图像在空间上进行对准，以确定两幅图像之间的相对平移的过程。图像匹配中事先获得的图像称为模板(mode1)，在匹配过程中在线或者实时获得的图像称为输入图（inputimage)。模板可以比输入图大也可以比输入图小。当模板比输入图大时，匹配过程就是在模板中搜寻输入图位置的过程。当输入图比模板大时，匹配的过程就是在输入图中寻找作为目标的模板的过程[12]。

如果可以期待在待处理的图像中出现的是模板的精确的复制，匹配就会非常容易；然而，在实际的图像中的某部分通常会由于噪声、几何变形、遮挡等因素而损坏。因此，寻找绝对的匹配一般是不可能的，搜索最大匹配的位置更合适。模板匹配标准的定义可以有很多种，比较常用的有最小距离标准和相关性标准[13]

本文采用去均值归一化相关法计算最大匹配的位置。

# 3.2.1去均值归一化相关法

设模板 $G _ { r }$ ，其大小为 $M _ { r } \times N _ { r }$ ，输入图为 $G _ { s }$ ，其大小为 $M _ { s } \times N _ { s }$ ，且 $M _ { s } > M _ { r }$ ，$N _ { s } > N _ { r }$ 。则输入图中以和 $( \mathsf { u } , \mathsf { v } )$ 为左上角、大小为 $M _ { r } \times N _ { r }$ 的子图 $G _ { s } ( u , \nu )$ 与模板 $G _ { r }$ （204号间的去均值归一化互相关度量 $\rho _ { g } ( u , v )$ 为：

$$
\begin{array} { r l } & { \rho _ { g } ( u , v ) = \frac { \underset { i = 1 } { M _ { r } } \underset { j = 1 } { N _ { r } } } { \underset { j = 1 } { M _ { r } } \underset { j = 1 } { \overset { N _ { r } } { \sum } } { [ G _ { s } ( i + u , j + v ) - \overset { \overline { { G _ { s } ( u , v ) } } } { \overline { { G _ { s } ( u , v ) } } } ] ^ { 2 } } } \underset { \cdot = \underset { i \cdot \ i \div \ j = 1 } { \overset { 1 } { \sum } } { [ G _ { r } ( i , j ) - \overline { { G _ { r } } } ] ^ { 2 } } } { \sum } \underset { j = 1 } { \overset { 1 } { \sum } } { [ G _ { r } ( i , j ) - \overline { { G _ { r } } } ] ^ { 2 } } \underset { \cdot = \underset { i \cdot \ i \div \ j = 1 } { \overset { 1 } { \sum } } } { \overset { 1 } { \sum } } { \underset { j = 1 } { \overset { N _ { r } } { \sum } } { [ G _ { r } ( i , j ) - \overline { { G _ { r } } } ] ^ { 2 } } } \underset { \cdot = \underset { i \cdot \ i \div \ j = 1 } { \overset { 1 } { \sum } } } { \overset { 1 } { \sum } } { \underset { j = 1 } { \overset { N _ { r } } { \sum } } { [ G _ { r } ( i , j ) - \overline { { G _ { r } } } ] ^ { 2 } } } \underset { \cdot = \underset { i \cdot \ i \div \ j = 1 } { \overset { 1 } { \sum } } } { \overset { 1 } { \sum } } } \end{array}
$$

式中， $\rho _ { g } ( u , \nu )$ 是度量函数位置偏移为 $( \mathfrak { u } , \mathfrak { v } )$ 时的匹配度量值，并且有$0 \le \vert u \vert \le M _ { s } - M _ { r } , 0 \le \vert \nu \vert \le N _ { s } - N _ { r }$ ，这里 $\overline { { { G } _ { s } ( u , v ) } }$ 与 $\overline { { G _ { r } } }$ 分别为 $G _ { s } ( u , v )$ 与 $G _ { r }$ 的灰度均值。

图像的均值往往不为零，这相当于引入直流分量，使得相关度量值的极值与背景电平的比值下降。其结果显示在误差曲面上使得相关峰变宽。更重要的是，去均值后可使两幅图像获得相同的背景电平，使得相关度量具有了抗亮度干扰的能力，这样输入图像和模板之间的亮度线性偏差就不会对匹配结果产生影响。利用统计理论计算出图像的均值估计，然后从图像中减去这个均值，就可以得到一个零均值的图像。试验表明去均值能够明显优化误差曲面，使得匹配区更加突出，而抑制非匹配区。总之使得误差曲面得到某种程度上的“锐化”，当然这是以增加额外的计算量为代价的，但是可以通过改进算法来减少计算量，提高算法的运行速度。

为方便表示，将均值归一化灰度相关匹配算法的数学表达式作一个简化，其简化后的描述为：

$$
\rho _ { x y } = \frac { \underset { i \in R } { \sum } ( x _ { i } - \overline { { x } } ) ( y _ { i } - \overline { { y } } ) } { \sqrt { \underset { i \in R } { \sum } ( x _ { i } - \overline { { x } } ) ^ { 2 } \underset { i \in R } { \sum } ( y _ { i } - \overline { { y } } ) ^ { 2 } } }
$$

其中， $\tt { X }$ 为输入图， $\overset { \_ } { \boldsymbol { x } }$ 为输入图均值，Y为模板，y为模板均值，R为对匹配计算有贡献的区域， $x _ { i } \in X , y _ { i } \in Y$ 。

上式可进一步化为：

$$
\rho _ { x y } = { \frac { \sum _ { i \in R } ( x _ { i } y _ { i } ) - { \widehat { N x y } } } { \sqrt { \left( \sum _ { i \in R } x _ { i } ^ { 2 } - N { \overline { { x } } } ^ { 2 } \right) \left( \sum _ { i \in R } y _ { i } ^ { 2 } - N { \overline { { y } } } ^ { 2 } \right) } } }
$$

其中：x=∑x,，y=∑y，N为像素总数。模板Y的均值y与平方和∑y²只需要在创建模板时计算一次。实时计算的量为输入图均值 $\mathbf { \Pi } _ { x } ^ { - }$ 与平方和 $\sum _ { i \in R } { x _ { i } } ^ { 2 }$ 。

由于对除法的计算非常消耗时间，通常是执行加法和乘法时间的数倍，应当尽量避免除法运算。式(3.9)中在求 $\overline { { x } } , \overline { { y } }$ 时存在除法计算，而且在一次匹配中该公式要被反复计算，故需对公式重新推导得如下公式：

$$
\begin{array}{c} \rho _ { x y } = { \frac { N \ \sum _ { i \in R } ( x _ { i } y _ { i } ) - \sum _ { i \in R } x _ { i } \sum _ { i \in R } y _ { i } } { \sqrt { { \Biggl ( N \sum _ { i \in R } x _ { i } ^ { 2 } - \left( \sum _ { i \in R } x _ { i } ^ { - } \right) ^ { 2 } \Biggr ) } { \Biggl ( N \sum _ { i \in R } y _ { i } ^ { 2 } - \left( \sum _ { i \in R } y _ { i } ^ { 2 } \right) ^ { 2 } \Biggr ) } } } } \qquad \end{array}
$$

与除法运算一样，开方运算同样消耗大量计算时间，故式(3.10)中的开方运算也会影响计算的速度。所以我们通过计算 ${ \rho _ { x y } } ^ { 2 }$ 来计算最大匹配值S。

$$
S = \mathrm { m a x } ( { \rho _ { x y } } ^ { 2 } , 0 ) { \times } 1 0 0 \%
$$

# 3.2.2分层搜索

为了减少计算量，我们使用分层搜索的办法。分层搜索算法的原理，简单的说，就是将输入图和模板分别生成一系列的低分辨率图像，从分辨率最低的图像开始搜索。这种低采样率的系列图像通常称为图像金字塔[5（如图3.6所示）。

![](images/99c076910e10a6b6ef219a7051feb44d07e740b1f60589f821bfe83cb2730ae8.jpg)  
基于机器视觉的防伪纸安全线检测关键技术研究与应用

通过在采样前使用低通滤波器，图像金字塔的每一层都是前一层的一半大小。例如，当一幅图像的分辨率在0层是 $5 1 2 \times 5 1 2$ 时，在1层就是 $2 5 6 \times 2 5 6$ ，在2层就是 $1 2 8 \times 1 2 8$ ，以此类推。层越高，输入图和模板的分辨率就越低。

搜索从低分辨率开始，很快就能找到可能的匹配位置。然后在更高的分辨率图像中搜索，以便确定这个可能的匹配是否就是所要寻找的匹配并得到更加精确的位置。由于在前一层的搜索中已经确定了匹配的大概位置，因此只需要对很小一个范围使用式(3.11)计算相关度即可。

# $\mathbf { 3 . 2 . 3 \check { \ } }$ 利用模板匹配定位有效全息面窗口

为了利用模版匹配来定位有效的全息面窗口，首先要定义模版。如图3.7所示，选取一组图像质量比较好的安全线作为模版。

![](images/2395cf6d185e70f8022b254ba35c23870e74fcdc6f31e8168dc41e88c842b2e5.jpg)  
图3.6分层搜索  
图3.7模版图像

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

由于整个有效窗口的跳动在一个不是太大的范围内，在实际进行模版匹配的时候，并不需要将整幅图像作为输入图，而是在一个特定的范围内搜索，这样可以大大减少计算量。图3.8为整张安全线图像，其中绿框搜索区域，也就是将这两个绿框内的图像作为输入图。图3.9为模版匹配的结果图像，左图为图3.8中左上角搜索范围内的模板匹配结果，匹配值为 $7 8 . 1 \%$ ，右图为图3.8中右下角搜索范围内的模版匹配结果，匹配值为 $9 0 . 0 \%$ 。通过模版匹配结果给出匹配中心的位置，就可以计算出整个有效窗口图像的范围。

![](images/af43a993da90ab9c5c09e1ee12345ef0722732c61a90b7b7ac2e029af6cf0e1d.jpg)  
图3.8进行模版匹配的搜索范围

![](images/165fc02f9d2700a505c4df0781e25cc948baed5b3348c73bef76ce76a0c32f04.jpg)  
图3.9模版匹配定位的结果

# 3.3Blob分析

在上一节，通过模板匹配的方法，我们准确地划分出了有效区域。现在，为了判断安全线全息面窗口是否存在反线和埋浆现象，我们使用 Blob算法来做分析。

# 3.3.1Blob分析概念

Blob分析是机器视觉应用中非常常用的分析手段。用于机器视觉的最简单的图像一般具有二维形状或斑块(blob)。Blob分析是对图像中的二维形状进行检测和分析。Blob分析可以为机器视觉应用提供图像中的斑点的数量、位置、形状、方向和blob间的拓扑结构等信息[]。

Blob 分析首先将对象从背景中分离，得到二值化的图像，将连通区域里的像素分组组成对应的Blob（斑块），然后根据Blob的几何学属性如面积、大小、方向等，对感兴趣的对象进行定位、识别和检测。Blob 算法的核心思想是：在一块区域内把出现“灰度突变”的范围（blob）的准确位置找出来,并确定其大小、形状及面积等[4]。

对于安全线全息面窗口，我们需要知道窗口的位置和尺寸，也就是在使用Blob分析的时候，需要计算每个blob的中心位置以及长度和宽度。

在Blob分析中，所谓的中心指的是一个blob的质心。安全线全息面窗口近似于矩形，在对中心位置的精度要求不是太高的情况下，blob的质心就可以当作窗口的中心。

要得到blob的长度和宽度首先要计算blob的面积和周长。如图3.10所示的blob，其面积等于组成该blob的像素个数；周长等于blob外沿的像素个数，对于图3.10所示的blob，由于存在“楼梯”效应，在台阶处的长度计为1.414。所以，图3.10所示blob，面积为10，周长为14.242。

![](images/fda4f10d7081cebd22df5372f3103d47767aa9b993f4d68d07e176ff4b04d464.jpg)  
图3.10Blob 的面积和周长

长条矩形的blob的面积和周长与长度和宽度的关系如下：

$$
\left\{ \begin{array} { l l } { \mathbf { S } = \mathbf { L } \times \mathbf { W } } \\ { \mathbf { P } = 2 ( \mathbf { L } + \mathbf { W } ) } \end{array} \right.
$$

其中，S、P、L、W分别代表blob 的面积、周长、长度和宽度。从(3.12)可以看出，由于是由面积和周长计算得出的，blob的长度和宽度的精度并不高。由于判断安全线是否反线对全息面窗口的尺寸测量的精度要求不高，所有通过Blob 分析得出的尺寸精度能够满足判断反线的要求。

# 3.3.2Blob处理结果分析

对在3.2节得到的有效窗口图像进行Blob分析，计算出每个窗口的中心位置，长度和宽度。然后通过以下步骤判断安全线全息面窗口是否合格：

1）按下式进行过滤，满足条件的blob进入下一步分析，不满足条件的blob 被过滤排除掉。

$$
\left\{ \begin{array} { l l } { \mathrm { L } _ { \mathrm { m i n } } \leq \mathrm { L } _ { \mathrm { b } } \leq \mathrm { L } _ { \mathrm { m a x } } } \\ { \mathrm { W } _ { \mathrm { m i n } } \leq \mathrm { W } _ { \mathrm { b } } \leq \mathrm { W } _ { \mathrm { m a x } } } \end{array} \right.
$$

其中 $\mathrm { L } _ { \mathrm { b } }$ 和 $\mathbf { W _ { b } }$ 为需要判断的 blob 的长度和宽度值， $\mathrm { L } _ { \operatorname* { m i n } } \setminus \mathrm { L } _ { \operatorname* { m a x } } \setminus \mathrm { W } _ { \operatorname* { m i n } } \setminus \mathrm { W } _ { \operatorname* { m a x } }$ 为长度和宽度的极值。因为反线判断只是判断有无，并不需要精确的计算，所以极值不必设的太紧，设定尺寸的最小值为全息面窗口要求尺寸的一半，最大值为全息面窗口要求尺寸的1.5倍就可以了。图3.11为Blob分析前后的对比图，其中A、C为分析前原始图像，B、D为进行Blob 过滤后的图像，可以看出，对于A图中合格的窗口，经过过滤后仍然存在可以，而C图中被纸浆覆盖了的窗口，过滤后就被排除掉了。

![](images/f754d56d6b69ad324fff4aee14a7f72912989c874ee6221f7d87d22491d9a140.jpg)  
图3.11Blob分析前后的对比图

2）统计满足式(3.13)的blob的个数N，当N等于合格产品的全息面窗口数目时，判断不存在反线现象，可用进行进一步的分析，否则，判断该幅纸不合格。

# 3.4尺寸测量

要判断安全线是否被拉伸，就应测量出安全线宽度方向的尺寸。在上一节中使用Blob 分析已经得到了安全线全息面窗口的长度方向和宽度方向的尺寸，但是从算法上可以看出，Blob 分析计算出的尺寸值只是一个大概值，为了得到精确的尺寸值，必须使用其它的方法。

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

在图像处理中，测量物体尺寸的最常用的办法是边缘检测，将待测量物体的边缘提取出来，然后就可以测量所需要的尺寸。

# 3.4.1边缘检测的概念

图像的大部分信息都存在于图像的边缘中，主要表现为图像局部特征的不连续性，即图像中灰度变化比较剧烈的地方。因此，我们把边缘定义为图像中灰度发生急剧变化的区域边界。边缘检测的定义有很多种，其中最常用的一种定义为[15]：边缘检测是根据引起图像灰度变化的物理过程来描述图像中灰度变化的过程。引起图像灰度不连续性的物理过程可能是几何方面的，也可能是光学方面的。几何方面的，比如深度的不连续性、表面取向、颜色和纹理的不同；而光学方面的，比如表面反射、非目标物体产生的阴影以及内部倒影等。这些景物特性混在一起会使随后的解释变得非常困难[16]。

边缘检测主要包括以下四个步骤：

(1）图像滤波。边缘检测算法主要是基于图像亮度的一阶和二阶导数,但是导数的计算对噪声很敏感，因此必须使用滤波器来改善与噪声有关的边缘检测器的性能。(2）图形增强。增强边缘的基础是确定图像各点邻域强度的变化值。增强算法可以将邻域强度值有显著变化的点突出显示。(3）图像检测。在图像中有许多点的梯度幅值比较大，而这些点在特定的应用领域中并不都是边缘，应该用某些方法来确定那些是边缘点。最简单的边缘检测判据是梯度幅值阈值判据。(4）图像定位。如果某一应用场合要求确定边缘位置，则边缘的位置可以在亚像素分辨率上来估计，边缘的方位也可以被估计出来。

对于图像的边缘检测来说，一般在识别过程中有如下的要求：

（1）首先能够正确的检测出有效的边缘;  
(2) 边缘定位的精度要高；  
(3) 检测的响应最好是单像素的；  
(4） 对于不同尺度的边缘都能有较好的响应并尽量减少漏检；  
(5) 对噪声应该不敏感；  
(6）检测的灵敏度受边缘方向影响应该小。

这些要求往往都很矛盾,很难在一个边缘检测器中得到完全的统一。判断边缘检测器性能的方法是先看边缘图像，再评价其性能,边缘检测器的响应中主要有三种误差：丢失的有效边缘、边缘定位误差和将噪声误判断为边缘[16]。

# 3.4.2边缘点的定义

设 $f ( x )$ 为待处理图像信号。 $f ^ { ' } ( a )$ 和 $\boldsymbol { f } ^ { * } ( \boldsymbol { a } )$ 分别是信号 $f ( x )$ 在 $\mathtt { x } { = } \mathtt { a }$ 处的一阶导数

和二阶导数。当 $f ^ { ' } ( a ) = 0$ 时，信号 $f ( x )$ 在 $\scriptstyle \mathbf { x } = \mathbf { a }$ 处存在极值点；当 $\boldsymbol { f } ^ { * } ( \boldsymbol { a } )$ 在 $\scriptstyle \mathbf { x } = \mathbf { a }$ 处改变符号时，则 $\tt { \tt { x } = \tt { a } }$ 为信号 $f ( x )$ 的拐点。对于一维信号：

(1）当 $f ^ { ^ { \prime } } \left( a \right) = 0 , f ^ { ^ { \prime } } \left( a \right) > 0$ ，边缘点定义为局部极小值点。  
(2）当 $f ^ { ^ { \prime } } ( a ) = 0 , f ^ { ^ { \prime } } ( a ) < 0$ ，边缘点定义为局部极大值点。  
(3）当 $f ^ { ^ { \prime } } \left( a ^ { - } \right) \times f ^ { ^ { \prime } } \left( a ^ { + } \right) < 0$ ，边缘点定义为拐点[7]。

# 3.4.3边缘模型分类及其特征

图像中的边缘类型通常分为：阶跃型边缘[18]、斜坡型边缘[18]、三角型屋脊边缘[19]等几种类型。下面分别对这几种边缘模型进行分析。

# 1．阶跃型边缘

阶跃型边缘模型为：

$$
f ( x ) = c \cdot I ( x )
$$

其中 $c > 0$ 为边缘幅度， $\begin{array}{c} \scriptstyle { \left. I \left( x \right) = { \left\{ \begin{array} { l l } { 1 } & { x \geq 0 } \\ { 0 } & { x < 0 } \end{array} \right. } \right.} \end{array}  $ 为阶跃函数。

取 $\mathsf { c } { = } 1$ 的边缘模型如图3.12所示，经高斯函数 $g ( x )$ 平滑后的边缘模型 ${ \pmb E } ( { \pmb x } )$ 如图3.13所示。可以看到不同尺度的高斯函数产生了不同程度的平滑效果，尺度越大，平滑作用越好。图3.14和图3.15分别是高斯平滑后的边缘的一阶导数和二阶导数，一阶导数的极值点和二阶导数的过零点都对应着实际边缘的位置。

![](images/5c57fd4faf7e5d6e2be9acbfc0ab1f76938473b8059b98237bebf5ef31e814c9.jpg)  
图3.12阶跃边缘

![](images/e65587dae1351aa5ed807b37c02375d1d517f23c09baf4b3164a6160cc80f5cb.jpg)  
图3.13高斯函数平滑后的阶跃边缘

![](images/63f9592e562c3af6c2d530ceb0b31ca9d4ad6b7ee0e5210d75c36270270f0be6.jpg)  
图3.14阶跃边缘的一阶导数

![](images/c6e941a9f8e665fb19604874cf702dee2fa943e3ff62d51f8c059de36dcdb75c.jpg)  
图3.15阶跃边缘的二阶导数

# 2．斜坡型边缘

理想斜坡型边缘模型为：

$$
f ( x ) = - \frac { 2 } { S } + ( \frac { S } { d } x + \frac { S } { 2 } ) \cdot I ( x + \frac { d } { 2 } ) + ( - \frac { S } { d } x + \frac { S } { 2 } ) \cdot I ( x - \frac { d } { 2 } )
$$

其中S为边缘幅度， $\textsf { d }$ 为边缘宽度。取 $s { = } 2$ ， ${ \mathsf { d } } { \mathsf { = } } { \mathsf { 1 } }$ 的边缘模型如图3.16，经高斯平滑后得到的边缘模型 $E ( x )$ 如图3.17。图3.18是高斯平滑后的不同宽度边缘的一阶导数，图3.19是高斯平滑后的不同宽度边缘的二阶导数。一阶导数的极值点和二阶导数的过零点都对应着实际边缘的位置。如图3.18(b)所示：当$\sigma = 0 . 2 5$ ， $\scriptstyle \mathbf { d } = 2$ 时，平滑边缘的一阶导数极值点有一定的宽度，此时图3.19(b)显示其二阶导数的过零点也有一定的宽度。因此在这种情况下，不能检测到边缘的位置 $\bullet ^ { \sim }$ 而当 $\pmb { \sigma } = 0 . 2 5 , . \mathrm { d } = 1 .$ 时，则可准确定位 $\lneq$ 阶导数的极值点和二阶导数的过零点，如图3.18(a)和图3.19(a)。

![](images/be0fb33448e430e4e8d4db189c55d798a63ce6ace9a2456bff4bddd4f8b082a2.jpg)  
图3.16斜坡边缘模型

![](images/fc1f44703e49b25714394a43c0447a884f1d77df8a6d876b9bd6fa95cda6130e.jpg)  
图3.18斜坡边缘的一阶导数

![](images/7f3844ff99b5e529758f71d3a80e5f2f0e6e207532c6a4329f066c00d80a66da.jpg)  
图3.17高斯函数平滑后的斜坡边缘

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

![](images/93cb3e69281ec4c58e534bfdd43ba01c2122bc9d940b0b84ed2faf207da7d65b.jpg)  
图3.19斜坡边缘的二阶导数

# 3．三角型屋脊边缘

三角型屋脊边缘模型为

$$
f ( x ) = ( { \frac { 2 S } { d } } x + S ) \cdot I ( x + { \frac { d } { 2 } } ) - { \frac { 4 S } { d } } x \cdot I ( x ) - ( - { \frac { 2 S } { d } } x + S ) \cdot I ( x - { \frac { d } { 2 } } )
$$

其中S为边缘幅度， $\textsf { d }$ 为边缘宽度。取 $s { = } 1$ ， $d { = } 2$ 的边缘模型如图3.20，经高斯平滑后得到的边缘模型 $E ( x )$ 如图3.21，图3.22和图3.23分别是经高斯平滑后边缘的一阶导数和二阶导数。一阶导数的过零点和二阶导数的极小值点都对应着实际边缘的位置。

![](images/8a45ee870f7eaa2c88e4a2ab775d575793c212b6a2f5d4993a6f0b380a7ce1d7.jpg)  
图3.20三角型屋脊边缘

![](images/e0d45dca380832fd6fbccb7c63b1f2208d02d662450cb2d573851c5c6678f6f2.jpg)  
图3.21高斯平滑后的三角型屋脊边缘

![](images/ad3d4da34808eeb5924306d68d48dd73b33434378b5c04763d8d731608abb1bc.jpg)  
图3.22三角型屋脊边缘的一阶导数

![](images/dcc40bed94c5e217a0da165348ad71afdf45111a391a5bae89a653eabdd01b71.jpg)  
图3.23三角型屋脊边缘的二阶导数

# 3.4.4边缘检测算子

边缘检测的实质是采用某种算法来提取出图像中的对象与背景间的交界线。图像灰度的变化情况可以用图像灰度分布的梯度来反映，因此我们可以利用局部图像微分技术获得边缘检测算子。

梯度对应一阶导数，梯度算子就是一阶导数算子。在边缘灰度值过渡比较尖锐，且在图像噪声比较小时,梯度算子工作的效果较好,而且对施加的运算方向不予考虑。对于一个连续图像函数 $f ( x , y )$ ，梯度可表示为一个矢量

$$
\nabla f ( x , y ) = \left[ \frac { \partial f } { \partial x } . \frac { \partial f } { \partial y } \right] ^ { T }
$$

这个矢量的幅度和方向角分别为

$$
\left| \nabla f \right| = m a g ( \nabla f ) = \left[ \left( { \frac { \partial f } { \partial x } } \right) ^ { 2 } + \left( { \frac { \partial f } { \partial y } } \right) ^ { 2 } \right] ^ { 1 / 2 }
$$

$$
\phi ( x , y ) = \arctan \left( \frac { \frac { \partial f } { \partial x } } { \frac { \partial f } { \partial y } } \right)
$$

以上各式的偏导数需对每个像素的位置计算，在实际中常用小区域模板进行卷积来近似计算。对 $G _ { x }$ 和 $\mathcal { G } _ { y }$ 各用一个模板，将两个结合起来就构成一个梯度算子。根据模板的大小和元素值的不同，已提出许多不同的算子,常见的有Roberts算子、Sobe1算子、Prewitt算子、Laplacian算子等。

Roberts算子[5]。Roberts算子是根据任意一对互相垂直方向上的差分可用来计算梯度的原理,采用对角线方向相邻像素之差

$$
\begin{array} { c } { \Delta _ { x } f = f ( i , j ) - f ( i + 1 , j + 1 ) } \\ { \ } \\ { \Delta _ { y } f = f ( i , j + 1 ) - f ( i + 1 , j ) } \\ { \ } \\ { R ( i , j ) = \sqrt { \Delta _ { x } ^ { 2 } f + \Delta _ { y } ^ { 2 } f } } \end{array}
$$

对图像 $f ( x , y )$ 求Roberts 梯度为

$$
G _ { R } f ( x , y ) = \operatorname* { m a x } { \big \{ } f ( x , y ) - f ( u , \nu ) { \big \} }
$$

式中 $( u , v )$ 为点 $( x , y )$ 的四邻域。或用差分近似为

$$
G _ { \scriptscriptstyle R } f ( x , y ) = \operatorname* { m a x } \left\{ \left[ \sqrt { f ( x , y ) } - \sqrt { f ( x + 1 , y + 1 ) } \right] ^ { 2 } + \left[ \sqrt { f ( x + 1 , y ) } - \sqrt { f ( x , y + 1 ) } \right] ^ { 2 } \right\} ^ { 1 / 2 }
$$

它的两个 $2 \times 2$ 卷积模板见图3.24,有了这两个卷积算子就可以计算出Roberts梯度

幅值 $\boldsymbol { R } ( i , j )$ ，再取适当门限TH，如果 $R ( i , j ) \geq \mathrm { T H }$ 则为阶跃边缘点。Roberts算子采用对角线方向相邻像素之差近似检测边缘，定位精度高，在水平和垂直方向效果较好，但对噪声敏感。

![](images/c9abfbb6537864c0ebc70d60d81f0411d7513e7cbe3b1d377b2cb3986156ddec.jpg)  
图3.24 Roberts算子  
图3.25 Sobel算子

Sobel算子[5]。Sobel算子将图像中的每个像素的上、下、左、右四邻域的灰度值加权差，与之接近的邻域的权最大。Sobel算子定义如下：

$$
\begin{array} { c } { { + 1 , y - 1 ) + 2 f ( x + 1 , y ) + f ( x + 1 , y + 1 ) \big \} - \left\{ f ( x - 1 , y - 1 ) + 2 f ( x - 1 , y ) + f ( x - 1 , y + 1 ) \right\} } } \\ { { - 1 , y + 1 ) + 2 f ( x , y + 1 ) + f ( x + 1 , y + 1 ) \big \} - \left\{ f ( x - 1 , y - 1 ) + 2 f ( x , y ) + f ( x + 1 , y - 1 ) \right\} } } \end{array}
$$

那么，利用图3.25所示的两个核做卷积，一个核对通常的垂直边缘影响最大，而另一个核对水平边缘影响最大，两个卷积的最大值都作为像素点的输出值，运算结果就是一幅边缘图像。适当取门限TH,如果 $R ( i , j ) \geq \mathrm { T H }$ 则为阶跃边缘点。Sobel 算子利用像素的上、下、左、右邻域的灰度加权算法，根据在边缘点处达到极值这一原理进行边缘检测。该方法不但产生较好的检测效果，而且对噪声具有平滑作用，可以提供较为精确的边缘方向信息。但是,在抗噪声好的同时增加了计算量，而且也会检测伪边缘，定位精度不高。如果检测中对精度的要求不高，该方法较为常用。

-1 -2 -1 -1 0 1   
0 0 0 -2 0 2   
1 2 1 -1 0 1

Prewitt算子[5。Prewitt算子是一种边缘样板算子。样板算子由理想的边缘子图像构成，依次用边缘样板去检测图像，与被检测区域最为相似的样板给出最大值，用这个最大值作为算子的输出。

$p _ { x } = \left\{ f ( x + 1 , y - 1 ) + f ( x + 1 , y ) + f ( x + 1 , y + 1 ) \right\} - \left\{ f ( x - 1 , y - 1 ) + f ( x - 1 , y ) + f ( x - 1 , y + 1 ) \right\} - f ( x - 1 , y - 1 )$ $p _ { y } = \left\{ f ( x - 1 , y + 1 ) + f ( x , y + 1 ) + f ( x + 1 , y + 1 ) \right\} - \left\{ f ( x - 1 , y - 1 ) + f ( x , y - 1 ) + f ( x + 1 , y - 1 ) \right\} - { \left\{ f ( x + 1 , y - 1 ) + f ( x , y - 1 ) + f ( x + 1 , y - 1 ) \right\} } .$

由图3.26所示的两个卷积算子形成了Prewitt算子，与使用Sobel算子的方法一样，

图像中每个像素都用这两个核做卷积，取最大值作为输出，运算结果就是一幅边缘图像。  
适当取门限TH，如果 $R ( i , j ) \geq \mathrm { T H }$ 则为阶跃边缘点。

1 0 -1 -1 -1 -1   
一 0 -1 0 0 0   
1 0 -1 1 1 1

Laplacian算子[5]。Laplacian算子是二阶微分算子,它具有旋转不变性,即各向同性的性质。表达公式为

$$
\nabla ^ { ^ 2 f } ( x , y ) = \frac { \partial ^ { 2 } f ( x , y ) } { \partial x ^ { ^ 2 } } + \frac { \partial ^ { 2 } f ( x , y ) } { \partial y ^ { ^ 2 } }
$$

在数字图像中可用数字差分近似为

$$
\nabla ^ { ^ { 2 } } f ( x , y ) = f ( x + 1 , y ) + f ( x , y + 1 ) + f ( x , y - 1 ) - 4 f ( x , y )
$$

数字图像函数的拉普拉斯算法也是借助各种模板卷积实现的。这里对模板的基本要求是对应中心像素的系数应是正的，而对应中心像素临近像素的系数应是负的，且所有系数的和应该是零,这样不会产生灰度偏移,实现拉普拉斯运算的4连通和8连通模板见图3.27。Laplacian算子的缺点是：由于为二阶差分，双倍加强了噪声的影响：另外它产生双像素宽的边缘，且不能提供边缘方向的信息，因此，拉普拉斯算子很少直接用于边缘检测,而主要用于已知边缘像素,确定该像素是在图像的暗区还是在明区。其优点是各向同性,不但可以检测出绝大部分边缘，同时基本没有出现伪边缘，可以精确定位边缘。

0 -1 0 -1 -1 -1   
-14-1 -1 8 -1   
0 -1 0 -1 -1 -1

Canny算子[5]。Canny把边缘检测问题转换为检测单位函数极大值的问题[20]。他在1986年仔细论述了Canny算子，他给出了判断边缘检测方法性能指标：信噪比准则$S N R = \frac { \displaystyle { \left| \int _ { - w } ^ { + w } G ( - x ) h ( x ) d x \right| } } { \sigma \sqrt { \displaystyle { \int _ { - w } ^ { + w } h ^ { 2 } ( x ) d x } } }$ 位精度准则 $L = \frac { \displaystyle { \Biggl | } { \int _ { - w } ^ { + w } } G ( - x ) { h ^ { ' } ( x ) d x } { \Biggr | } } { \displaystyle { \sigma \sqrt { \int _ { - w } ^ { + w } } h ^ { ' 2 } ( x ) d x } }$ (L越大精度越高)，单边缘响应

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

$D _ { z c a } ( f ^ { ' } ) = \pi \left\{ \frac { \displaystyle { \int _ { 0 } ^ { + \infty } } h ^ { 2 } ( x ) d x } { \displaystyle { \int _ { - w } ^ { - \infty } } h ^ { ' } ( x ) d x } \right\} ^ { 1 }$ /2准则 。由上面的准则为基础，利用泛函求导的方法导出一个由边缘定位精度和信噪比乘积组成的表达式，这个表达式近似于高斯函数的一阶导数。设n为任意方向，Gn为高斯函数在这个方向上的一阶导数，即 $G _ { n } = \frac { \partial G } { \partial n } = n \nabla G$ ， $\mathfrak { n }$ 应取与边缘垂直的方向，则 $n = \frac { \nabla ( G \cdot I ) } { \left| \nabla ( G \cdot I ) \right| }$ 。符号I为输入图像，边缘点定义为Gn作用于图像I后的局部极大值点，在这个点上有 $( \frac { \partial } { \partial n } ) G _ { n } \cdot I = 0$ ，把上式代入该式，得到 $( \frac { \partial ^ { 2 } } { \partial ^ { 2 } n } ) G _ { n } \cdot I = 0$ 。Canny算子是一类具有良好性能的边缘检测的一阶算子，用高斯函数作平滑运算，再计算上式找到过零点，即边缘点。

Shen-Castan算子[2]。同Canny算子类似，Shen-Castan算子也是先进行平滑再求导，不同的是它选用对称的指数函数滤波器进行平滑。对称的指数函数滤波器为（204号 $F ( x , y ) = C _ { 1 } ^ { 2 } \times C _ { 2 } ^ { \left| x \right| + \left| y \right| }$ ，在数字图像中可以将其分解为按行和列进行两次正反向的递归来实现。先按行进行 $( 1 \leq i \leq n )$

$$
\begin{array} { r l } { f _ { 1 } ( i , j ) = f _ { 1 } ( i , j - 1 ) + a _ { 0 } \cdot \left[ f ( i , j ) - f _ { 1 } ( i , j - 1 ) \right] } & { { } { \mathrm { ~ j = 1 , 2 , 3 \cdots , n ~ } } } \\ { f _ { 2 } ( i , j ) = f _ { 1 } ( i , j + 1 ) + a _ { 0 } \cdot \left[ f ( i , j ) - f _ { 2 } ( i , j + 1 ) \right] } & { { } { \mathrm { ~ j = 1 , 2 , 3 \cdots , n ~ } } } \end{array}
$$

$f _ { 2 } ( i , j )$ 即为按行进行正、反向两次递归滤波后的输出，在此基础上按列进行滤波：

$$
\begin{array} { r l } { f _ { 3 } ( i , j ) = f _ { 3 } ( i - 1 , j ) + a _ { 0 } \cdot \left[ f _ { 2 } ( i , j ) - f _ { 3 } ( i - 1 , j ) \right] } & { { } \mathrm { ~ j = 1 , 2 , 3 \cdots , n ~ } } \\ { f _ { 4 } ( i , j ) = f _ { 4 } ( i + 1 , j ) + a _ { 0 } \cdot \left[ f _ { 3 } ( i , j ) - f _ { 4 } ( i + 1 , j ) \right] } & { { } \mathrm { ~ j = 1 , 2 , 3 \cdots , n ~ } } \end{array}
$$

由(3.29)、(3.30)、(3.31)、(3.32)得到 $f _ { 4 } ( i , j ) = f ( i , j ) \cdot C _ { 1 } ^ { 2 } \cdot C ^ { | i | + | j | }$ 。进行滤波计算后，再进行求导。

# 3.4.5安全线全息面窗口尺寸的测量

图3.28为应用不同检测算子进行边缘检测得到的效果图。图3.28(a)为原图，图3.28(b)-图3.28(f)依次分别为使用Sobel算子，Prewitt算子，Laplacian算子，Canny算子和Shen-Castan算子进行处理后的效果图。

![](images/d691a0fda03d99d3dc88bf75e3878a7b282e5a6b001ac7648bd34bab925845e5.jpg)  
基于机器视觉的防伪纸安全线检测关键技术研究与应用  
图3.28应用不同边缘检测算子的处理结果

Sobel算子和Prewitt算子，其边缘检测速度快，但得到的往往是断续的、不完整的结构信息，这类检测方法对噪声较为敏感。为了有效抑制噪声，一般都会先对原图像进行平滑来去除图像中的噪声，再进行边缘检测才能成功地检测到真正的边缘。Laplacian算子对噪声非常敏感。Canny算子与Shen-Castan算子提取的边缘线型连接程度较好，边缘提取的较完整，边缘线很细。Canny算子与Shen-Castan算子都具有较好的边缘定位精度和边缘封闭性。

为了获取良好的边缘定位精度，选择使用Canny算子与Shen-Castan算子中的一种来对安全线图像进行处理。由于是要进行在线检测，在选择算法的时候处理时间是很重要的考虑因素。在对图3.28(a)分别使用Canny算子和Shen-Castan算子重复计算100遍，Canny算子耗时典型值为28.7毫秒，Shen-Castan算子耗时典型值为19.4毫秒。因此，考虑到运行时间的因素，选择使用Shen-Castan算子来进行边缘的检测。

在获取定位良好的边缘之后，再根据在前面Blob分析中得到的安全线窗口的位置，对窗口边缘的X方向进行测量，就可以得出安全线的宽度值。

# 3.5小结

本章讨论了使用图像阈值化、模版匹配、Blob分析和边缘检测等图像处理技术对防伪纸全息开窗安全线进行处理，根据处理的结果对安全线的纸病进行检测和判断，达到实时检测的目的。

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

# 第四章防伪纸安全线机器视觉在线检测实验系统

# 4.1实验系统结构

在第二章与第三章中所讨论的机器视觉系统的硬件结构和图像处理算法的基础上，我们在某防伪纸厂的一条防伪纸生产线上搭建了一个实验系统。

实验系统的硬件包括工控机、PLC、图像采集卡、线扫描相机、镜头、滤光镜、检测横切标记的传感器、编码器、条形LED光源、激光打标机、机械安装支架（见图4.1)。其中工控机为一台研华610型工控机，CPU为主频为2.4GHz的Intel奔腾4处理器。相机为ATMEL公司的AVIIVAM4CL8007型线扫描相机，横向有8192个像素，即分辨率是8k，为了配合线扫描相机的使用，采用Matrox公司的SoliosXCL型图像采集卡。其中激光打标机用于在检测出的不合格的防伪纸上做标记。实验系统的软件开发环境包括运行在工控机上的Windows2000操作系统，VC6.0软件开发平台和Matrox公司的MIL8.0图像开发包。

![](images/8f47cf74baa102b6a847f18afe1ceabc56dd42b242740d64d66026b0cbc633c6.jpg)  
图4.1防伪纸安全线机器视觉在线检测实验系统结构图

图4.2为防伪纸安全线机器视觉在线检测实验系统的安装示意图。

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

![](images/0da4f3604fb0650668f8fa79206d74337bb4a1b99a2133e92f3f83a2bdcd781c.jpg)  
图4.2防伪纸安全线机器视觉在线检测实验系统安装示意图

# 4.2实验结果

在将防伪纸安全线机器视觉在线自动检测实验系统调试完毕后，我们在用户的配合下进行了一次验证性实验以验证系统的性能。

本次实验在1m/s的走纸速度下一共检测了23037张防伪纸，其中检测出不合格防伪纸283张，合格防伪纸22754张。经过人工检测，实验系统判断为合格的纸中没有不合格纸，判断为不合格的纸中有7张为合格的防伪纸。即漏检率为 $0 \%$ ，误检率约为 $0 . 0 3 \%$ ，符合用户的要求。

实验结果表明，我们研制的实验系统能够满足用户对于防伪纸全息开窗安全线在线自动检测的要求，基于本文所讨论的硬件结构和图像处理算法的机器视觉系统用于防伪纸全息开窗安全线的实时在线高速检测是可行的。

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

# 第五章总结与展望

本文针对我国防伪纸张安全线的检测绝大部分依靠人力完成，检测速度慢，易漏检的问题，提出了一种基于机器视觉技术的低成本/高性能的实时自动检测方法，对自动检测系统的构成、高清晰度图像的获取以及图像的实时处理算法等进行了比较深入的研究，并在以上研究的基础上研制了一个实验系统。通过实验验证，该系统能够满足用户对于防伪纸安全线在线自动检测的要求。

实验结果证明：使用基于线扫描相机的机器视觉系统确实能够实现防伪纸全息开窗安全线的实时在线高速检测，满足大批量、高速度、连续生产的需求。使用机器视觉技术作为检测手段，能够大大减少人工检测的投入，有效提高检测的效率，保证产品质量的可靠性，并大大降低废品率。

本文所论述的内容已经通过实验证明了可行性，在对以下方面进一步改进和研究后，基于机器视觉的防伪纸全息安全线在线自动检测系统就能够投入商业运行：

1．图像的跳动问题。2．改进相机的安装和标定，能够获得更好的图像与测量精度。-3．对算法进一步改进，使之更适合本文所讨论的应用，减少运行时间。

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

#

芗兮乂默   
[1] 凌云光视数字图像技术有限公司.图像和机器视觉产品手册.2006，北京.   
[2]刘小力.机器人视觉伺服系统的图像处理和标定。   
[3] Matrox Electronic Systems Ltd. Matrox Solios XCL Camera Interface Application Note。2005，4.   
[4]PPT VISION Ltd. Machine Vision "The Basic Facts".   
[5]Milan Sonka，Vaclav Hlavac，Roger Boyle．艾海舟 武勃译.图像处理分析与机 器视觉（第二版）．Thomson，1999.   
[6] Doyle W. Operations useful for similarity一invariant pattern recognition .,ACM,1962;9 (2):259-267   
[7] Otsu N. Discriminant and least square threshold selection .Proc 4th IJCPR，1978:592-596   
[8] Kittler J, Illingworth J. On threshold selection using clustering criteria.IEEE Trans.1985;SMC 15:652 655   
[9]Pun T.A new method for gray--level picture thresholding using the entropy of histogram.Signal Processing， 1980;2:223-237   
[10] Kapur J N, Sahoo P K, Wong A K C. A new method for gray-level picture thresholding using the entropy of the histogram .Computer Vision, Graphics and Image Processing,1985;29:273 285   
[11] W. Tsai. Moment-preserving thresholding :A new approach. Computer Vision, Graphics and Image Processing,1985;29:377-39   
[12]饶俊飞.基于灰度的图像匹配方法研究.[硕士学位论文].武汉理工大学,2005.5   
[13]Rafael C.Gonzalez，Richard E.Woods.阮秋琦，阮宇智译.数字图像处理(第二版). 北京：电子工业出版社,2006.   
[14]耿瑞芳．基于Blob 算法的机械手视觉系统.自动化博览.2006，10   
[15]V. Torre，T A. Poggio. On edge detection. IEEE Trans on PAMI，1986, 8(2) :142-163   
[16]段瑞玲，李庆祥，李玉和．图像边缘检测方法研究综述.光学技术.2005， 31(3) :415-419

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

[17]郑南宁．计算机视觉与模式识别．北京：国防工业出版社.1998

[18] A.Peng， B.Dubuisson， M.Benjelloun. A study on the forms of smoothingfilters for step and ramp edge detection. Proceedings 11th IAPRInternational Conference,1992:741-74  
[19］梁德群．工业图像中屋脊边缘多尺度检测方法．红外与毫米波学报．1998,17(6) :411-416  
[20] Canny J.A computational approach to edge detection. IEEE-PAMI,1986,8:679-698  
[21］安连生主编.应用光学（第三版）.北京：北京理工大学出版社，2002.  
[22]王庆友.CCD应用技术.天津：天津大学出版社，2002.  
[23］韩慧，于守谦，刘亚斌等．基于PCⅠ总线图像采集卡开发的图像处理系统［J].计算机测量与控制．2003，11 (6):455-457.  
[24］汤友福，朱挺.线阵列CCD 摄像技术在铁路检测领域的应用［J].铁路计算机应用.2004，13(5):23-25.  
[25]韩丙辰,陈树越．基于数字CCD相机的高速图像采集系统[J].电脑开发与应用.2005，18(5):40-42.  
[26]赵庆岚，宋卫东，支建庄，宋丕极，田昊.基于线阵CCD的弹丸图像处理[J].军械工程学院学报.2004，16(5):22-25.  
[27]黄喆，周肇飞，余良忠.基于线阵CCD 的曲面孔系位置精密测量系统[J].光电工程.2003，30(4) :39-41.  
[28]达争尚，施浣芳.线阵CCD尺寸测量信号的提取［J].西安工业学院学报.2000,20(1) :35-38.  
[29]阳佳，吴久峰，邓志刚.基于机器视觉工业实时测量技术研究.制造业自动化.2003,25(2) :10-13.  
[30]雷志勇，刘群华,姜寿山，黄万景．线阵CCD图像处理算法研究[J].光学技术.2002,28(5) :475-477.  
[31］张洪涛，段发阶，叶声华．一种快速亚像素边缘检测方法研究[J]．计量学报.2002，23(4):263-270.  
[32] Ramesh Jain, Rangachar Kasturi，Brian G.Schunck. MachineVision.McGraw-Hill，1995.

#

基了机命枕见的防闪纸女土线似测大诞汉不研九-应用 [33] Yong Feng, Xiaoli Chen, Xuqiang Yang， Xinghuo Yu. Model of a TDI Line Scan Camera and Its Electronics. [34] E. Deutschl，C. Gasser，A. Niel，J. Werschonig. Defect etection on Rail Surfaces by a Vision based System.2004 IEEE Intelligent Vehicles Symposium, University of Parma,Parma，Italy， June 14-17,2004. [35] Zhu,C.H.Hirahara, K.Ikeuchi，K. Street-parking vehicle detection using line scan camera. Intelligent Vehicles Symposium, 2003. Proceedings. IEEE,9-11 June 2003:575- 580 [36] Lehotsky， Dan A. Intelligent high-sensitivity CCD line scan camera with embedded image processing algorithms. Proc. SPIE Vol. 3966，p. 40-47, Machine Vision Applications in Industrial Inspection VIII, Kenneth W. Tobin,03/2000. [37] Se-Na Lee,Bum-Jae You, Mee-Seub Limb, Sang-Rok Oh, Song-Soo Han,Sang Heon Lee. Visual measurement of pile penetration and rebound movement using a high-speed _line-scan camera.Robotics and Automation， 2002. Proceedings. ICRA'02. IEEE international Conference . 2002:Volume:4， On page(s): 4307- 4312 vol.4 [38]罗振璧,郑力,汪劲松.机器视觉在尺寸在线检测中的应用.机械工程学报.2004, 30(6):47-52. [39]范彦斌,李西兵,沈自林．基于亚像素的边界检测与提取算法及误差分析.机械科 学与技术.2005，24(2):189-192. [40]苗世迪,乔佩利,林克正,鲁颖欣.基于线阵CCD的精确测量方法研究．哈尔滨理工 大学学报.2006，11(2):208-211. [41]张丽荣．防伪纸的特性及其技术特点．西南造纸.2005，34(2):41-42. [42]伍济钢,宾鸿赞.机器视觉的薄片零件尺寸检测系统．光学精密工程.2007,15(1):124-130.

# 基于机器视觉的防伪纸安全线检测关键技术研究与应用

# 致谢

值此论文完成之际，我衷心地感谢我的导师谢兵兵研究员和王文生高级工程师近三年来对我孜孜不倦的教导，谢老师与王老师为我研究方向的确定提供了宝贵的意见。在论文写作过程中，谢老师与王老师不但给予悉心的指导，还提供了宽松的研究环境，引导我在科研和工作中一步步前进。

感谢郑清明研究员，在我进入电物理中心学习和工作的两年中，郑工不仅在学术上给与我很大帮助，在对待人生和工作上也给我很多指导和启发。郑工扎实的专业基础，严谨的治学精神和睿智达观的人生态度，都是我学习和工作的榜样。感谢韩梅老师和在我读研期间对我自始至终的指导、关心和帮助。感谢张蔚，蓝利平文等专家和同事对我在过去两年期间的生活上关心、帮助和支持，感谢郑清明，张蔚和原通文在我的论文研究中的前期工作。感谢所有关心和帮助过我的领导、同学、同事和朋友。

衷心感谢我的家人对我学习工作的支持。

最后对参加论文评审和答辩的各位老师和专家表示衷心的感谢！

韦玮2007年6月于北京机械工业自动化研究所