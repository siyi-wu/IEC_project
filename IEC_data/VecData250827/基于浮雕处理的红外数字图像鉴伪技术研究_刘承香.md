# 基于浮雕处理的红外数字图像鉴伪技术研究

刘承香1,阮双琛1,胡学娟1,简耀波1,2,黄贵明1(1.深圳大学电子科学与技术学院,广东 深圳 518060；2.华中科技大学光电工程学院,湖北 武汉 43074)

摘　 要：文中提出了一种对图像进行浮雕处理,然后通过闭运算消除不相关的细节,并用阈值法将图像二值化,最后采用模板匹配的方法进行鉴伪。这种方法取得了良好的试验效果,在实际应用中达到了 $100 \%$ 的识别率。

关键词：红外图像；浮雕处理；模板匹配

中图分类号： $\mathsf { T N 9 1 1 . ~ 7 3 ; \mathsf { T N 2 1 9 } }$ 文献标识码：A

# ResearchonTechnologyofIdentifyingtheCounterfeitbyProcesing InfraredImagesBasedonEmbosedfiltering

LIUCheng-xiang1,RUANShuang-chen1,HUXue-juan1,JIANYao-bo1,2,HUANGGui-ming1 (1.ColegeofElectronicScienceandTechnology,ShenzhenUniversity,Shenzhen518060,China； 2.Departmentof ${ \mathrm { 0 p } }$ toelectronicEnginering,HuazhongUniversityofScienceandTechnology,Wuhan43021,China)

Abstract：Inthispaper,theoriginalinfraredimagesareembosedfilteringfirstly,thenusingclosingtoeliminateirrelevantdetail,andthenthethresholdbasedmethodsisusedtogainbinaryimages.Atlast,templatematchingtoidentifyareused.Usingthismethodcangetverygodexperimentresultsandtherecognitionrateis $100 \%$ intheapplication.

Keywords：infraredimages；embosedfiltering；templatematching

# 1 引　 言

世界各国的钞票为了不被仿制、假冒,常用到雕刻凹版印刷技术,除了主题内容的需要,防止伪造是雕刻凹版印刷的主要功能。目前假钞较难做到凹版印刷,所以 “摸 ”凹凸感是一个很重要的公众鉴伪措施。利用红外光照射成像可以反映出纸币表面的凹凸情况,从而将纸币的凹版印刷图像显示出来。于是我们可以利用红外成像技术把传统的用手指触摸鉴伪扩展到更精密的图像鉴伪领域,实现人工向自动智能鉴伪的进步。同时,红外图像还可以克服流通过程中的笔迹、污渍和油墨等的影响,具有比采用可见光图像鉴伪更可靠和抗干扰性更强的优点。

利用红外图像鉴伪主要是对红外图像进行处理和识别,而当前国内外开展的红外图像的识别和跟踪技术大多集中在热红外成像上[1-2],一些学者也探索了红外图像在其他领域的应用[3],利用红外数字图像进行识别鉴伪在国内外还没有见到相关报道。本文的研究是红外技术应用的新领域,也是鉴伪技术的一个新方向。

由于凹版印刷防伪点形成的红外图像对比度不明显,尤其是对于磨损比较厉害的旧钞特征更不明显,且受纸币表面本身的不平以及纸币上的干扰(如折痕、孔洞 )等影响,采用传统的图像处理和增强技术很难鉴别。本文提出了一种对红外图像进行浮雕处理,然后对其进行闭运算操作,并采用阈值法将图像二值化,最后用模板匹配的方法进行鉴伪。

这种方法克服了红外图像对比度较差、边缘模糊、噪声较大的缺点,具有很好的识别效果。

# 2 图像特点分析

采用红外光源成像的原理是将所照射介质表面的凹凸不平反射形成图像,其红外图像没有颜色信息,主要是亮度或者灰度信息,而且背景和物体的灰度差别较小,如果我们直接对红外图像进行二值化处理,将引入很大的干扰。同时受光源的影响,每次采集图片的亮度差别较大,进行二值化很难设置其阈值。本文采用浮雕技术克服了光源的影响,只反映图内对比度的差别。真钞和假钞的红外图像主要表现为三种形式,包括有较明显的凹凸感的真钞红外图像 (如图 1(a)所示 ),由纸质或油墨吸收红外光谱形成偏黑色的假钞红外图像 (如图 1(b)所示 )和整个图像看不到明显凹凸感的另一种形式假钞红外图像 (如图 1(c)所示 )。

![](images/58ec6be6a6424f5f738cb04692c2ac93d0868b3b681c513ffcd734e7694a0470.jpg)  
图 1 真、假钞发丝部分红外图像的几种形式Fig.1 thre typesoftheinfraredimagesofpapercurency

# 3 红外图像的识别和处理

3.1 利用浮雕处理技术增强图像纹理

浮雕处理是将图像的变化部分突出,相近颜色部分则被淡化,使图像出现纵深感,从而提取有用信息。浮雕处理的算法有多种,需根据图像的特点选择不同的算法。本文给出的图像中 “手工雕刻主席头像发丝 ”是鉴伪的主要特征,发丝的雕刻方向主要是从左下到右上,所以处理的目的是希望突出左上到右下的落差。本文将右下方像素值减去左上方像素值的差值并乘以 2以增强浮雕效果。对于一幅真彩色的图,每一个像素用三个字节来表示,分别为 R、G、B的值,则经浮雕处理后的图像像素 R、G、B值为：

当前像素 R值 $\ L =$ 右下方的像素 R值 $\times 2$ -左上方的像素 R值 $\times 2 + 1 2 8$

当前像素 G值 $=$ 右下方的像素 G值 $\times 2$ -左上

方的像素 G值 $\times 2 + 1 2 8$

当前像素 B值 $\ L =$ 右下方的像素 B值 $\times 2$ -左上方的像素 B值 $\times 2 + 1 2 8$

具体操作实现方法是：选取一个 $3 \times 3$ 矩阵模板(如式 (1)所示 )进行滤波,将图像与模板进行卷积运算实现图像的小区域滤波,然后将滤波后的像素值加上一个偏移量 128,使得整个图像呈现灰色,有着更好的三维效果。

$$
\left[ { \begin{array} { r r r r r } { - 2 } & { { } } & { 0 } & { { } } & { { \mathfrak { q } } } \\ { 0 } & { { } } & { 0 } & { { } } & { { \mathfrak { q } } } \\ { 0 } & { { } } & { 0 } & { { } } & { { \mathfrak { q } } } \end{array} } \right]
$$

浮雕处理使真钞图像和假钞图像之间的区别更明显了,结果如图 2所示,真钞图像有较规则的发丝纹理,而假钞图像无论是墨汁颜色还是无压痕的图像,出现的纹理都是杂乱无章的。3.2 进行闭运算后二值化处理

图像形态学闭运算的定义是用一结构元素对图像进行先膨胀再腐蚀 $[ 4 - 5 ]$ ,即：

$$
\mathbf { f } \bullet \mathbf { \Pi } _ { \mathbf { g } } = ( \bigoplus \mathbf { \Pi } _ { \mathbf { g } } ) \Theta _ { \mathbf { \Theta } \mathbf { g } }
$$

其中,f为原图像； $\mathbf { g }$ 为结构元素；符号 $\textcircled{+}$ 表示膨胀；符号 $\Theta$ 表示腐蚀；f· $\mathbf { g }$ 为用结构元素 $\mathbf { g }$ 对 f进行灰度闭运算。本文采用的g为 $3 \times 3$ 的结构元素：

$$
{ \left[ \begin{array} { l l l l l } { 0 } & { } & { 1 } & { } & { 0 } \\ { 1 } & { } & { 1 } & { } & { 1 } \\ { 0 } & { } & { 1 } & { } & { 0 } \end{array} \right] }
$$

![](images/9c397affdbb3fe2405d1790da8ebd940434ffa5f4723d0d9c5fbee6375fd1b68.jpg)  
图 2 图 1中的图像经浮雕处理后的结果Fig.2 resultsofembosingtheinfraredimagesinFig.1

采用闭运算可以对一些独立噪声进行清除,使得真钞图像的纹理更加清楚。为了便于进行模板匹配,需将闭运算处理后的图像二值化。对图像进行二值化处理的方法很多,由于浮雕处理已经将图像变成了灰度图像,所以本文采用固定阈值 (取 128)进行了二值化处理,即灰度值大于 128取为白,小于128取为黑。闭运算处理并二值化后的图像如图 3所示。

![](images/c0ad6df4af06cc4dd274142c1e4c3f49174e9f29e91d632a7e1c6905c84f59c5.jpg)  
Fig.3 imagesafterclosingandbinarizationprocesing

# 3.3 采用模板匹配

采用闭运算处理和二值化后,真钞图像反映出了黑白相间的纹理,而两种假钞图像没有规则的发丝纹理。此时从信息比较集中的纹理部分 (比如凹版印刷集中的头发丝 )选取模板,进行模板匹配就能很好地区分开真钞和假钞。本文采用了两种模板匹配的方法,包括曲线匹配和子图匹配。

曲线匹配方法根据纹理选取头发丝比较明显的区域中白线 (或黑线 )的坐标为模板,到处理后的二值化图像中搜索最相近的白线 (或黑线 ),得出最大相关度,如果最大相关度大于预先设置的阈值,则判定为真,否则视为假。

子图匹配方法是从某个图中选取信息比较明显的一块子图,比如 ,利用传统的模板匹配方法搜寻最大相关度的子图,如果最大相关度大于预先设置的阈值,则判定为真,否则视为假。

这两种方法有各自的优缺点,第一种方法计算速度快,但对于某些特殊情况可能产生误判；第二种方法适用范围较广,但是计算速度较慢。本文对这两种方法都进行了验证。

由于图像采集系统的定位以及钞票本身长短、大小的差异,采集的红外图像可能存在移位、旋转等,所以本文采用了多个模板进行匹配,以增强算法的鲁棒性。同时,这种方法对于那些拼凑币也能起到了很好的识别作用,图 4所示为一张拼凑币的红外图像,右边部分为真,左边部分为假。在识别过程中右边部分识别为真,但是由于不满足左边的模板

![](images/08a7e91f9b7ca100edc6c449b40ed0883c841e3e296ea769549edf7c958912d9.jpg)  
图 3 闭运算和二值化后的图像  
图 4 拼凑币的处理结果

Fig.4 imagesofpiecetogetherpapercurencyafterprocesing匹配相似度,所以整体的识别结果可以鉴定为假。

# 4 实验结果及分析

本文采集了 107张钞票的红外数字图像,其中真钞 80张,假钞 27张 (包括 3张拼接币 )进行了识别分析,选择适当的匹配相似度,采用曲线匹配和子图匹配都得到了 $100 \%$ 的鉴别率,识别结果如表 1所示。实验结果说明本文提出的方法具有可行性,且对拼接币的识别成功也说明本文提出的方法具有抗干扰性和鲁棒性。

表 1 实验结果Tab.1 experimentresults  

<html><body><table><tr><td>防伪点</td><td>总数真币</td><td>张张</td><td>假币 张</td><td>真币误 识率%识率%</td><td>假币误</td><td>误识率 %</td><td>总体识 别率%</td></tr><tr><td>红外头 像发丝</td><td>107</td><td>80</td><td>27(包括3 张拼凑币）</td><td>0</td><td>0</td><td>0</td><td>100</td></tr></table></body></html>

# 5 小　 结

本文介绍了利用浮雕处理对低对比度红外图像识别鉴伪的方法。该方法首先通过浮雕加强信息和背景的对比度,此技术还可以克服光源亮弱的影响；然后采用闭运算将图像去除图像的独立噪声和不相关的细节,并对图像进行二值化处理；最后对信息密集部分采用模板匹配进行识别,设置模板匹配相似度的阈值,当相似度大于阈值则判定是真,否则视为假。这种方法对红外主席头像发丝的识别效果良好,而且速度较快,实验验证达到了 $100 \%$ 的识别率,具有很广的实用性。

感谢：本文的工作由中钞信达有限公司从 204年 1月到 205年 7月提供部分资助。

# 参考文献：

[1] 李建勋,刘刚,刘广智,等.红外弱小目标实时检测跟踪系统 [J].激光与红外,205,35(6)：407-409.  
[2] 陈修桥,胡以华,李军梅,等.卫星侦察红外图像背景特征分析 [J].红外技术,205,27(2)：143-146.  
[3] 邱白晶,刘保玲,吴春笃,等.近红外图像处理技术在农业工程中的应用 [J].农业工程学报,205,21(5)：102-106.  
[4] 何斌,马天矛,王运坚,等.VisualC $^ { + + }$ 数字图像处理[M].第二版.北京：人民邮电出版社,202.  
[5] RafaelCGonzalez,RichardE Wods.数 字 图 像 处 理[M].第二版.北京：电子工业出版社,202.(英文版 )