# 硕士学位论文

THESIS FOR MASTER'S DEGREE

![](images/466cf086ef91b068c843157fd5dfc8fb45f96bb94f75c67fddce07324955974e.jpg)

# 纸币红外特征鉴伪算法的研究

作者姓名： 陈小静指导教师： 张学东教授专业领域： 软件工程答辩日期： 2021年03月14日分类号 TP391 密 级 公开U D C 单位代码 10146学 号 182085212282

# 硕士学位论文纸币红外特征鉴伪算法的研究

# 研究生姓名：陈小静

指 导 教 师 ： 张学东 教授 工作单位： 辽宁科技大学  
指 导 教 师 ： 工作单位：  
论文提交日期： 答辩日期：  
学位授予日期： 授予单位：  
论 文 评 阅 人 ： 张学东 教授 工作单位： 辽宁科技大学  
论 文 评 阅 人 ： 盲审专家 工作单位：  
答辩委员会主席： 夏秀峰 教授 工作单位： 沈阳航空航天大学

# The Research of Banknotes Discrimination Based on Infrared Characteristics

# A thesis Submitted to University of Science and Technology Liaoning

by Chen Xiaojing (Majoring in software engineering)

Supervisor: Prof.Zhang Xuedong

# 中 文 摘 要

纸币在市场流通中，不可避免会遇到假币混杂其中，且假币种的数量少且不均衡。这种小样本不均衡分类学习是目前人工智能领域重点突破方向。广泛用于图像识别的深度学习，对这种纸币数据分类也容易出现过拟合。针对这种情形，研究具有解决小样本学习的智能预测鉴伪算法很有必要。本文的研究是基于已有假币样本少且不均衡的问题展开理论研究。设计算法对样本做倾斜校正、滤波去噪以及切割的预处理操作。提出新的红外纸币鉴伪模型，并且针对提出的模型做了优化改进。通过研究证明，该模型一定程度上解决了样本不均衡以及小样本的红外纸币图像识别问题，也为这一类型的图像识别提供参考方向。本文主要的工作及创新点如下：

（1）深入研究红外图像噪声处理，提出小波变换与 Gabor 结合的算法对图像进行去噪，将图像经过小波变换后的高频细节子图用 Gabor 滤波去噪融合，再经过小波变换重构，得到去噪后的图像。该方法做到去噪的同时保留了纸币的细节信息，便于后续纸币识别。

（2）深入研究生成对抗网络理论，提出基于辅助分类深度生成对抗网络新的红外纸币鉴伪模型，完成纸币特征提取与识别。模型中利用生成器和鉴别器博弈，将标签和随机噪声级联生成具有我们样本特征的图片，用生成的的数据进一步优化鉴别器，扩充我们的样本数量。纸币特征抽取后形成的鉴别器既可以判断图像真假也能对纸币分类，加入分类后鉴别器生成器能力也有所提高，在动态优化中实现理想的分类识别。用扩充后的样本进一步优化鉴别器，从而实现用少量标签样本就可以利用生成器和鉴别器的博弈提高模型特征提取能力，优化网络参数，平衡样本数量，继续优化分类，完成纸币识别。

（3）深入研究注意力机制基本原理，对上述提出的模型做出改进。将注意力引入生成对抗网络的鉴别器中，给鉴别器卷积通道加一个权重预测分支，期望自动学习通道特征的重要程度。通过对输入来的特征图进行全局平均池化，然后接一个Sigmoid 函数，得到通道特征的权重向量，然后和通道中原特征图做乘法加权，达到自动关注含信息量大的通道的目的。基于改进的辅助分类深度生成对抗网络算法实现纸币识别，一定条件下正确率得到了提升，但训练初期正确率没有明显变化。

关键词：纸币鉴伪；小波变换；生成对抗网络；注意力机制；小样本

# ABSTRACT

In the circulation of paper money in the market, it is inevitable that counterfeit money will be mixed with it, and the number of counterfeit currencies is small and unbalanced. This kind of small sample imbalanced classification learning is currently a key breakthrough in the field of artificial intelligence. It is widely used in deep learning for image recognition, and it is also prone to overfitting for this kind of banknote data classification. In view of this situation, it is necessary to study an intelligent predictive counterfeiting algorithm that solves small sample learning. The research of this paper is based on the theoretical research on the problem that the existing counterfeit currency samples are small and unbalanced. The design algorithm performs preprocessing operations of tilt correction, filtering and denoising and cutting of samples. A new infrared banknote verification model is proposed and optimized and improved based on the proposed model. Research has shown that the model solves the problem of imbalanced samples and small sample infrared banknote image recognition to a certain extent, and also provides a reference direction for this type of image recognition. The main innovations of this paper are as follows:

(1) In-depth study of infrared image noise processing, a combination of wavelet transform and Gabor algorithm is proposed to denoise the image, the high-frequency detail sub-images of the image after wavelet transform are fused with Gabor filter transform, and then reconstructed by wavelet transform to obtain denoising Image. The method achieves denoising while retaining the detailed information of the banknotes, which is convenient for subsequent banknote recognition.

(2) In-depth study of generative adversarial network theory, a new infrared banknote verification model based on semi-supervised auxiliary classification and generation confrontation network is proposed to complete banknote feature extraction and recognition. The model uses the generator and discriminator game to cascade the label and random noise to generate a picture with the characteristics of our sample, and use unlabeled data to further optimize the discriminator and expand our sample number. The discriminator formed after the feature extraction of banknotes can not only judge the authenticity of the image but also classify the banknotes. After adding the classification, the ability of the discriminator generator is also improved, and the ideal classification recognition is realized in the dynamic optimization. The expanded sample is used to further optimize the discriminator, so that a small number of label samples can use the game between the generator and the discriminator to improve the model feature extraction ability, optimize network parameters, balance the number of samples, continue to optimize classification, and complete banknote recognition.

(3) Deeply study the basic principles of the attention mechanism and make improvements to the model proposed above. Attention is introduced into the discriminator of the generated adversarial network, and a weight prediction branch is added to the discriminator convolution channel, and it is expected to automatically learn the importance of channel features. Through global average pooling of the input feature map, and then a sigmoid function, the weight vector of the channel feature is obtained, and then the original feature map in the channel is multiplied and weighted to achieve the purpose of automatically focusing on the channel with a large amount of information. Based on the improved auxiliary classification depth generation adversarial network algorithm to realize banknote recognition, the accuracy rate has been improved under certain conditions, but there is no significant change in the accuracy rate at the initial training stage.

Key Words: Banknote Discrimination ， Wavelet Transform ，Generative Adversarial Networks ， Attention Mechanism ， SmallSample

# 目 录

独创性声明..  
关于论文使用授权的说明..  
中 文 摘 要..  
ABSTRACT... iii  
1. 绪论..  
1.1 研究背景及意义..  
1.2 国内外研究现状.. 2  
1.3 红外纸币特征鉴伪. .4  
1.3.1 清分机概述.. .. 4  
1.3.2 红外图像鉴伪过程.  
1.4 研究内容及各章节安排.. .6  
1.4.1 研究内容及创新点... .6  
1.4.2 各章节安排...  
2. 图像预处理.... ... 9  
2.1 红外纸币图像预处理目标. .9  
2.2 红外纸币图像去噪. .... 9  
2.2.1 图像中常见噪声.. .10  
2.2.2 中值滤波法... ..11  
2.2.3 小波变换和 Gabor 结合去噪. .12  
2.3 红外纸币图像倾斜分割与校正. ..17  
2.4 本章小结.. .... 20  
3. 基于生成对抗网络的纸币红外特征鉴伪.... .21  
3.1 生成对抗网络基本原理. ..21  
3.1.1 GAN 原理. .... 21  
3.1.2 DCGAN 原理. ..24  
3.1.3 CGAN 原理.. ..25  
3.1.4 SGAN 原理.. ..... 27  
3.1.5 ACGAN 原理.. ... 27  
3.2 基于生成对抗网络算法的纸币红外特征提取与识别.. .29  
3.2.1 生成对抗网络模型设计. .... 29  
3.2.2 纸币红外特征提取与识别.... ... 30  
3.3 本章小结.. ... 32  
4. 基于生成对抗网络的纸币红外特征鉴伪模型改进. .... 33  
4.1 注意力机制. .33  
4.1.1 注意力机制基本原理.. ... 33  
4.1.2 注意力机制类型. .... 33  
4.2 引入注意力机制改进的红外特征鉴伪原理. ... 36  
4.3 基于改进的生成对抗网络的纸币红外特征鉴伪. .... 37  
4.4 本章小结. ... 38  
5. 实验结果与分析.... ..40

5.1 实验环境与过程. 40

5.1.1 实验环境. 40  
5.1.2 性能评价指标. .40  
5.1.3 实验过程. .41  
5.2 实验结果. .42  
5.3 实验分析. 46  
5.4 本章小结. .47  
6. 总结与展望. .48  
6.1 总结. 48  
6.2 展望. .48  
参考文献. .50  
攻读硕士学位期间发表学术论文情况. .53  
致 谢. .54  
作者简介.. ..55

# 1. 绪论

神经网络的发展，让智能化社会离我们越来越近，突破层层阻碍，获得硕果累累。作为现代机械设备的清分机承担着纸币鉴伪的最后一道防线，对金融行业和我们国家有重要意义。本文鉴于假币样本数量不均衡且数量少，目前深度学习针对这种小样本处理仍是一个难题，对红外特征纸币鉴伪作出理论研究。不仅为小样本且不均衡红外纸币问题提供了解决办法，而且为图像处理这一类特征问题提供了一个处理方向。本研究具有很大的意义。

# 1.1 研究背景及意义

清分机给社会带来了安全、便利、效益。清分机作为现代机械设备，具备机械化与自动化优点，能够自动地对纸币进行识别、清点与控制等[1]，解决了人工分拣的速度质量以及效率等问题，其科技含量极高。随着货币数量的增多与流通速度的加快，真伪将会直接影响到现代社会的和谐发展，即使当下线上支付越来越普遍，但是就像实体店铺和线上店铺存在关系一样，纸币不会消失，这就要求对流通钞要有精准鉴伪的能力。清分机作为防假过程中的最后一名“安检员”，对维护纸币正常流通有着艰巨而重要的责任。因为它的存在，给予中国社会带来了很多方便和益处，各家银行和到行的客户对其都有很高的称赞，社会效益明显，研究纸币清分机[2-3]理论算法有应用价值。如图 1.1 是国产清分机。

![](images/bdc32825c3bd78a87de62c1635bd15f388c6148e120198456ea2754b2d952256.jpg)  
图 1.1 纸币清分机实物图  
Fig. 1.1 Physical drawing of banknote sorting machine

纸币红外鉴伪是清分机图像处理模块中纸币识别[4]的核心算法之一。纸币在设计中添加了防伪成分，它的分布区域用肉眼是看不到的，当用红外光去照射纸币的时候，纸币不同区域对红外光的吸收程度是不一样的，这样就可以根据对红外光的吸收程度来区分纸币上的物质种类、含量及分布。所以鉴伪核心就是利用这种特性，真币和假币制作工艺不同，物质成分及分布就会不同，来实现防伪检测。

鉴于假币在市面上的分布零散，刚出现时相对于真币还是少量的，尤其是细分种类的时候数量更是不均衡，所以纸币存在样本不均衡问题，且假币样本少的问题。数据不均衡会造成 CNN 训练过程收敛慢、泛化能力差的负面影响[5]。小样本不均衡分类[6]问题是目前研究的一个重点突破方向。小样本学习[7-8]是人工智能的重要研究领域，人类总是能够在仅仅观察到为数不多的实例样本的情况下快速的学习到新的技能如图像分类任务。目前深度学习已在医疗影像、身份识别、智能驾驶等视觉领域得到广泛使用，在这些领域中数据稀缺常常是其面临的重要问题，有些数据的采集具有较高的难度，对海量的数据进行标注也将耗费大量的人力和财力，而有些数据则无法再获取更多的样本，例如一些灭绝物种的图像资源，人类能够通过历史的学习经验快速识别它们，并且人类对新样本的学习也能补充历史经验，进一步增强未来的学习能力。在这些领域中小样本学习是亟待解决的问题，也是人工智能重要的发展方向。

从实际应用价值上来看，小样本图像分类在医疗、安全等领域也有着相同的难题。主要的瓶颈是，难以获取大量的标注数据。主要原因有两方面：一是数据的收集困难，比如医学上一些疾病极为罕见，安全领域的一些数据涉及到机密等；二是数据的标注困难，比如医学图像的标注需要具备一定专业知识。因此，小样本学习非常适合用于这些领域中。从学术研究意义上来看，解决好小样本图像分类中的模型过拟合问题[9]，对深度学习中许多其他类型的任务也具有借鉴意义和参考价值。深度网络需要大量的数据才能学会分类，表明当前的深度学习技术和人类智能差距很大。小样本学习是弥补这一差距的关键问题。因此，小样本学习的突破对我们社会有重要意义，能为深度学习在人工智能领域大展拳脚清除大山，是目前前沿研究方向。

综上所述，研究红外特征纸币的识别[10]以及研究不均衡小样本的图像分类具有重要的理论意义和使用价值。结合深度学习的强大特征提取能力，有助于进一步提高人工智能技术的实用性和使用效率，是推进人工智能技术进步的重要研究方向。本研究课题利用辅助分类生成对抗网络学习模型，探讨不均衡小样本的数据如何识别，对红外特征纸币的识别不断探究，提取其特征，然后设计分类器完成识别。

# 1.2 国内外研究现状

清分机仍是我们重要的智能化设备，各国需求量依旧很大。在我国，人口多面积大，市场流通快，对清分机有着大量的需求，曾一度以倍数增长且持续上升。究其原因，我国清分机行业起步晚，需求大，国外对清分机技术呈垄断状态，就使得清分机的价格带动昂贵。经国内众多研究者的智慧，属于我国自主产权的清分机应运而生，市场刺激下就使得清分机产量成倍增长。图1.2 是经过仔细调查研究描绘的清分机在 09-14 年的供求图。可知我国纸币清分机市场从 09 年规模到14 年清分机产量增长了 10 倍有余，市场对清分机的需求量增长了约 13 倍，且是供不应求的状态，从清分机的需求可知其重要地位。全球清分机发展呈增长趋势，据清分机相关行业分析报告，2018 年，欧洲约占全球市场的 $30 \%$ ，中国和北美分别约占 $24 \%$ 和 $1 9 \%$ 。2019 年全球货币清分机市场总值为 109 亿元，估计2026 年能上涨到130 亿元，年复合增长率达到(CAGR) $2 . 5 \%$ 。

![](images/cdf4088e6383ce2b99821679adf8fd5b841d89f0e55d562d3b9594ccacdc4e1e.jpg)  
图 1.2 清分机产量需求量直观图  
Fig. 1.2 Direct view of output demand of sorter

清分机图像处理技术发展已相对成熟，但科技在迅速发展，目前清分机行业仍需将最新的科学技术做理论研究，争取应用到其中，去其短板，提高清分效率。早期纸币鉴伪技术如基于差别不等式技术[11]的纸币识别，这个方法关键是要得到每个图像的阈值和特征差别点，这些参数是需要人为选择的，所以这种需要人工提取特征的方法没有市场推广的价值。随后，人工神经网络技术风靡全球，不乏有很多的研究者将它应用于纸币的识别中，但其数据量庞大并不利于处理。F.Takeda 等发表了有关在纸币识别领域采取人工神经网络方面的论著[12]。S.Omatu，A.Ahmadi 等人[13]提出了通过主成分分析的方法用数据训练学习向量量化网络来对纸币进行识别。刘晓雅等，采用BP 神经网络[14-15]用于纸币识别。我国纸币鉴伪方法主要可分为模板匹配、支持向量机和神经网络鉴别方法。徐莹等根据纸币独特的纹理特征，利用小波变换提取纹理特征的优势，发表了基于小波变换的纸币鉴伪方法；曹贵强[16]根据非负矩阵分解、高斯混合模型等技术实现多国纸币识别及模板匹配法实现红外鉴伪。模板匹配法存在费时费力，计算量成本大，而且阈值的设置存在局限性；支持向量机方法对大样本的处理以及多分类问题上存在不足[17]；神经网络鉴别有智能性，符合当今社会自动化的主基调，自学能力、泛化能力、效率上都能取得较好效果。神经网络可以像人眼一样提取到我们所关注的特征，训练得到网络所需的恰当参数，但神经网络参数往往需要大量的样本支持。假币的特性使得金融机构的鉴伪能力存在不足。

现有的图像识别模型在面对这类数据集时表现出识别效果不佳，偏向多数类等现象。因此，处理这类数据集最有效的办法是进行数据合成，使数据集重新平衡。针对小样本问题，常见的策略有数据扩充、数据增强等，常见的技术有迁移学习，可以将从其他样本中学习到的东西用到我们自己的目标数据分类中，像人类一样拥有联想；还有元学习[18]，将分类数据映射到一个生成空间，通过查询标签和预测标签之间的损失值来更新网络；以及生成对抗网络[19]的提出与发展为小样本问题提供了新的解决思路，可以从扩充样本的多样性角度以及用鉴别器分类的角度来完成小样本的学习。卷积神经网络能从已有的数据出发，从大数据中提取样本特征，并将这些特征用于分类、定位等相关任务。但这种方法并不能创造新的样本，而生成模型的出现恰好弥补了这一缺陷。生成对抗网络是近年来热门研究对象，应用前景大。生成对抗网络有神经网络的优点，但不需要大量的样本便能快速收敛，将生成对抗网络用于纸币清分机的纸币红外特征鉴伪值得我们尝试，研究其是否能取得较好的结果。

# 1.3 红外纸币特征鉴伪

# 1.3.1 清分机概述

清分机系统主要分为四个模块，有控制、机械、图像采集处理以及显示模块。图像采集处理模块是本文的主要研究方向，这个模块主要负责图像的采集、预处理、分析与识别。

清分机启动根据入钞口传感器信号控制，当传感器遇到纸币图像时，直流电机启动，传送纸币，启动各种传感器，发出多个光谱的光线[20-21]，如图 1.3，将图像信号通过FPGA[22]控制分时经过A/D 转换，以矩阵形式将像素存储到指定内存 RAM 中，然后 DSP 将数据采集通过接口放入内存中处理，结果通过电机显示出来。纸币清分机清分机作为鉴伪过程中的最后一名“安检员”，因此对纸币检伪要求严谨。图像处理模块有诸多形式的鉴伪能力，譬如对纸币的紫外荧光反应、红外线透射、磁性位置分布等多种特性进行测试，若有其中任意一种特性不符合真钞特性即为假钞。红外穿透特性鉴伪：当红外发光管通电之时发出其特定波长的红外光，穿透钞票被光敏三极管接收，因为真钞和假钞透光率不同，光敏三极管的输出电流也有差别，从而达到区分真伪的目的。

本文研究的是纸币中的红外特征，通过纸币在设计中放入对红外线吸收不同的物质，做到防伪措施，本文采集的是100 元纸币，分辨率300dpi，采集其红外图像，实验图像大小统一到 $3 0 0 \times 7 2$ ，对其进行鉴伪模型的研究。

![](images/025c88da03494e075f06614aedcb94d6197c00d8af03127cbe5ada7c15726c2f.jpg)  
Fig. 1.3 Structure diagram of image acquisition system

# 1.3.2 红外图像鉴伪过程

纸币图像印刷中不可或缺由特殊材料组成的防伪油墨，这种油墨在可见光与红外光下会有不同的反应。可见光照射下纸币分布差异不明显，红外线下纸币特征分布差异较大特征，这是因为纸币在制作的时候，油墨所含物质对红外光吸收程度不同，反过来根据吸收程度大小也能判断都有什么物质。在生产纸币时，现在好多国家都会根据这种原理，选择不一样的油墨来绘制。这样在光下查看没有太多变化，但是只要将其放在红外线下就能看的非常清楚，在辨别纸币真假时根据红外投射特征波形找到图像防伪位置差异具有很大的作用。纸币在清分通道中会受到传送带传送纸币的速度、光源与图像的成像角度以及机械本身的原因会使得红外纸币信噪比低、纸张偏斜等质量受到影响的问题，因此构造纸币鉴伪的基本过程如下图1.4：

![](images/7578cff0370cd1c35c26f6ff3aa28bb39d9fc26875479304b1a122175387d7cf.jpg)  
图 1.3 图像采集系统结构图  
图 1.4 图像鉴伪基本过程  
Fig. 1.4 Basic Process of Image False Identification

（1）红外图像预处理阶段考虑到纸币经过清分机时由于光源，纸币新旧及设备本身等影响会使得图像信噪比大、对比度低。这样会导致图像像素点发生变化，掩盖或误导原有图像特征，让传感器在分析及理解图像的时候会有偏差，得到不精确结果。鉴于此，本文对红外纸币图像需考虑做去除噪声[23]、倾斜校正以及图像切割[24]等。

（2）特征提取[25]模块需要做的是得到图像中感兴趣点，计算机层面就是得到代表特征的像素，将像素划分为不同的集合，这样后续任务中我们对特征的分析才会理想。常用的图像特征有颜色特征、纹理特征、形状特征、空间关系特征。目前提取图像特征的常用方法有传统的自由掩膜、灰度差分统计法、灰度共生矩阵、灰度差分统计法、Fourier 变换法、窗口 Fourier 变换（Gabor)、小波变换法、最小二乘法、边界方向直方图法、基于 Tamura 纹理特征的纹理特征提取等、自动化的神经网络CNN 等。在这个过程需考虑根据已有的样本，如何设计模型可以尽可能充分的提取纸币特征。

（3）纸币识别[26]模块就是将我们的特征通过某种方法途径进行综合对比分析，根据所做任务对特征归类处理。对于纸币，我们需要对比不同纸币特征区域的差异，来鉴别真伪。神经网络[27]是现在主流智能算法，但其训练分类模型往往需要大量样本支持。样本少就会导致特征区域提取不完善，分类器鲁棒性低，再加上客观因素，不能有效识别。生成模型如生成对抗网络能生成多样性样本，并且通过少量数据就能收敛得到训练好的鉴别器，在处理这种数据的时候有一定的发展前景。生成的数据是和原数据具有相似特征的纸币，其可以作为补充样本来完成分类器模型的训练。本文红外特征纸币有样本数量小以及类别不平衡等问题，要求我们的算法具有鲁棒性。

# 1.4 研究内容及各章节安排

# 1.4.1 研究内容及创新点

本文主要研究的是红外特征纸币鉴伪的算法，对清分机中百元纸币红外特征图像的处理。设计恰当的红外图像预处理算法模型，用中值滤波去除椒盐噪声，用均值滤波和小波变换结合保留纸币边缘特征的同时去除噪声，对纸币倾斜角度分析并用 Radon 方法旋转并选择合适顺序切割背景，完成预处理。考虑纸币特征样本不均衡及数据少的问题，提出一种新的红外纸币鉴伪模型，对红外纸币特征提取与识别，并对该模型优化改进得到较好的识别结果，在这个过程中主要的创新点如下。

（1）深入研究红外图像噪声处理，提出小波变换与 Gabor 结合的算法对图像进行去噪，将图像经过小波变换后的高频细节子图用 Gabor 滤波变换融合，再经过小波变换重构，得到去噪后的图像。该方法做到去噪的同时保留了纸币的细节信息，便于后续纸币识别。

（2）深入研究生成对抗网络理论，提出基于辅助分类深度生成对抗网络新的红外纸币鉴伪模型，用于纸币特征提取与识别。模型中利用生成器和鉴别器博弈，将标签和随机噪声级联生成具有我们样本特征的图片，加入无标签数据进一步优化鉴别器，生成较优的样本。纸币特征抽取后形成的鉴别器既可以判断图像真假也能对纸币分类，加入分类后鉴别器生成器能力也有所提高，在动态优化中得到理想的分类。用扩充后的样本进一步优化分类。从而达到用少量样本就可以利用生成器和鉴别器的博弈提高模型特征提取能力，优化网络参数，平衡样本数量，优化分类，完成纸币识别。

（3）深入研究注意力机制基本原理，对基于辅助分类深度生成对抗网络的鉴伪模型做出改进。将 Attention 引入生成对抗网络的鉴别器中，给鉴别器卷积通道加一个权重预测分支，期望自动学习通道特征的重要程度。通过对输入来的特征图进行全局平均池化得到 $1 \times 1 \times 1 0 2 4$ 的向量，然后接一个 sigmoid 函数输出$1 \times 1 \times 1 0 2 4$ 的权重向量，得到通道特征的权重向量，然后和通道中原特征图做乘法加权，达到自动关注信息量大的通道，抑制那些不重要的通道特征的目的。基于改进的辅助分类深度生成对抗网络算法实现纸币识别，正确率得到了提升。

深度网络需要大量的数据才能学会分类，离人类智能还有差距，小样本学习是弥补这一差距的关键问题。通过设计对抗网络学习模型为小样本且数据不平衡图像分类中的模型过拟合问题提供了解决方案，既利用了神经网络强大特征提取能力，又规避其训练易过拟合需要大量数据做支撑的局限性，可以充分提取到小样本的特征。通过对比实验证明，基于改进的生成对抗网络为解决假币样本不均衡且数量小的问题尽了一份力量，也为这一类型的图像问题提供研究方向。

# 1.4.2 各章节安排

本文的内容共五章。

第一章：绪论。本章节阐述了所研究的红外纸币鉴伪课题内容，及相关领域主要面临的问题，阐述国内外清分机以及纸币识别技术发展的现状和清分机鉴伪过程，阐述图像样本不均衡以及样本数量少的问题与卷积神经网络的基本原理，最后对各章节内容加以简略地概括。

第二章：纸币图像预处理。探究去噪算法，提出小波变换和Gabor 结合法，保留细节的同时完成去噪。文章预处理内容有：噪声处理，倾斜校正，图像切割。

第三章：纸币图像特征提取与识别。简介生成对抗网络基本原理，设计基于辅助分类深度生成对抗网络算法的纸币红外特征提取与识别。

第四章：纸币识别模型进一步优化。对纸币识别模型参数优化总结，介绍

Attention 机制基本原理，引入 Attention 机制提升重要特征的权重，抑制不重要特征，利于网络用于纸币识别。

第五章：实验结果与分析，对上述设计的红外特征鉴伪算法模型模拟、优化参数、做对比实验以及分析总结。

第六章：总结和展望。总结了文章的主要研究内容，并指出本研究存在的局限性与可优化方向。

# 2. 图像预处理

图像预处理的主要目的是为了能更好的提取纸币图像自己的特征，去除外界因素大干扰，恢复有用的真实信息，这样便于最大化提取我们所需要的特征，降低图像识别误差，更好的完成目标识别。采集图像时易受到光照与成像的角度以及纸币和设施本身的影响，易受到噪声的干预，降低了原图像质量。所以要做噪声处理、图像切割、倾斜校正等处理。

# 2.1 红外纸币图像预处理目标

纸币经过CIS 传感器时受光照、纸币以及设备本身原因会产生椒盐噪声、散粒噪声和辐射带来的噪声等。

图像噪声会衰减图片信息，导致纸币红外图像会有信噪比低、对比度差等问题，影响红外图像质量，从而干扰纸币识别的精确性和高效率性。因此纸币图像进行去噪[28]处理是必要的。红外图像成像时由于传送带传送的速度以及光照等问题，每张图片之间可能存在偏移，以及成像背景会影响纸币识别。鉴于此，要对红外图像做以下基本操作。

（1）减少光和机器与纸币本身产生的噪声；  
（2）切割去除图像背景；  
（3）修正传送带运送纸币时与传感器成像角度带来的误差。

# 2.2 红外纸币图像去噪

针对前面红外图像的问题，本文用中值滤波法去除椒盐噪声噪声，用Gabor与小波变换[29-30]结合法在保证纸币图像细节的同时，针对高频段容易被噪声淹没的信息，去除噪声。下面2.1 左图是真币的红外图像，右图是假币的红外图像。图2.2 是其红外图像对应的直方图。

![](images/da5b3f6bf312508f9857a2a53c1ad426289743f61da9caeb47d42c4fe6338eac.jpg)  
图 2.1 真币红外图像与假币红外图像

Fig. 2.1 Real currency image and counterfeit currency infrared image

![](images/d7edfa8853d79fec6c8cb3cf63044e164b23c0423db7498401322876d4291738.jpg)  
图 2.2 假币与真币红外特征直方图分布对比图

Fig. 2.2 Comparison of the distribution of infrared feature histograms of real and fake coins

假币与真币红外特征直方图分布对比图的纵坐标为信息量的多少，横坐标为灰度级，由图可以看出真假币灰度级上的像素分布差异明显。像素都聚集小范围灰度级上，并且可以直观看出纸币红外图像有明显的峰存在。

# 2.2.1 图像中常见噪声

噪声具有随机性，没有特定形状，会影响和误导我们了解和学习图像中的信息，从而影响我们对图像处理任务的结果。噪声有多种类型，下面是常见的几种噪声。

（1）椒盐噪声：产生的原因一般是图像传感器中，信号受到强烈干扰时出现。在图片上的表现形式是黑白相间的亮暗点。（2）高斯噪声：产生的原因比如电压或电流的不稳定以及瞬间的突变，有热噪声散粒噪声等。在图片上的表现形式，概率密度函数一般是服从高斯分布，而它的功率谱密度又是均匀分布的，则称它为高斯白噪声。（3）泊松噪声：产生的原因是光源发射和 CMOS 接收之间由于一些原因没有完全一一对应。就是符合泊松分布的噪声模型，泊松分布适合于描述单位时间内随机事件发生的次数的概率分布。（4）乘性噪声：产生的原因是信道特性随机变化引起的噪声，当信号出现在特定信道时产生。如胶片中的颗粒。

在对图像去噪时，理解图像含有噪声的类型，以及相对应的去噪算法是有必要的。下面是阅读大量文献，以及平时学习积累的常用去噪方法及其主要特点以及优缺点如表2.1。

# 表 2.1 常用的去噪算法

Tab. 2.1 Commonly used denoising algorithms   

<html><body><table><tr><td>预处理方法</td><td>线性 滤波</td><td>非线性 滤波</td><td>核心思想</td><td>优缺点</td></tr><tr><td>均值滤波</td><td>√</td><td></td><td>将噪声放入平均计算中</td><td>简便、速度快会模糊图像</td></tr><tr><td>粒子滤波</td><td></td><td>√</td><td>最优贝叶斯估计</td><td>计算量大</td></tr><tr><td>中值滤波</td><td></td><td>√</td><td>该点用像素邻域灰度值代替</td><td>针对脉冲噪声、椒盐噪声</td></tr><tr><td>高斯滤波</td><td>√</td><td></td><td>对图像加权平均</td><td>针对高斯噪声</td></tr><tr><td>卡尔曼滤波</td><td></td><td></td><td>不需记录观测或估计的历史信息</td><td>高效，很多工程领域都能 找到它</td></tr><tr><td>最值滤波</td><td></td><td>√</td><td>输入和输出用逻辑运算实现</td><td>对椒盐噪声处理效果好</td></tr><tr><td>双边滤波</td><td></td><td>√</td><td>结合空间距离和像素相似度</td><td>保护边缘像素对低频信息 滤波处理较好</td></tr><tr><td>小波变换</td><td>√</td><td>√</td><td>通过调节参数逼近原始函数</td><td>算法高效简洁</td></tr></table></body></html>

# 2.2.2 中值滤波法

中值滤波是一种空域上的非线性平滑技术。可以消除脉冲干扰等二值噪声，同时保留图像细节，不使其模糊。核心思想就是用固定窗口周围想素的中值代替该像素点，其窗口是奇数值数量组成的，形状多变。

原理： $\mathbf { m }$ 是窗口长度（像素大小），对于 $f _ { 1 } , f _ { 2 } , \cdots , f _ { \mathrm { n } }$ 为升序排列的滤波数据，就是从这个序列中抽 $m$ 个数据 $f _ { i - \nu } , \cdots , f _ { i - 1 } , f _ { i } , f _ { i + 1 } , \cdots , f _ { i + \nu }$ ， $f _ { \mathrm { i } }$ 是这些滤波数据的中间值，此时 $\nu = \left( m - 1 \right) / 2 ,$ ，序列中值也就是滤波的输出值。下面是中值滤波的式子：

$$
y _ { i } = M e d \big \{ f _ { i - \nu } , \cdots , f _ { i } , \cdot \cdot \cdot , f _ { i + \nu } \big \} \quad i \in { \mathfrak { n } } , \nu = ( m - 1 ) / 2
$$

二维图像中，用矩阵 $f ( \mathbf { x } , \mathbf { y } )$ 表示图像的像素：

$$
f ( X , Y ) = { \left[ \begin{array} { l l l } { f ( 1 , 1 ) } & { f ( 1 , 2 ) . . . } & { f ( 1 , Y ) } \\ { f ( 2 , 1 ) } & { f ( 2 , 2 ) . . . } & { f ( 2 , Y ) } \\ { . . . } \\ { f ( X , 1 ) } & { f ( X , 2 ) . . . } & { f ( X , Y ) } \end{array} \right] }
$$

二维中值滤波表示为：

$$
y _ { _ { X Y } } = M e d \{ f _ { _ { X Y } } \}
$$

噪声点判断：若待测点与周围像素值差很多即在测试窗口值以外或者是其它信号点，则定该点是个噪声点标记为 1，就用周围（窗口）像素值从小到大排列的中值标记为零的点或者周围（窗口）标记为零点的均值替代。这种去噪方法简单易操作。

滤波窗口的形状以及尺寸的选取要根据实际图像以及应用要求来考虑，本文用的方形滤波如图 2.3。滤波尺寸选择本着由小到大的奇数原则依次选取，找到最符合我们需求的值。用此方法将红外纸币图像的椒盐噪声予以有效地滤除，去噪结果如图2.11。

# 2.2.3 小波变换和 Gabor 结合去噪

两种方法结合的方式能在实现高频部分噪声的滤除，同时最大限度的保留红外纸币图像的原有细节信息。

# （1）小波变换

小波变换是一种自适应信号处理技术，小波变换可以对图像进行多尺度细化分析，分析的方法是一个固定大小但形状随时间变化的窗口，每层分解都是原图四分之一地位四幅子图，对信号处理因其具有较多的可选择性以及参数的可调整性，故有很好的自适应性。经过变换后，图像低频信息的主体部分即 LL，LH、HL、HH 分别代表图像小波分解后的高频水平、高频垂直、高频对角线的细节分量。如图2.4。

![](images/370609c227206e5e40b6db880e6c721ecf097e6009f923434cb2e420857ecd53.jpg)  
图 2.4 小波一阶和二阶变换分解图  
Fig. 2.4 Wavelet first-order and second-order transform decomposition diagram

小波变换数学角度就是如图由公式2.4 变换到2.5 的过程：

$$
F ( \omega ) = \int _ { - \infty } ^ { \infty } f ( t ) ^ { * } e ^ { - \mathrm { i w t } } d t
$$

$$
W T ( a , \tau ) = \int _ { - \infty } ^ { \infty } f ( t ) ^ { * } \psi ( \frac { t - \tau } { a } ) d t
$$

从公式可以看出，公式2.4 是傅里叶变换，频率用ω表示，时间用表示t。公式2.5 是小波变换，傅里叶由频率ω决定，小波变换中决定小波函数伸缩尺度用a 表示，决定小波函数的平移用τ表示。通过平移量τ可以知道时域上的位置，因此通过对信号平移和伸缩一轮的时候，我们就知道了信息的位置与频率的对应分布。

小波多分辨率分析就是将信号通过伸缩和平移后，分解成低频信息和高频信息，也就是将原来的信号分成多个信号，使其在不同分辨率中，这些特征表示原始信号的局部特征，进而完成局部化分析。因为噪声和图像细节主要分布在高频，故需要对小波变换之后的高频部分进行详细处理。

信号产生的小波系数含有信号的重要信息，将信号经小波分解后图像信号小波系数较大，噪声的小波系数较小，并且噪声的小波系数要小于信号的小波系数，通过选取一个合适的阀值，大于阀值的小波系数被认为是有信号产生的，应予以保留，小于阀值的则认为是噪声产生的，应该去除，但是对信息和噪声重叠部分处理困难。

下面是本文纸币红外图像经过小波变换后不同系数对应的分解图 2.5。可以看出系数对应不同的图像特征。通过对高频段的小波系数进行处理，然后重构就能完成滤波去噪操作。

![](images/1822ddae2b731d14828029bcf8614b3fad2551011e46de654da129737680dee3.jpg)  
图 2.5 红外纸币小波分解图  
Fig. 2.5 Wavelet decomposition diagram of infrared paper money

# （2）二维 Gabor 滤波

Gabor 变换是 D.Gabor 于 1946 年提出的。二维 Gabor 滤波是一个由正弦平面波调制的高斯核函数。Gabor 滤波器具有最小的时频窗,即Gabor 函数能做到具有最精确的时间-频率的局部化，具有最好地兼顾信号在时频域的分辨能力。针对高频信息容易和噪声有重叠部分，它通过和图像卷积实现对图像的滤波操作，能在完成图像平滑操作的同时，最大限度的保留图像原有信息，它对纹理细节特征有很好的处理。Gabor 滤波能较好地匹配红外纸币特征。

二维Gabor 函数数学表达：

$$
\mathrm { g } ( x , y , \theta , \psi , \sigma , \gamma ) = e ^ { - \frac { \mathrm { x } 1 ^ { 2 } + \gamma ^ { 2 } y 1 ^ { 2 } } { 2 \sigma ^ { 2 } } } . e ^ { i ( 2 \pi \frac { \mathrm { x } 1 } { \lambda } + \psi ) }
$$

实数部分：

$$
\begin{array} { r } { \mathrm { g } ( x , y , \theta , \psi , \sigma , \gamma ) = e ^ { - \frac { x 1 ^ { 2 } + \gamma ^ { 2 } y 1 ^ { 2 } } { 2 \sigma ^ { 2 } } } . \mathrm { c o s } ^ { i ( 2 \pi \frac { \mathrm { x l } } { \lambda } + \psi ) } } \end{array}
$$

虚数部分：

$$
\mathrm { g } ( x , y , \theta , \psi , \sigma , \gamma ) = e ^ { - \frac { x 1 ^ { 2 } + \gamma ^ { 2 } y 1 ^ { 2 } } { 2 \sigma ^ { 2 } } } . \mathrm { s i n } ^ { i ( 2 \pi \frac { \mathrm { x } 1 } { \lambda } + \psi ) }
$$

$$
\mathbf { x } 1 = x \cos \theta + y \sin \theta
$$

$$
\mathbf { y } \mathbf { l } = - x \sin \theta + y c o n \theta
$$

参数含义： $( \mathrm { x } , \mathrm { y } )$ 表示图像像素点，θ是Gabor 的条纹方向， $\Psi$ 是相位偏移量，σ是 Gabor 的尺度因子， $\boldsymbol { \gamma }$ 决定Gabor 的形状，(x1,y1)为图像像素旋转后的点， $\lambda$ 是正弦波波长。实验红外图像尺寸是 $4 4 0 { \times } 1 0 6 8$ ， $\Psi$ 取值为 0， $\lambda$ 取值（12，15，

17，19），θ取（0,30,60,90,120,150），γ取 1，λ取 5。

通过正弦波和高斯函数构造的滤波器实部和频域图绘制如下图2.6、2.7，可以直观感受到Gabor 滤波。

![](images/13118873dff260ea256fc98448c6299ba9ccd5f3e8a3247b7a6af8ac4a4833a8.jpg)  
图 2.6 滤波器实部图

![](images/9990a16bf10118eb3f0c7a7fbe76cc958122006bff7af5aca2dd4df5125a5778.jpg)  
Fig. 2.6 Filter real part graph   
图 2.7 滤波器频域图  
Fig. 2.7 Filter frequency domain diagram

一个Gabor 核能获取到图像某个频率邻域的响应情况，这个响应是图像的一个滤波结果。纸币图像 4 尺度 6 方向滤波核如2.8。用这些核与图像卷积，我们就能得到图像上每个点和其附近区域的频率分布情况。Gabor 滤波器由实部和虚部组成，二者相互正交。用实部进行滤波后图像会平滑；虚部滤波后用来检测边缘。针对高频部分噪声的去除有很好的效果，可以尽可能保留图像的边缘信息。

![](images/36e9574633e5b2d1747c5f3ad5fac0f20e768d05cc7f4ea92d862687744ba6d1.jpg)  
图 2.8 Gabor 滤波核

通过Gabor 滤波器对图像尺度为15，6 个方向滤波操作。滤波结果如图2.9。可以看到滤波的方向性。

![](images/70b09b45be09d501868701800e2507923bc329aaab8131a6e1234c3bbcb5fec4.jpg)  
Fig. 2.8 Gabor filter core   
图 2.9 同尺度不同方向滤波结果图  
Fig. 2.9 Filtering results in different directions at the same scale

# （3）小波变换和Gabor 结合去噪

小波变换多尺度多分辨率的特点能有效保护图像的细节特征，但在高频部分信息与噪声重叠的部分，去噪效果不理想。对此考虑到Gabor 变换实现了时频分析的局部化，是一种具有单一分辨率的时频分析，但对图像边缘敏感。综合二者的优点，探究小波变换和Gabor 相结合的方法去噪，具体步骤如下：

对纸币红外图像选用 haar 小波函数进行小波分解，得到低频信息图像和三个高频细节子图。对图像高频子图用 Gabor 滤波进行多尺度多方向去噪，然后加和得到去噪后的图像。将低频近信息图像和Gabor 滤波处理后的高频细节子图像进行小波逆变换，重构得到最终去噪后的图像。去噪结果图如下图2.12，2.13。

![](images/4ac1b1de0d1f4b10ce77284f1019e851e436562795c6bd8e6b194c479e58a228.jpg)  
图 2.10 原图像  
图 2.11 中值滤波后的图像

![](images/2e424e312d901d3b718d491ebb12f30545dfacb25ca8e03d15af3d055223b2b7.jpg)  
Fig. 2.10 Original image   
Fig. 2.12 Image after wavelet transform

![](images/823cd4bb5cb9b17a1777c13c5a0f6899fbc36eb4d4aa06fc68e4c71c6e50ddb9.jpg)  
Fig. 2.11 Median filtered image   
图 2.12 小波变换后的图像  
图 2.13 结合法滤波的图像  
Fig. 2.13 Combined method filtered image

可以看出经本实验用于纸币红外特征图像用小波变换与 Gabor 结合法去噪效果后效果比用小波变换要佳，不仅达到去噪效果，而且最大限保留了原纸币图像特征。

# 2.3 红外纸币图像倾斜分割与校正

我们需采集的纸币经 CIS 传感器时容易与传送带衔接不好使得纸币送进去时位置受影响，这样我们拍摄的图像往往是倾斜的，纸币图像处于倾斜状态时会对纸币识别有着很大的影响，所以我们应该先对纸币图像进行倾斜的校正。

1. 本文分析了清分机中红外纸币的倾斜情况如图2.14：

![](images/59f9c582d3e0e156e501f6a090dbea6b9ab430308f7de6441765e564a483645c.jpg)  
图 2.14 红外纸币倾斜角度示意图

根据研究，在综合因素情况下，我们要如图2.15 先进行水平方向上的校正，因为在水平倾斜中不用改变像素位置，而竖直方向上像素位置会改变。经过实验分析纸币背景区域对垂直倾斜角的检测会产生影响，从而导致竖直方向上倾斜校正出现不准确。对纸币进行倾斜校正后，就要对纸币进行水平去边框操作。这样效果最佳。

![](images/90a77ad0c3756e660cbf3f3793939e6ca154c3ea07f9c925383dd98edd39120d.jpg)  
Fig. 2.14 Schematic diagram of the tilt angle of infrared banknotes   
图 2.15 校正方向和去边框顺序图  
Fig. 2.15 Correction direction and de-frame sequence diagram

2. 校正算法（1）图像边缘检测

Canny 算子[31]具有较好的信噪比以及精确度，该算子用于边缘检测效果好，本文用下面的卷积模板对二维纸币做卷积。寻找图像 $\operatorname { f } ( \mathbf { x } , \mathbf { y } )$ 梯度的局部最大值。

$$
G _ { x } = \left[ { \begin{array} { c c c } { - 1 } & { 0 } & { 1 } \\ { - 2 } & { 0 } & { 2 } \\ { - 1 } & { 0 } & { 1 } \end{array} } \right] , G _ { y } = \left[ { \begin{array} { c c c } { - 1 } & { - 2 } & { - 1 } \\ { 0 } & { 0 } & { 0 } \\ { 1 } & { 2 } & { 1 } \end{array} } \right]
$$

公式2.15 计算每个点的梯度幅值， $\mathbf { G } _ { \mathrm { x } }$ 、 $\mathrm { G } _ { \mathrm { y } }$ 主要分析水平、垂直方向边缘。

$$
G \left[ i , j \right] = \sqrt { G _ { x } ^ { 2 } + G _ { y } ^ { 2 } }
$$

局部最大值不一定是边缘检测点，要做全局分析，找出极大值点，将局部最大值设为零值，从而检测出图像边缘。边缘检测示例如图2.16。

![](images/82062b1808b3e4c82a554eb1f803435b1824ca582239ecd0976a38dd07bccfc0.jpg)  
图 2.16 边缘检测示例图  
Fig. 2.16 Example image of edge detection

（2）基于Radon 变换的图像校正

Radon 变换是 1917 年由德国数学家 J·Radon 提出的，Radon 变换可以用来计算图像在某一特定方向上的投影。Radon 变换是一种积分变换，其在二维空间的表示如公式2.16：

$$
R ( \rho , \theta ) = \int \int f ( x , y ) \delta ( \rho - x \cos { \theta } - \sin { \theta } ) d x d y
$$

x 和y 约束在某直线的表示为， $x \cos \theta + y \sin \theta = p$ ， $\delta$ 是狄拉克函数， $\rho$ 是坐标系原点到直线的垂直距离， $\theta$ 就是代表方向。 $\operatorname { f } ( \mathbf { x } , \mathbf { y } )$ 表示图像像素点，R $\mathbb { \left( \right)} \rho , \theta $ 是f(x，y)沿直线在图像 $\mathrm { ~ D ~ }$ 上的线性积分。

Radon 变换的原理是：Radon 变换相当于把函数 $\operatorname { f } ( \mathbf { x } , \mathbf { \mu } _ { \mathrm { y } } )$ 通过线积分，表示成了另外的一种直线参数 $\rho$ ， $\theta$ 形式。根据直线L 的倾斜角检测原理[32]，水平倾斜校正：将边缘检测后的纸币红外图像水平直线运用 Radon 原理在 $0 ^ { \circ }$ 到 $1 8 0 ^ { \circ }$ 做投影，计算投影后的最大正值θ和，则纸币倾斜角即 $9 0 ^ { \circ }  – \theta ^ { \circ }$ 。竖直方向上原理相同。得到校正结果如图2.18。

![](images/2fdde3c931af869f1fe651bb014ff786dd71e8bc8df1402f2c031777a6ac3772.jpg)  
图 2.17 红外纸币倾斜切割前的图像

![](images/626a5bd3ca9ac2ffb1df717131cc4856208ffe0f08c22c1af1451463653b7e3e.jpg)  
Fig. 2.17 Infrared banknotes before oblique cutting   
图 2.18 红外纸币倾斜切割后的图像

Fig. 2.18 The image of the infrared banknote after oblique cutting

# 2.4 本章小结

本章首先介绍了图像普遍存在的噪声以及采集红外纸币时受到的环境因素，分析纸币都需要做哪些预处理操作。首先对纸币进行了中值滤波去除椒盐噪声,然后本文提出用小波变换和Gabor 结合去噪的算法，用小波变换对红外纸币图像进行小波分解，然后将高频子图像用 Gabor 变换融合，再经小波变换逆变换得到去噪后的图像，该方法保留纸币原有信息基础上除去高频噪声。之后对纸币进行了校正和切割分析，实验得出边校正边切割会得到较高的准确率，确定了用Radon 来校正，以及用Canny 算子做边缘检测切割。然后对图像尺寸做统一处理，尺寸为 $3 0 0 \times 7 2$ ，得到预处理后的图像为我们接下来红外特征纸币的特征提取与识别做准备。

# 3. 基于生成对抗网络的纸币红外特征鉴伪

# 3.1 生成对抗网络基本原理

生成对抗网络[33-34]（GAN）是 2014 年 Goodfellow 提出的深度学习模型。生成模型是指在某种约束条件下，随机生成观测数据的模型，并且控制观测值和标签数据分布空间逐渐接近。生成模型分两种类型，第一种的生成模型可以得到数据确定的分布函数，第二种类型的生成模型只可以取得新样本，而数据分布函数则是不清楚的。现实中我们往往不知道数据集的概率分布，所以探究通过第二种生成高质量的数据有重大意义。研究者从零和博弈论里面根据对手的方法来变换自己方法的思想学习到对抗的思想，然后提出了生成对抗网络。

GAN 通过学习的生成模型可以生成不在训练集但是遵循相同分布的样本。GAN 和传统的生成模型不同，它有两个对抗关系的网络组成，分别取名为鉴别器和生成器，也时常有人叫它“警察”和“小偷”。GAN[35-36]又有各种变形，有适合于生成图片的，有适合于分类的。GAN 有个难点就是训练过程参数调优不容易控制，需要合理控制判别器和生成器的训练程度，不能让生成器梯度消失或者振荡。近年来多人对GAN 进行变形改进不断优化了网络生成图片的质量。有被广泛应用的深度卷积生成对抗网络（DCGAN）[37]，优点是训练过程中状态相对稳定，能生成质量较好的图片；考虑到监督学习的神经网络，研究者提出监督式辅助分类生成对抗网络模型（CGAN）[38-39]，可以根据网络的输入标签生成对应的输出，而且输出结果相对于传统神经网络效果好且具有多样性；生成模型亦可通过半监督式学习，从而能够优化生成器的同时得到分类器，鉴于此研究者们提出了一种半监督式生成对抗网络[40]（SGAN)。研究者的目标是希望 SGAN 能够做到同时训练生成器与半监督式分类器[41-42]，最终希望实现一个更优的半监督式分类器，以及得到一个成像质量更高的生成模型。据实验分析，不仅生成了高质量图片，还对鉴别器进行改进做分类器，在同样样本数量前提下提高了分类准确率；结合 CGAN 中使用了辅助的标签信息来增强原始 GAN 和 SGAN 利用判别器或分类器一端来重建标签信息优势得到了 ACGAN[43-44]模型，该模型不仅能提高生成样本的质量，并且使得训练更加稳定[45]。并且已有研究者在训练好的 MNIST数据集上进行测试，分类正确率能达到 $9 8 . 0 3 \%$ 。

# 3.1.1 GAN 原理

生成对抗网络是利用生成器和鉴别器博弈，将随机噪声生成我们预想的信息。GAN 结构如图 3.1。

![](images/7f37857d568f7bc75e2484ed69d4afb94ef314954024cdb58f6ff3e0bcc90584.jpg)  
图 3.1 生成对抗网络结构  
Fig. 3.1 Generative Adversarial network structure

生成模型的概念如图 3.2，就是实现生成数据逼近我们真实数据分布的一个方法。下面介绍一下最大似然估计生成模型过程，即生成空间逼近原数据分布。给生成模型定义一个概率分布函数 $P _ { \mathrm { m o d e l } } ( x , \theta )$ ，模型分布是通过参数变量 $\theta$ 定义的。从真实数据集中采样大量的数据定义概率分布函数 $P _ { d a t a } ( x )$ 。在实际的计算过程中我们希望通过改变参数 $\theta$ ，从而使得生成模型概率分布 $P _ { \mathrm { m o d e l } } ( x , \theta )$ 可以近似于真实数据概率分布 $P _ { d a t a } ( x ) \circ \mathrm { ~ L ~ }$ 是噪声经过生成型在这些数据上的概率。 $\mathrm { ~ L ~ }$ 越大说明生成模型越好。

$$
L = \prod _ { i = 1 } ^ { m } P _ { \mathrm { m o d e l } } ( x ^ { ( i ) } ; \theta )
$$

经变形推理找到一个 $\theta ^ { * }$ 使得下面的结果最小，即最优解。

$$
\boldsymbol { \theta } ^ { * } = \underset { \boldsymbol { \theta } } { \operatorname { a r g m a x } } \underset { \mathrm { i = 1 } } { \overset { \mathrm { m } } { \prod } } P _ { \mathrm { m o d e l } } ( \boldsymbol { x } ^ { ( i ) } ; \boldsymbol { \theta } )
$$

$$
\theta ^ { * } = \arg \operatorname* { m a x } _ { \theta } \int P _ { d a t a } ( \mathrm { x } ) \log \frac { P _ { \mathrm { m o d } e l } ( \mathrm { x } ) } { P _ { d a t a } ( \mathrm { x } ; \theta ) } d x
$$

引入KL 散度公式：

$$
K L ( P \| Q ) = \int p ( \mathrm { x } ) \log \frac { p ( \mathrm { x } ) } { q ( \mathrm { x } ) } d x
$$

我们发现我们推到的 $\theta ^ { * }$ 公式和KL散度是完全一致的。由此看出 $P _ { \mathrm { m o d e l } } ( x , \theta )$ 趋近于 $P _ { d a t a } ( x )$ ，生成模型就成功了。

$$
\theta ^ { ' } = \underset { \theta } { \arg \operatorname* { m i n } } K L ( P _ { \mathrm { d a t a } } ~ \left( \mathbf { \Delta x } \right) \left\| P _ { \mathrm { m o d e l } } ( { x ; \theta } ) \right)
$$

![](images/d411d259da3f172ffddccb024f1f5d51c0c5c22cd602b9b2289dd6aa3179f24d.jpg)  
图 3.2 生成模型概念图  
Fig. 3.2 Generate model conceptual diagram

生成对抗网络模型也是从一个输入空间将数据映射到我们的生成空间X，写成公式的形式是 $X = G ( z )$ 。通常我们的输入 X 会满足一个简单形式的随机分布，生成函数G 会是一个神经网络的形式，生成模型中神经网络能够实现 $p _ { \mathrm { m o d e l } } ( x , \theta )$ ，它可以把简单分布映射成我们需要的几乎任何的复杂分布，但经过一个神经网络我们难以计算最终的生成空间分布 $p _ { \mathrm { m o d e l } } ( x , \theta )$ ，故生成对抗网络解决方式如下，以判别器为例，代价函数写作 $\boldsymbol { \mathrm { J } } ^ { D }$ ，生成器写作 $\boldsymbol { \mathrm { J } } ^ { \mathrm { G } }$ 。

$$
J ^ { ( D ) } ( \theta ^ { ( D ) } , ~ \theta ^ { ( G ) } ) = - \frac { 1 } { 2 } E _ { x - P _ { \mathrm { d u t } } } \log D ( x ) - \frac { 1 } { 2 } E _ { x - P _ { 2 } } \log ( 1 - D ( G ( z ) ) )
$$

将J(D)，J(G)二者的代价和为零。

$$
J ^ { ( G ) } = - J ^ { ( D ) }
$$

设置一个价值函数 $V$ 来表示生成器和鉴别器的代价。

$$
V ( \theta ^ { ( D ) } , \theta ^ { ( G ) } ) = E _ { x - p _ { d a t a } } \log D ( { \bf x } ) + E _ { x - p _ { z } } \log ( 1 - D ( G ( { \bf z } ) ) )
$$

我们现在把间题变成了需要寻找一个合适的 $V$ 使得 J(G)和 J(D)都尽可能小，就是说通过判别器和生成器二者博弈，我们可以求出理想的判别器 $D ^ { * } ( x )$ 和生成器 $\boldsymbol { G } ^ { * } ( \boldsymbol { x } )$ ，这里先固定生成器G，令 $\mathbf { G } ( z ) = x \circ p _ { g } ( x )$ 就是生成数据判为真的概率。

$$
\begin{array} { l } { { \displaystyle V = E _ { x - P _ { d a t a } } \log D ( \boldsymbol { x } ) + E _ { x - P _ { z } } \log ( 1 - D ( G ( z ) ) ) } } \\ { { \displaystyle = \int P _ { \mathrm { d a t a } } ( \boldsymbol { x } ) \log D ( \boldsymbol { x } ) + P _ { \mathrm { g } } ( \boldsymbol { x } ) \log ( 1 - D ( \boldsymbol { x } ) ) d \boldsymbol { x } } } \end{array}
$$

$$
\frac { \mathrm { d } f ( x ) } { \mathrm { d D } f ( x ) } { = } \frac { P _ { d a t a } ( x ) } { \mathrm { D } ( x ) } { = } \frac { P _ { g } ( x ) } { 1 { \mathrm { - D } } ( x ) } { = } 0
$$

从下式可以看出鉴别器是一个0-1 范围的值。

$$
D ^ { * } ( x ) = \frac { P _ { d a t a } ( x ) } { P _ { d a t a } ( x ) + P _ { g } ( x ) }
$$

将 $D ^ { * } ( x )$ 带入前面积分式子

$$
\begin{array} { l } { { \displaystyle \operatorname* { m a x } _ { { D } } V ( G , D ) = V ( G , D ^ { * } ) } \ ~ } \\ { { \displaystyle = \int P _ { \mathrm { d a t a } } ( x ) \log \frac { P d a t a ( x ) } { P _ { d a t a } ( x ) + P _ { g } ( x ) } d x + \int P _ { \mathrm { g } } ( x ) \log \frac { P _ { g } ( x ) } { P _ { d a t a } ( x ) + P _ { g } ( x ) } d x } } \end{array}
$$

把KL 散度代入展开：

$$
J S D ( P \| Q ) = \frac { 1 } { 2 } K L ( P \| M ) + \frac { 1 } { 2 } K L ( Q \| M )
$$

$$
J S D ( P \| Q ) = \int p ( x ) \log \frac { p ( x ) } { \frac { p ( x ) + q ( x ) } { 2 } } d x + \int q ( x ) \log \frac { q ( x ) } { \frac { p ( x ) + q ( x ) } { 2 } } d x
$$

$$
\begin{array} { l } { \displaystyle \operatorname* { m a x } _ { D } V ( G , D ) = - \log ( 4 ) + K L ( P _ { d a t a } \| \frac { P _ { d a t a } + P _ { g } } { 2 } ) + K L ( P _ { g } \| \frac { P _ { d a t a } + P _ { g } } { 2 } )  } \\ { \displaystyle \quad = - \log ( 4 ) + 2 \times J S D ( P _ { \mathrm { d a t a } } \| P _ { \mathrm { g } }  } \end{array}
$$

由公式 3.15 可知当 $\scriptstyle \mathrm { P g ( x ) = P d a t a ( x ) }$ 时达到我们的生成最优解 $\boldsymbol { G } ^ { * } ( \boldsymbol { x } )$ 。此刻生成器和鉴别器达到纳什平衡，此时生成的数据鉴别器已分不清真假。从分布趋近原理也能看出GAN 能生成多样性图片。

# 3.1.2 DCGAN 原理

DCGAN 在 GAN 的基础上引入卷积神经网络。卷积神经网络（ConvolutionalNeural Network, CNN）是一种常被用于图像分类相关的前馈神经网络。卷积神经网络具有良好的非线性能力，几乎可以拟合任何分布。CNN 的核心是卷积，可以认为是一个矩阵运算，他可以提取出图像的一些边缘，纹理特征。举个简单的例子，假如是一个人脸识别的话，整个人脸的边缘部分和背景是很好区分的，因为这部分的图像像素变化率会非常明显。卷积层由卷积计算和激活函数构成，就图像识别来说卷积就是已知样本数据和未知数据局部之间的计算，根据像素相乘求和计算，返回是否一类的结果，从而完成对多层抽象特征进行分类。这种一对一映射更有利于对图像进行处理，这种局部计算的好处就是能更好的提取特定信息，像人眼一样眼睛具有感受范围，具有感受偏重，而且卷积共享参数机制降低了神经网络庞大计算量，解决了当时很多因计算问题不能训练的任务。卷积有卷积核、深度、步长、填充项等参数，这些常常须综合样本以及模型还有训练任务考虑设置，以及一些池化操作、dropout 等常用的方法维护模型继续训练的操作。

2015 年在GAN 的基础之上提出了全新的DCGAN 架构，该网络解决了GAN训练的时候中振荡的缺点。并可以生成高质量的图片，具有非常强的实用性。DCGAN 在 GAN 的基础上引入卷积神经网络[46-47]，去掉了池化层，将全连接层以全局池化层替代以减轻计算量，引入激活函数。

![](images/bc15c8fe9092fd194a3070214600c44fa35b445a6df139e15ff34a8bbc48c145.jpg)  
图 3.3 步长卷积下采样示意图

图3.3 表示了卷积如何在DCGAN 判别器中进行进行空间下采样，所谓下采样就是对原图像的模糊和压缩，输入数据为 $5 { \times } 5$ 的矩阵，使用了 $3 { \times } 3$ 过滤器，步长为 $\mathbf { x } 2$ ，最终输出矩阵 $3 { \times } 3$ 。

![](images/98c18c4498770ed1dea03f6f8c48b73fcff6ebfdcac7e0db31b76beaa7893006.jpg)  
Fig. 3.3 Step size convolution downsampling diagram   
图 3.4 步长卷积上采样示意图  
Fig. 3.4 Step size convolution upsampling diagram

图3.4 表示了卷积如何在DCGAN 生成器中进行进行空间上采样，上采样是对原始图像的放大和扩展，输入数据为 $3 { \times } 3$ 的矩阵，使用了 $3 { \times } 3$ 过滤器，步长为x1，最终输出矩阵为 $5 { \times } 5$ 。

卷积神经网络强大的特征提取能力使得生成图片的质量很好。在评价生成质量好坏的时候，将数据用 DCGAN 的鉴别器进行变化做的分类器进行识别，发现分类正确率理想，说明生成的图像质量好，也说明了鉴别器可以做分类器。

# 3.1.3 CGAN 原理

CGAN 是一种条件生成对抗网络，它可以生成具有特定特征的信息。有监督学习就是用带标签的数据去训练分类器，CGAN 就是一种有标签学习。说到这会想到传统的监督式神经网络也可以生成带标签的数据，然而效果通常不理想。最核心的问题在于一类数据往往有多个样本集，比如通过文本得到相关图像，每句话对应的图像数量不唯一，标签虽然是一个但是在内容本身上可能差距悬殊，类似这种情形下，传统的神经网络模型会尽量让标签的输出结果和训练结果接近，导致生成图像非常模糊。

鉴于此有研究者GAN 的基础上加入条件，让生成的数据和训练数据送往鉴别器时，都加入标签，构建 CGAN 模型，能够通过参数的控制生成我们需要的具有特定分布数据。CGAN 引入了条件，因此该网络的目标函数为：

$$
\operatorname* { m i n } _ { c } \operatorname* { m a x } _ { d } V ( D , G ) = E _ { \boldsymbol { x } \sim p _ { d a t a \left( \mathbf { x } \right) } } \big [ \log \mathrm { D } \big ( \boldsymbol { x } \mid \mathbf { y } \big ) \big ] + E _ { \boldsymbol { z } \sim p _ { z ( z ) } } \big [ \log \bigl ( 1 - D \big ( G ( \boldsymbol { z } \mid \mathbf { y } ) \bigr ) \bigr ) \big ]
$$

对比上面原始 GAN，可以看出条件生成对抗网络即在判别器与生成器之间全加一个辅助信息y,比如分类标签。在生成器中，我们选择随机噪声 $z$ ，与条件y 进行拼接组合输入到鉴别器中，鉴别器对真实样本，生成的噪声数据与标签y进行比较，得到结果。

CGAN 的网络结构如图所示。标签是one-hot 编码，即将噪声和标签通过连接，可以生成特定类别数据，如图3.5。

![](images/aedda509ebfa1260251b64897e8893026eb2e59984eb1e615835bc485ee8ef95.jpg)  
图 3.5 CGAN 网络框架  
Fig. 3.5 CGAN network framework

# 3.1.4 SGAN 原理

SGAN 是一种半监督式的生成对抗网络，并且可以实现对标记数据困难的分类问题提供很好的解决方案。在此我们解释一下监督学习和半监督学习的概念，监督学习是通过有标签的数据对模型进行训练的一种学习方式。半监督式的学习是用有标签和无标签数据一起，可以解决样本少，标记大量数据困难时仍可以训练的问题。

由前面DCGAN 可知鉴别器经过特征抽取后形成的判别器可做分类器，由判别器 D 学习到的特征可以提升分类器 C 的效果，一个好的分类器也能优化判别器的最终表现。加入标签数据训练网络可以提高鉴别器性能，鉴别器又提升生成器生成好的数据，由此可知鉴别器、生成器和分类器存在平衡点。基于此设计半监督训练方式，生成网络训练中的真实数据集可以看作有标签数据集，而由生成器随机产生的数据则可以被看作无标签数据集，同时训练生成器和分类器，同时生成高质量模型和半监督式分类器。

# 3.1.5 ACGAN 原理

ACGAN 是辅助分类生成对抗网络新模型。与刚提出的 GAN 最大差别是学习方式得不同，初始的是无监督学习，没有辅助分类器中对应的标签信息，辅助信息生成对抗是监督学习。辅助分类器是由标签和条件级联得到的隐含信息。生成的图像用 $X _ { \mathit { f a k e } } = G ( \mathit { c } , \mathit { z } )$ 鉴别器对生成数据，带标签的数据集对抗学习得到对数据真假的鉴别，以及对图像类别的识别。所以辅助分类生成对抗网络相当于有两部分组成。一部分是区分生成的数据和样本数据，另一部分是区分所有数据的标签的类别标签。

GAN 最大得两个缺点就是训练不稳定以及模式崩溃问题，ACGAN 利用标签信息防止GAN 为了生成安全样本，只生成少数高质量的图片欺骗鉴别器，使得生成样本基本相同。标签的存在可以让鉴别器关注到生成的类别，防止模式崩溃问题。例如用MNIST 数据集训练网络时，为了安全只生成其中一个数字，就发生了模式崩溃问题。ACGAN 结合了SGAN 还有监督和分类的思想以及CGAN的条件信息辅助，达到同时训练生成器和分类器的目的，不仅可得到质量较高的图片，训练稳定，还能拥有一个分类器实现对图像的识别。ACGAN 对小样本数据集训练任务有一定优势，通过生成的数据可以补充一定量的样本集，以及模型本身通过少量样本就能较快的收敛，从而可以很好的完成模型的训练。

ACGAN 的损失从对数据真假判断以及类别判断两方面考虑，对数据真假的判断分别是对生成数据和样本数据的判断。对数据类别的判断分别为生成数据和样本数据观测标签和预测标签类别的分析。因此ACGAN 模型损失函数如下。

$$
\mathrm { L s } = E [ \log p ( S = r e a l | X _ { r e a l } ) ] + E [ \log p ( S = f a k e | X _ { f a k e } ) ]
$$

$$
\mathrm { L c } = E [ \log p ( C = c \mid X _ { r e a l } ) ] + E [ \log p ( C = c \mid X _ { f a k e } ) ]
$$

其中，Ls 是准确分类的真实样本和生成样本的损失， $\mathrm { L c }$ 是准确分类样本类别的损失。所以，模型收敛函数判别器是最大化对数据真假以及类别判断的损失，生成器是最大化最小化数据真假损失和最大化数据类别损失。

下面是ACGAN 模型结构图如图3.6。

将带随机噪声和标签通过生成器得到我们的生成数据，将生成数据和带便签的数据一起送往鉴别器，通过生成数据和样本数据判断数据真假，通过观测标签和预测标签对比确定其分类效果。让生成的数据逐渐趋近样本数据集分布，使生成器和鉴别器达到平衡，此时分类器也能够实现对数据类别的鉴别。添加辅助信息的生成对抗网络模型能构用来分类识别，同时已有多个研究表明标签信息能够有效辅助模型的生成。

![](images/9b4e0bba3f97b23184e131532760091318414f62e64d802533b8f2e83bcda485.jpg)  
图 3.6 ACGAN 网络框架  
Fig. 3.6 ACGAN network framework

# 3.2 基于生成对抗网络算法的纸币红外特征提取与识别

# 3.2.1 生成对抗网络模型设计

ACGAN 模型是通过辅助信息和噪声生成具有特定特征的数据，相关研究表明，因为生成器和鉴别器博弈的机制，为了不被鉴别器发现自己是生成数据，往往生成的数据分布会相似于样本分布的中心区域。因此，可以生成和样本分布相同的数据，模型的生成数据能够补充样本数量，做均衡样本的数据集。同时结合了上述深度卷积生成对抗网络和条件生成对抗网络以及生成对抗网络的优点，综合判别器学习到的特征可以提升分类器的性能，分类器性能提升也可以优化判别器，判别器又会影响分类器。从而想到提出辅助分类生成对抗网络模型来完成红外特征纸币鉴伪，可以同时训练生成器与分类器，训练结束，然后用无标签数据进一步优化鉴别器，从而提高生成器和分类器性能，得到高质量的生成结果，将特征抽取后形成的鉴别器做分类器，用模型优化后生成的图像做补充样本来优化红外特征纸币的识别。

本文提出基于辅助分类生成对抗网络新的红外特征纸币鉴伪模型，优化参数，调整网络结构来完成纸币红外特征的提取与识别。针对假币数量少，真币数量相对多，训练过程存在小样本以及样本不平衡问题，用随机噪声生成我们需要特定分布类型的样本，来补充数据集得到较好的识别能力。经过研究该模型既能利用卷积神经网络强大的特征提取能力，又避免了卷积网络复杂难训练，不易收敛的缺点，可以降低样本不平衡导致的模型偏移问题，比较适合图像识别。实验结果表明，该方法能有效提高纸币红外特征鉴伪稳定性和准确率。这是提出的红外纸币鉴伪模型结构图，如下图 3.7。Z 是噪声数据，C 是图像的类别，将它们两个做一个级联操作得到带隐含编码的量，将它作为生成器 G 的输入，讲其映射到高维空间。鉴别器 D 对生成的数据和真实的数据做比较，根据损失函数，更新鉴别器和生成器网络参数，完成对抗学习得到真假数据以及数据的类别。

![](images/62d344c68dac308576572240eea2beac1d1d366c090d30be74219dfd1a5223ce.jpg)  
图 3.7 红外特征纸币鉴伪模型  
Fig. 3.7 Infrared characteristic paper money verification model

本模型在训练的时候固定一次生成器，训练多次鉴别器，选定优化函数，确定学习率，batchsize 大小,这样都是和模型是否能收敛以及是否会发生模式崩溃相关的重要参数。比较从生成数据中采集的数据和真实样本中采集的数据，观察鉴别器梯度，假设梯度是 x,w 是鉴别器参数，根据 $\mathbf { w } \gets \mathbf { w } { + } \mathbf { a } { \times } \mathbf { A d a m } ( \mathbf { w } , \mathbf { x } )$ ,可以更新鉴别器参数。同理，生成器训练的时候也是根据这个原理更新参数。

# 3.2.2 纸币红外特征提取与识别

（1）生成器就是对噪声和标签连接后的矩阵进行上采样过程，转置卷积可实现放大操作。这样可以把图像从分辨率低的变成分辨率高的，简单的理解就是把图片进行放大了。在我们做图像识别过程中，需要对图像进行像素级别的分类，因此在卷积提取特征后需要通过上采样将feature map 还原到原图中，如图3.8。

![](images/7fdaaac4d9b0dbb03410b9a3c2f695f06e04ed9ab7ebe439f353f2ec369ad50b.jpg)  
图 3.8 生成器网络结构  
Fig. 3.8 Generator network structure

上图中Z 是噪声数据，Y 是图像的类别，将它们两个做一个级联操作得到带隐含编码的量，将它作为生成器 G 的输入，将其进行映射到高维空间。随机初始化该网络得到初始化后的生成网络。卷积核为 $3 { \times } 3$ ,步长为1，通过一个五层卷积转置网络作为生成网络，最后得到三个特征图为 $3 2 \times 3 2$ 的数据，然后将其生成的数据送到鉴别器处理反馈。

（2）模型鉴别器网络结构如图3.9。

![](images/b5c1874dedb4fc3c68d3aa0e2382cc9b8fa74a399d8f5b93fef0d8ec7be70b60.jpg)  
图 3.9 鉴别器网络结构  
Fig. 3.9 Discriminator network structure

鉴别器需要我们对图像做下采样，下采样就是图像的缩小的过程。抽取图像特征用于分类。

模型中判别器的输入为 $3 2 \times 3 2 \times 3$ 的生成器生成的图像数据，卷积层之间用adam 作为激活函数，最后用两个 sigmoid。首先通过两个输出层特征数为 64，$3 { \times } 3$ 卷积核，移动步长为1，填充项为 1 的卷积层将维度映射到 $3 2 \times 3 2 \times 6 4$ ；其次使用输出层特征数为128，卷积核、步长及填充项和上面一样的卷积层进行特征提取，并利用池化域大小为 $2 { \times } 2$ ，步长为2 的池化层将维度映射到 $1 6 { \times } 1 6 { \times } 1 2 8$ ；然后再使用输出层特征数为256，卷积核、步长及填充项和上面一样的卷积层进一步提取特征，同时使用池化域大小为 $2 { \times } 2$ ，步长为 2 的池化层将维度映射到$8 \times 8 \times 2 5 6$ ；接着再利用输出层特征数为 512，卷积核、步长及填充项和上面一样的卷积层,以及池化将维度映射为 $4 { \times } 4 { \times } 5 1 2$ ；最后，将维度重构为 1024，池化之后使用全连接层将维度映射为2，使用两个sigmoid 函数之后即为判别器的输出，如图 3.9。

# （3）训练过程

训练生成网络与判别网络。随机产生一批100 维的噪声，并对每个噪声分配一个标签，噪声和标签做一个级联送入生成器，映射为高维数据，经过卷积过程生成图像与带标签的样本集以及不带标签的样本图像一起输入鉴别器。固定生成器通过看鉴别器对生成数据真假的鉴别能力以及类别的预测结果来更新鉴别器。固定判别器，通过判断生成器生成数据的为假的程度，以及生成数据的类别与目标之间的差值来更新生成网络。更新2 次判别网络再更新一次生成网络。判断迭代次数是否循环到设置的阈值，完成生成网络与判别网络的交替训练。本章提出一种辅助分类生成对抗网络纸币红外鉴伪模型损失函数和ACGAN 一样，分类的损失两部分组成，一部分是对数据真假的判断，另一部分是对数据类别的判断，有二者网络结构图可知，半监督辅助分类只是对无标签数据真假的判断损失。

# 3.3 本章小结

本章详细介绍了生成对抗网络的基本原理及其部分变形后的结构。本文基于辅助分类器ACGAN 结构，优化鉴别器进而优化分类器，提出基于辅助分类深度生成对抗网络鉴别红外纸币特征的模型。设计分类器和鉴别器网络结构，以及超参数，用于红外纸币图像特征提取和分类，通过生成高质量的特定分布的数据做样本，均衡各类别样本数据，送入分类器，得到较好的识别结果，从而实现对红外纸币的识别。

# 4. 基于生成对抗网络的纸币红外特征鉴伪模型改进

# 4.1 注意力机制

# 4.1.1 注意力机制基本原理

注意力机制（Attention Mechanism）[48-49]是让想让机器像人眼一样关注到重点特征。注意力机制是一个很宽泛的概念，随着针对它的研究越来越多，其操作方式也越来越多样。但它们都有一个共同的核心思想：对特征中更感兴趣的层面施加更大的注意力权重，而这个过程与人类观察物体的方式非常相似，期待在该领域有更多高质量的工作出现。因信息处理的瓶颈，我们不会重视全部信息，同时忽略低可能、低价值信息。这种机制通常被定义为注意力机制。人眼在观察事物的时候，眼睛不同部位对信息的处理能力不同，处理能力最强的是视网膜凸部位，所以为了更好的处理信息，人类会决定某个方向聚焦，获取对我们有用的最大信息量。例如，人们在阅读时，基本只有少量要被读取的词会被关注和处理。综上，注意力机制[50-51]主要有两个方面：决定需要关注输入的哪部分。分配有限的信息处理资源给重要的部分，从而使其拥有整体感受野，让机器在学习中不会随着网络训练的损失遗失掉重要信息。

随着人工智能的发展，在图像识别领域，注意力机制有着重要地位。是深度学习中防止梯度下降使得图像重要信息被忽略的有效手段。不仅能帮助深度学习理解图像，也能让我们了解神经网络处理信息的手段。从人类的感知过程可以了解注意力机制的地位，注意力不仅可以发现重要目标，还可以增强该位置上目标的不同表示。注意力机制会带来更具区分性的特征列，比如有三张写着1 的数字图片，我们需要生成数字 1，一张没做变化，一张做了旋转，另一张加了噪声干扰，但是注意力会注意到是1 这个信息，高效完成我们的目标。生成深度学习中的注意力机制从根本上来说和人类的选择性视觉注意力机制相似，核心目标为得到对目标任务有关键作用的特征。

# 4.1.2 注意力机制类型

本文从注意力域的角度来分析像人眼一样关注到主要特征的实现途径。其中主要分注意力域，空间域，通道域，混合域本文主要分析前两种：

（1）通道域：CNN 每一层都会输出一个 CHW 的特征图，C 就是通道，代表卷积核的数量，亦为特征的数量，通道注意力就是对每个C，在通道维度上，学习到不同的权重，因为考虑到卷积网络提取到的图像大量特征中有对图像所做任务无关紧要的特征，以及代表的是一些相似的的特征，给通道加注意力会相当于把这些特征滤除掉。使得对图像当前任务的处理更高效。例如下面的图4.1 通道注意力模型：

![](images/666b877b3c807051e83515805a6ea7fe254b6d38a3cfcb29908be3cb6b144509.jpg)  
图 4.1 通道注意力模型  
Fig. 4.1 Channel attention model

这个模型通过引入全连接对图像的降维与升维来增加图像的非线性，从而达到对通道间特征相关性做一个分析，得到通道注意力权重，降低了模型复杂度并且增加泛化能力。Sc 是变换后增加的注意力权重，Uc 是原通道的特征，两者通过 scale 操作后 $\mathrm { X c }$ 就是添加注意力后新的特征。

$$
\widetilde { \Chi } _ { c } = F _ { s c a l e } ( U c , S c ) = S c \cdot U c
$$

这里说一下 Self-Attention 机制。

Self-Attention 机制能够捕获特征图任意两个位置的空间依赖关系，获得依赖信息。Ulku 等[52]人认为全局上下文信息决定了最终的性能。2020 年来自 EPFL的 ICLR 2020 的一篇论文阐述到自注意力机制可以表达任何卷积滤波层[53]。图

4.2 是自注意力模型机制。feature maps 是由基本的深度卷积网络得到的特征图，如 ResNet、Xception 等，这些基本的深度卷积网络被称为 backbone，通常将最后ResNet 的两个下采样层去除使获得的特征图是原输入图像的1/8 大小。

Self-attention 结构自上而下分为三个分支，分别是 query、key 和 value。计算时通常分为三步

第一步是将query 和每个 key 进行相似度计算得到权重，常用的相似度函数有点积，拼接，感知机等；

第二步一般是使用一个softmax 函数对这些权重进行归一化；

第三步将权重和相应的键值value 进行加权求和得到最后的attention。

在对 proj_value 与 attention_map 点乘之前，先对 attention 进行转置。这是由于 attention 中每一行的权重之和为 1，是原特征图第 j 个位置对第 i 个位置的权重，将其转置之后，每一列之和为 1；proj_value 的每一行与 attention 中的每一列点乘，将权重施加于 proj_value 上，输出为 $\mathbf { B } { \times } \mathbf { C } { \times } ( \mathbf { W } { \times } \mathbf { H } )$ 。然后对 attention 之后的out 进行加权， $\mathbf { x }$ 是原始的特征图，将其叠加在原始特征图上。gamma 是经过学习得到的，初始 gamma 为 0，输出即原始特征图，随着学习的深入，在原始特征图上增加了加权的attention，得到特征图中任意两个位置的全局依赖关系。

![](images/81aa5ee2a8c27d74e023ec1b7549badcd48ae635a218d33a87501140480ca73c.jpg)  
图 4.2 自注意力模型  
Fig. 4.2 Self- attention model

（2）空间域：就是对图像空间位置信息的一个空间变换，如高乘宽乘通道的特征图，高乘宽通过不同池化然后卷积等操作得到权重系数就是空间位置注意力，与原特称图在该位置上做乘积，就是对每个位置添加关注权重。如图4.3。

输入一个特征图，对其通道进行最大池化和均值池化，将上述池化后的的结果基于通道做连接;连接后的结果经过卷积操作，通道降为1;将结果经过sigmoid可以得到空间位置的注意力权重量，然后与输入的特征图做乘法，让网络关注到图像当前任务的重要特征。公式：

$$
\begin{array} { r l } & { \mathbf { M s } ( F ) { = } \sigma ( f ^ { \mathrm { l x l } } ( [ A \nu g P o o l ( F ) ; M a x P o o l ( F ) ] ) ) } \\ & { { = } \sigma ( f 7 \times 7 ( [ F _ { a v g } ^ { s } ; F _ { \mathrm { m a x } } ^ { s } ] ) ) } \end{array}
$$

![](images/c182a0180e8ab21e90f8dc6a4a23b86416af7c41c613d9927e1a07a0fdda99d8.jpg)  
Spatial Attention Modile   
图 4.3 空间注意力模型  
Fig. 4.3 Spatial attention model

（3）混合域：综合通道域和空间域两个的局限性，既注意通道域中的信息，又关注空间域每个通道中的图片特征图处理。

关于模型优化，注意力机制通常由一个连接在原神经网络之后的额外的神经网络实现，整个模型仍然是端对端的，因此注意力模块能够和原模型一起同步训练。对于柔性注意力，注意力模块对其输入是可微的，所以整个模型仍可用梯度方法来优化。

# 4.2 引入注意力机制改进的红外特征鉴伪原理

辅助分类生成对抗网络中，鉴别器分为对生成纸币真假的鉴别还有对生成数据类别的预测，在对类别预测的过程中本文引入注意力机制。提升利于类别预测的重要特征，抑制不重要特征。

我们设计的注意力机制模型属于通道域注意力机制，主要集中在对特征维度这一层面进行处理。在原始纸币数据进入一个卷积层后便会得到不同的特征图，这时为了衡量这些特征对于分类的重要程度，便引入了注意力机制。在本文中，我们将经过卷积层后得到的特征送入sigmoid 函数中，它能够通过计算得到不同特征维度的各自的权重系数，然后得到的系数在与输入的特征进行对应元素相乘组成新的特征，而这些新特征便是经过权重分配的特征，能够帮助模型获得便于红外纸币分类的更关键和重要的信息，使模型做出更加准确的类别判断。即实现了注意力机制能够将更多的注意力像人眼一样集中在更加重要的特征上。下面是引入注意力机制鉴别器最后一层结构模式图，如图4.4。

代码描述：在鉴别器最后一层首先将 1024 维 $4 { \times } 4$ 的特征图经过池化变成1024 的 $1 \times 1$ 结构，然后将其做 sigmoid 计算，得到特征权重（attention_probs），再将特征权重和原特征图做乘法变换(multiply), 得到带权重的新特征（attention_mul）。基于改进的辅助分类深度生成对抗网络算法实现纸币识别，速度和正确率都得到了提升，但训练初期正确率没有明显变化。

![](images/3b297c71566b08b7aa4283215dd54120556a79d0c4b3873d291bbc779b8e126f.jpg)  
图 4.4 引入 Attention 的结构示意图  
Fig. 4.4 Structure diagram of introducing Attention

# 4.3 基于改进的生成对抗网络的纸币红外特征鉴伪

图4.5 是引入Attention 机制的生成对抗网络的纸币红外特征鉴伪模型结构。描述一下改进后的纸币红外特征鉴伪仍由生成器和鉴别器组成，鉴别器可以对生成数据真假进行判别，也可以对纸币类别进行分类。先优化生成器和鉴别器，优化鉴别器的时候，对鉴别器类别分类的分支引入注意力机制，对该条线路的纸币类别特征分配权重系数，使得分类特征带有权重，突出对类别分类重要类别特征的学习，可以得到更优更好的鉴别器。然后用无标签的数据进一步优化鉴别器，得到高质量的具有特定分布的生成纸币，用生成纸币做部分样本，均衡样本数据类别。这里注意力机制对生成纸币有无影响没有做验证实验，以后可以对生成纸币分类做一个对比试验。对均衡后的样本再次识别发现其相对于改进前识别率上升，说明引入 Attention 会对红外纸币特征的分类有一定的提升，能对上述提出的纸币鉴伪模型做出改进，有利于本文的红外特征纸币鉴伪。

结构上该模型在我们已经提出的模型结构加入 Attention 机制，其他地方不变，使得我们模型在训练的时候会关注到对我们红外图像分类影响大的特征因素，并且为其加权，随着训练的进行，权重值不断学习，从刚开始的0，学习到Attention，给与特征图重点关注，去掉一些无关紧要的冗余信息，使得分类正确率更好。

这里提一下，Self-attention 对针对本实验模型，以及数据集分类也有较好的表现，可以学习到特征之间的相关性，因为每种纸币在制作的时候都有相似的油墨处理，都有一定的规律，实验结果对分类结果明显的提高。

本研究模型能解决假币样本少且不均衡的问题，能够为具有相似问题[54-56]的其他研究提供处理方向。

![](images/e4c3206e491a3248b5c521df5c92f6e6eade432ddacca27931b8abf8a0cd239c.jpg)  
图 4.5 改进的生成对抗网络结构图  
Fig. 4.5 Structure diagram of improved generative adversarial network

# 4.4 本章小结

本文详细介绍了注意力机制的基本原理，介绍了三种类型的注意力机制，本模型用的通道域的注意力机制，通道域中介绍了自注意力机制以及在网络某层直接对通道加注意力的模型。这两种本人都有尝试，一个是关注直接特征图，给利于分类的特征图予以权重分配，减少冗余特征，另一种是关注特征之间的关系，从而给纸币一个全局感知力，本文介绍的模型加入的是对分类特征的关注。鉴于注意力能够像人眼一样关注到分类任务的关键特征，引入 Attention 机制，在鉴别器网络最后一层提取特征用Sigmoid 做一个特征权重，然后和最后一层特征相乘做一个权重分配，便于关注重点特征，期望提高模型训练速度和准确率。由于加入注意力后，网络仍是端到端的模型，权重输入可微，损失函数依旧可用原来模型的。构建基于 Attention 的深度生成对抗网络的纸币红外特征鉴伪模型。该模型分类能力在一定范围分类较好。

# 5. 实验结果与分析

# 5.1 实验环境与过程

# 5.1.1 实验环境

本实验数据集是在聚龙公司采集红外纸币图像，有500 张真币，50 张假币。算法设计平台：Windows10，PyCharm2019。算法语言：Python3.7。深度学习框架：PyTorch。

# 5.1.2 性能评价指标

观察模型的效果，一个合适的评价指标是必要的。在数据集均等的条件下，一般用正确率评价模型效果，但是当数据差异较大时，正确率就会变得比较片面，不足以评价模型的整体性能。比如对两类数据进行分类时，正样本为 99 个，负样本为1 个，把分类器设定为对正样本的充分预测就能得到 $9 9 \%$ 的分类结果，把负样本也被判断为正样本，但是这个 $9 9 \%$ 正确率的分类器没有意义，不能分出正负样本。对类别判定结果错误的惩罚若用一样值是不合理，很明显正确率不足以表示分类器性能。

本文红外特征纸币识别是两类书籍的分类问题，由于数据集存在非平衡性，若假币因为数量少没被检测到就认为模型准确率高是不符合实际需求的，因此我们选择具有全面衡量模型性能的评价指标，分别为准确率、精确率、召回率和F1。根据预测标签和真实标签组合定义本文红外纸币特征分类混淆矩阵。表5.1表示数据的字母化表示，比如标签FP 表示真币预测为假币。

# 表 5.1 混淆矩阵

Tab. 5.1 Confusion matrix   

<html><body><table><tr><td>标签真币</td><td>标签假币</td><td>预测假币</td><td>预测真币</td></tr><tr><td>FP</td><td>TP</td><td>TP</td><td>FN</td></tr><tr><td>TN</td><td>FN</td><td>FP</td><td>TN</td></tr></table></body></html>

混淆矩阵样本和即样本总数量，依据混淆矩阵可以得出Accuracy、Precision、Recall 和 F-score 值的计算公式为：

$$
\mathrm { A c c u r a c y } { = } \frac { T N + T P } { T N + T P + F P + F N }
$$

$$
\mathrm { P } r e c i s i o n { = } \frac { T P } { T P + F P }
$$

$$
R e c a l l = \frac { T P } { T P + F N }
$$

$$
F - s c o r e = \frac { 2 \times P \mathrm { r } e c i s i o n \times \mathrm { R } e c a l l } { \mathrm { P r } e c i s i o n + \mathrm { R } \mathrm { e } c a l l }
$$

Accuracy 为所有样本中，标签预测和真实一致的样本。Precision 为预测为真币的样本中，标签为真币的比例，通俗来讲假币误判为真币。但和正确率不一样，总体样本不是全部数据集，而是判断为真币的数据。Recall 为真实标签是真币的样本，被预测为真币的比例。通俗来讲真币都被分类正确。但是，现实中如何让分类器能把所有真币都分类正确，就容易把假币也归到真币范围中，也就是召回率变高，精确度就会变低，我们需要综合考虑二者，故提出 F-score，对结果综合评价。

# 5.1.3 实验过程

不平衡分类问题一般由学习、验证和预测三个过程组成，学习过程通常是使用训练数据集对分类模型参数进行训练，得到一个较为完善的分类器；验证过程就是检验模型的状态，用于调节超参数、监测是否发生过拟合。预测过程是使用这个训练好的分类器根据新的同类型输入得到相应的输出值，测试模型泛化能力。本章做的实验分析大致分为下面几块。对红外纸币数据集划分如表 5.2，增加生成样本后划分的纸币数据集如表5.3。

# 表 5.2 划分后的纸币数据集

Tab. 5.2 The divided banknote data set   

<html><body><table><tr><td>数据集</td><td>正样本数</td><td>负样本数</td><td>总样本数</td></tr><tr><td>训练集</td><td>25</td><td>300</td><td>225</td></tr><tr><td>验证集</td><td>10</td><td>100</td><td>110</td></tr><tr><td>测试集</td><td>15</td><td>100</td><td>115</td></tr></table></body></html>

表 5.3 增加后划分的纸币数据集  
Tab. 5.3 Data set of banknotes divided after addition   

<html><body><table><tr><td>数据集</td><td>正样本数</td><td>负样本数</td><td>总样本数</td></tr><tr><td>训练集</td><td>125</td><td>300</td><td>425</td></tr><tr><td>验证集</td><td>10</td><td>100</td><td>110</td></tr><tr><td>测试集</td><td>15</td><td>100</td><td>115</td></tr></table></body></html>

# （1）实验一

对上述提出的辅助分类生成对抗网络红外纸币鉴伪模型做训练、验证、测试、分析。数据集如表5.2，利用生成若干的纸币数据做补充训练集。

利用训练好的模型生成的数据做样本，做样本图像的个数分别设为25、50、75、125、125、300，以及设计不平衡数据集，观察模型分类结果。

模型结构的参数在前面章节已经列出，超参数设置：batchsize 设为 64，优化函数为 Adam，学习率设为2e-4，betas 设为（0.5，0.999）。通过训练自动调节模型参数，通过验证微调超参数，完成纸币识别。

# （2）实验二

设计 CNN 模型，卷积层结构和深度与鉴别器相同。使用和表 5.2 相同的数据集去训练CNN 模型、测试红外纸币图像，观察其收敛情况及分类结果。增加本文模型生成的数据均衡样本数据训练 CNN 模型，数据集如表 5.3。观察模型分类结果。设计不平衡数据集观察模型分类结果。

# （3）实验三

对已提出的红外特征纸币鉴伪模型加入 Attention 改进的模型做训练、验证测试，数据集同表 5.2、5.3。观察和原模型数据集相同时的分类结果。为验证该模型的泛化能力，固定假币样本数量，增加真币样本数量，观察模型对非平衡数据的处理能力。

# 5.2 实验结果

本文统计的实验数据如下各表。表5.4 是对本文提出的纸币红外特征鉴伪模型生成的纸币数据进行处理，将生成的纸币作为样本数据集加入模型训练的结果。可以看出，说明本文提出的模型能完成对红外特征纸币的识别，本文增加 100个左右生成图像做训练数据集时，红外特征纸币的分类效果最好。

# 表 5.4 增加样本后模型测试

Tab. 5.4 Model testing after adding samples   

<html><body><table><tr><td rowspan="2">假币数据集</td><td colspan="3">本文模型</td></tr><tr><td>精确率</td><td>召回率</td><td>F-score</td></tr><tr><td>25</td><td>0.8356</td><td>0.8314</td><td>0.8335</td></tr><tr><td>50</td><td>0.8479</td><td>0.8396</td><td>0.8437</td></tr><tr><td>75</td><td>0.8512</td><td>0.8416</td><td>0.8464</td></tr><tr><td>100</td><td>0.8803</td><td>0.8632</td><td>0.8717</td></tr><tr><td>125</td><td>0.8529</td><td>0.8764</td><td>0.8645</td></tr><tr><td>150</td><td>0.7856</td><td>0.8876</td><td>0.8335</td></tr></table></body></html>

一般来说数据差两倍以上就被认为是不平衡样本数据，表5.5 是将负样本逐次增加，观察随着样本不平衡程度的加大，观察两种模型的泛化能力。

Tab.5.5 Model generalization performance comparison   

<html><body><table><tr><td rowspan="2">数据不平衡 程度（倍）</td><td colspan="3">改进后的本文模型</td><td colspan="3">CNN</td></tr><tr><td>精确率</td><td>召回率</td><td>F-score</td><td>精确率</td><td>召回率</td><td>F-score</td></tr><tr><td>2</td><td>0.7667</td><td>0.8386</td><td>0.8010</td><td>0.7857</td><td>0.8031</td><td>0.7943</td></tr><tr><td>4</td><td>0.8231</td><td>0.8453</td><td>0.8341</td><td>0.8696</td><td>0.8147</td><td>0.8413</td></tr><tr><td>6</td><td>0.8862</td><td>0.8510</td><td>0.8730</td><td>0.9047</td><td>0.7902</td><td>0.8436</td></tr><tr><td>12</td><td>0.8938</td><td>0.8621</td><td>0.8777</td><td>0.8947</td><td>0.6800</td><td>0.7727</td></tr></table></body></html>

有前面表 5.4 可知，此实验生成的数据取 100 用来做样本效果良好，表 5.6是用125 假币特征数据，300 真币特征数据训练得到结果。

# 表 5.6 模型测试结果

表 5.5 模型泛化性性能对比  
Tab. 5.6 Model test results   

<html><body><table><tr><td>Methods</td><td>精确率</td><td>召回率</td><td>F-score</td></tr><tr><td>本文模型</td><td>0.8926</td><td>0.8641</td><td>0.8781</td></tr><tr><td>本文模型+CNN</td><td>0.9260</td><td>0.8482</td><td>0.8854</td></tr><tr><td>改进的本文模型</td><td>0.9146</td><td>0.8904</td><td>0.9023</td></tr></table></body></html>

![](images/c92a9f21faefd6a3516b72a327427e4e26fef170177e723eb84075296c8d1030.jpg)  
图 5.1 生成器训练初期产生的样例图  
Fig. 5.1 Sample diagram generated by the generator

图 5.1 是模型训练初期生成的图像样例。图 5.2 是生成器训练结束产生的样例图，展示的是具有假币特征的图像，也可生成具有真币特征的数据图像。

![](images/291e0c1109c65d0fe32534ff1b5e539ef4e70d9eab8f6d735328c46141b35c1d.jpg)  
图 5.2 生成器训练结束产生的样例图

CNN 模型测试正确率结果图如图5.3。

![](images/b55012cf4526dc15d8294d264098b42d7a04c2b68c3f4a00db932d94797e0fca.jpg)  
Fig. 5.2 Sample diagram generated by generator   
图 5.3 CNN 模型测试正确率  
Fig. 5.3 CNN model testaccuracy

图5.3 是 CNN 模型样本集训练测试结果图，测试正确率是 $7 5 \%$ ，对于测试集假币分类不准，存在过拟合现象。

图5.4 是 CNN 模型加入生成模型生成的样本训练测试结果图 $82 \%$ ，本模型生成数据可以达到数据增强的目的。

本模型提出的ACGAN 模型结果图如图5.5，正确率能达到 $87 \%$ ，对真假币分类有效。加入Attention 后如图5.6，并且加入生成数据去训练，初始效果不明显，因为权重系数初始为零，它在不断学习中，随后模型分类提高，正确率能达到 $90 \%$ ，对纸币识别有效，这对于不均衡小样本数据分类有了一定效果，但是模

型稳定性还需进一步研究。

![](images/1eac80d86fd6829a13a37747819161661011d644a77a4b575c6fd951cb17c010.jpg)  
图 5.4 增加数据集后 CNN 模型测试正确率

图5.5 是本文开始提出的辅助分类生成对抗网络对纸币鉴伪的正确率，图5.6是引入Attention 机制后对纸币鉴伪的正确率。

![](images/f3199fbb45d481dc2959d2975d88211bcb4a94b6441b0eecfa84849a0b0b3632.jpg)  
Fig. 5.4 After add data CNN model testaccuracy   
图 5.5 ACGAN 模型训练结果  
Fig. 5.5 ACGAN model training results

![](images/84566572fe57cd0f57498d05d0828f81fed7cfa581c630ca364bf11b32886e11.jpg)  
图 5.6 加入 Attention 模型训练结果  
Fig. 5.6 Join the Attention model training results

# 5.3 实验分析

（1）可以看出，说明本文提出的模型生成的数据能提高对红外特征纸币的识别，但是增加的数据不是越多越好，根据结果显示本文增加100 个左右生成图像做训练数据集时，纸币的分类效果最好，解决本文红外特征图像样本少的问题。（2）看出本文模型泛化能力好，对不平衡的小样本数据在一定范围内有较好分类效果。本模型改进后对非平衡数据也有较好的适应性。（3）用 CNN 实验验证集正确率低，存在过拟合，说明本文用于纸币识别的模型对小数据分类友好，模型性能好。CNN 模型训练数据添加了生成样本的时候，正确率的提升进一步验证了生成样本可实现数据增强。（4）本文第三章提出的红外纸币鉴伪模型，能够实现红外特征纸币识别；由测试结果的正确率分析，可知生成对抗网络的生成数据能够达到数据增强的效果，能够提高对纸币红外特征识别；能够对不平衡数据及小样本数据分类提供一个解决思路。（5）对本文提出的红外纸币鉴伪模型改进优化的分析，通过引入 Attention为类别特征增加权重，一定条件下能够提高红外特征纸币分类准确率，能够较好完成本文小样本图像识别。

（6）生成对抗网络参数调优总结

$\textcircled{1}$ 实验中关于迭代次数的总结：迭代次数不是越多越好，会有过拟合的情况。一般设置迭代次数多一点，然后设置结束误差，达到允许的误差之后跳出就行了。

$\textcircled{2}$ 实验中关于优化函数的总结：实验中关于优化器的总结：优化器常用主要有 SGD，Momentum，RMSprop，Adam。SGD 是最随机梯度下降优化器，解决了大型训练数据集存在数据冗余的问题，具有不稳定收敛的弊端，其中Momentum 是 SGD 的改良版，它加入了动量原则，优化具有方向性，和任务相关。而后面的RMSprop 又是Momentum 的升级版，解决训练陷入局部最优停滞不前的问题。加上Adam 又是RMSprop 的升级版。所以在RMSProp 的基础上，做两个改进：梯度滑动平均和偏差纠正。不过从这个结果中我们看到。Adam 的效果似乎比 RMSprop 要差一点。优化器的好坏不能由进先进程度决定，每种优化器是根据特定需求下产生的，再实验中，需要我们自己去探索，才能找到最合适的。本论文选用的是Adam，初始设置为2e-4。

$\textcircled{3}$ 实验中关于损失函数的总结：若训练数据和测试数据的损失不断上升，说明网络结构和参数设置的不合理，这种情况不容易处理。若训练数据和测试数据损失没有变化，说明网络没有学习，这个时候可以对学习率或者数据 batchsize进行调整。若训练的是后损失趋于不变，测试损失不断下降，说明测试数据集需要调整。若网络训练损失呈下降趋势，测试损失趋于不变，训练过拟合，可加最大池化方法。训练损失和测试损失都在下降，说明网络仍在学习。

（7）实验总结：通过以上研究表明，本文提出的基于辅助分类生成对抗网络模型可以解决红外特征纸币样本少以及样本不平衡问题；相对于目前流行的神经网络来说其既具有强大的特征提取能力，又避免其需要大量样本数据做支持才能实现特征提取和分类的目的；生成的样本数据能够达到数据增强的效果；引入Attention 机制，可以优化已提出模型对红外特征纸币的分类效果。在一定程度上取得良好的分类效果。

# 5.4 本章小结

本章对前面三四章理论进行了实验验证，在对比分析中得出卷积神经网络对于本实验红外特征图像不平衡的小样本易发生过拟合，本文提出的模型生成的图像一定程度上可以缓解本实验样本不均衡问题；本文所提出模型的理论可行，可以生成有效样本，并且用于纸币识别；经过对优化模型的实验及对比，得出改进的方案对红外特征纸币识别可行，并对实验中的参数调节做了充分的记录，总结实验中参数调节过程为以后的实验提供参考方向。通过整体对比试验证明，引入Attention 改进的基于辅助分类生成对抗网络最有利于本实验中数据不平衡的红外特征纸币的识别。

# 6. 总结与展望

# 6.1 总结

首先分析了清分机的发展，重要组成以及对社会的重要意义。随着自动化的发展，集机械化和智能化优势为一体的清分机，降低了该行业对人力的需求，而且还实现双赢，提高了工作效率和准确率，其优势使得需求量日益增多。但是仍有不法分子钻空子，造假币者瞒天过海，这说明清分机图像处理单元的纸币识别仍需结合最新科学技术进行研究。本文结合清分机图像处理单元的防伪油墨功能展开研究，对要经过清分机通道的红外图像进行了预处理、特征提取以及完成识别，对纸币鉴伪研究尽了自己一份力量。下面是具体工作：

首先分析总结纸币在清分机中产生的噪声类别，纸币图像倾斜成度，设计噪声处理模型，完成倾斜校正模型。深入研究对图像去噪的算法，提出了一种小波变换和Gabor 变换结合去噪的方法，保留纸币特征的同时，完成去噪。以及基于Randon 变换、canny 算子对图像倾斜校正和分割操作，为后面纸币识别做好准备。

针对纸币红外特征鉴伪问题，提出了辅助分类生成对抗网络纸币红外特征鉴伪模型，对纸币在少数便签下就能得到较好的分类器，能够提高模型的准确率和稳定性；生成的具有特定特征的纸币可补充数据集，模型分类能力得到了提升，在一定程度上解决了红外特征纸币样本少且不均衡的问题，防止由于数据训练不均导致的模型偏移等；引入注意力机制，对上述提出的生成对抗网络提取图像特征和识别的模型做出优化改进，使得模型中的网络关注纸币图像用于分类的特征，模型分类性能得到了提升；经过研究对比分析，本文提出的模型可解决红外纸币样本不均衡的小样本问题，缓解了深度网络处理小样本数据时易出现过拟合的现象，对其他不均衡小样本图像提供一个处理方向。

# 6.2 展望

在人工智能领域中，像本文红外纸币特征识别这种不均衡小样本问题，是有很多且亟需解决的，比如医疗、安全等，是目前的一个前沿性课题。清分机纸币鉴伪在长时间探索的过程中，虽已获取相对丰硕的成果，然而科技一直在进步，我们要把领先的科学技术应用到纸币鉴伪中，才可能保证纸币的安全。鉴于假币数量不均衡小样本问题，目前纸币识别领域对这种问题解决方法还不完善，需要我们对理论做出探索并联系实际为我们的生活带来便利，让纸币在市场流通中正常运行。本文提出辅助分类生成对抗网络模型，设计出具有创新性的纸币识别模型。引入注意力机制进一步改进生成对抗网络鉴伪模型。由于研究条件局限性，本文的算法肯定还不是最佳的，日后将以下列方面为着眼点，展开深层次地研究：

（1）GAN 有多种模式，且不断发展，我们生成对抗网络模型应该还有优化空间。（2）本文提出的模型对不均衡类别样本数据处理中,若一类数据量很大，正确率会大幅提升,在本实验中用的真币样本少,数据多了之后模型正确率还会有提升，因此该模型泛化性可观。（3）本文基于清分机软件设计部分理论的研究，应考路结合清分机软件与硬件，使其发挥各自的优势,最终提高运行的效率。（4）非平衡数据集的处理方法[57-58]分两类：有直接让数据集平衡的样本过采样和样本降采样方法。可以综合以上方法考虑此类问题。

参考文献[1] 赵彩凤.基于随机森林的纸币红外特征鉴伪算法研究[D].辽宁科技大学,2019.[2] 李健.大额人民币部分图像特征的自动鉴伪[D].南京理工大学,2015.[3] 吴财源,钟球盛,侯文峰.基于机器视觉的纸币清分机设计分析[J].机械设计与研究,2017,33(05):60-62+67.[4] 谭晗. 纸币识别系统的设计[D].辽宁科技大学,2017.[5] 马骏,钱亚冠,郭艳凯,等.不均衡数据对卷积神经网络的影响及改进算法[J].浙江科技学院学报,2020,32(03):181-190.[6] Gaby, Haddow. Research classification and the social sciences and humanities in Australia:(Mis)Matching organizational unit contribution and the impact of collaboration[J]. ResearchEvaluation, 2015, 24(3):325-339.[7] Guan H,Zhang Y,Xian M,et al.SMOTE-WENN: Solving class imbalance and small sampleproblems by oversampling and distance scaling[J].Applied Intelligence,2020(4).[8] Tingting Wang,Huayou Su,Junbao Li.DWS-MKL: Depth-width-scaling multiple kernellearning for data classification[J].Neurocomputing,2020,411.[9] 易心一.面向小样本及数据不平衡问题的超声图像自动分类[D].西南交通大学,2019.[10]戴福双.基于子空间学习和稀疏编码的图像分类算法研究[D].北京交通大学,2016.[11]F Takeda,S Omatu,T Inoue,et al.Bill Money Recognition Using Neural Network with FFT asPre-Processor[J].Transactions of the Institute of Systems Control & InformationEngineers.1992, 5(7):265-273.[12]F.Takeda,S.Omatu.High-speed paper currency recognition by neural networks[J].IEEETransactions on Neural Networks.1995,6(1),73-77.[13]Sigeru Omatu,Ali Ahmadi,Michifumi Yoshika. Implementing a Reliable Neuro-Classifier forPaper Currency Using PCA Algorithm[C].In Proceeding of the 41st SICE Annual Conference,vol.4,2002,Aug5-7,2466-2468.[14]刘晓雅.基于多光谱图像分析的纸币鉴伪关键技术研究[D].湖南大学,2015.[15]刘艳萍,杜秋晨,张进东.基于 BP 神经网络的纸币面向识别方法[J].计算机应用与软件,2015,32(11):176-179.[16]曹贵强. 纸币识别及红外鉴伪技术的研究[D].辽宁科技大学,2014.[17]肖雪.基于支持向量机的纸币识别方法的研究[D].辽宁科技大学,2015.[18]YX Wang,RGirshick,etal.Low-shot learning from imaginary data[C].Proceedings of the IEEEconference on computer vision and pattern recognition. 2018: 7278-7286.[19]杨懿男,齐林海,王红,苏林萍.基于生成对抗网络的小样本数据生成技术研究[J].电力建设,2019,40(05):71-77.[20]杨杰. 美元多光谱图像识别若干关键技术研究[D].华中科技大学,2018.[21]蒋天瑜. 基于多光谱图像的纸币防伪鉴定技术研究[D].华中科技大学,2013.[22]谢岱伟. 红外图像细节增强算法研究及其 FPGA 实现[D].南京理工大学,2016.[23]唐麟,刘琳,苏君红.红外图像噪声建模及仿真研究[J].红外技术,2014,36(07):542-548.[24]张再军.基于图像处理的试题切割方法研究[J].科技视界,2019(17):77-78.[25]孙鹏.纸币图像特征提取与识别问题研究[D].辽宁科技大学,2012.

[26]魏正宜. 纸币图像识别算法的研究[D].哈尔滨理工大学,2009.  
[27]周飞燕,金林鹏,董军.卷积神经网络研究综述[J].计算机学报,2017,40(06):1229-1251.

[28]Deivalakshmi S,Palanisamy P.Removal of high density salt and pepper noise through improved tolerance based selective arithmetic mean filtering with wavelet thresholding[J].

AEU-International Journal of Electronics and Communications,2016, 70(6):757-776.[29]张涛.小波变换在图像去噪和边缘检测中的研究与应用[D].贵州大学,2016.[30]张国伟. 基于小波变换的图像去噪方法研究[D].昆明理工大学,2014.[31]许 宏 科 , 秦 严 严 , 陈 会 茹 . 一 种 基 于 改 进 Canny 的 边 缘 检 测 算 法 [J]. 红 外 技术,2014,36(03):210-214.[32]尚晓波. 车牌识别系统中倾斜校正和字符识别的研究与实现[D].杭州电子科技大学,2015.[33]吴 少 乾 , 李 西 明 . 生 成 对 抗 网 络 的 研 究 进 展 综 述 [J]. 计 算 机 科 学 与 探索,2020,14(03):377-388.[34]梁俊杰,韦舰晶,蒋正锋.生成对抗网络 GAN 综述[J].计算机科学与探索,2020,14(01):1-17.[35]邹秀芳,朱定局.生成对抗网络研究综述[J].计算机系统应用,2019,28(11):1-9.[36]Xiaobo LIU,Yulin QIAO,Yonghua XIONG et al.Cascade conditional generative adversarialnets for spatial-spectral hyperspectral sample generation[J].Science China(InformationSciences),2020,63(04):81-96.[37]Radford A, Metz L,Chintala S.Unsupervised Representation Leami with Deep ConvolutionalGenerative Adversarial Networks [J].Computer Science, 2015.[38]Denton EL,Chintala S,Fergus R.Deep Generative Image Models Using a LaplacianPyramidof Adversarial Networks[C].[39]Amina Khatun,Mohammad Reduanul Haque,Rabeya Basri et al. Single Image Dehazing:AnAnalysis on Generative Adversarial Network[J].Journal of Computer andCommunications,2020,08:04.[40]刘坤, 王典, 荣梦学. 基于半监督生成对抗网络 X 光图像分类算法[J]. 光学学报,2019,39(08):117-125.[41]刘建伟,刘媛,罗雄麟.半监督学习方法[J].计算机学报,2015,38(08):1592-1617.[42]Yanwen Chong,Yun Ding,Qing Yan et al.Graph-based semi-supervised learning: Areview[J].Neurocomputing,2020,408:13.[43]周 林 勇 , 谢 晓 尧 , 刘 志 杰 , 等 . 基 于 ACGAN 的 图 像 识 别 算 法 [J]. 计 算 机 工程 $, 2 0 1 9 , 4 5 ( 1 0 ) { : 2 4 6 - 2 5 2 } { + 2 5 9 } .$ [44]刘群,陈锻生.采用 ACGAN 及多特征融合的高光谱遥感图像分类[J].华侨大学学报(自然科学版),2019,40(01):113-120.[45]易珂.基于深度网络 ACGAN 的图像识别[J].电子技术与软件工程,2018(18):60-61.[46]吴正文. 卷积神经网络在图像分类中的应用研究[D].电子科技大学,2015.[47]常 亮 , 邓 小 明 , 周 明 全 , 等 . 图 像 理 解 中 的 卷 积 神 经 网 络 [J]. 自 动 化 学报,2016,42(09):1300-1312.[48]黄伟建,李永涛,黄远.基于混合神经网络和注意力机制的混沌时间序列预测[J].物理学报,2021,70(01):235-243.[49]翟育鹏. 基于深度学习的极化 SAR 地物分类[D].西安电子科技大学,2018.[50]王培森. 基于注意力机制的图像分类深度学习方法研究[D].中国科学技术大学,2018.

[51]Yirong Zhou,Jun Li,HaoChen,Ye Wu,et al. A spatiotemporal hierarchical attention mechanism-based model for multi-step station-level crowd flow prediction[J].Information Sciences,2021,544.   
[52]Ulku I,Akagunduz E.A Survey on Deep Learning-based Architectures for Semantic Segmentation on 2D images[J].arXiv preprint arXiv:1912.10230, 2019.   
[53]B J Z A ,B Y W ,B W X ,et al.GSSA: Pay attention to graph feature importance for GCN via statistical self-attention[J].Neurocomputing, 2020,417:458-470.   
[54]路扬. 面向小样本不平衡数据的生物医学事件抽取方法研究[D].吉林大学,2019.   
[55]陶存贵. 不平衡小样本数据的特征提取与分类方法研究[D].哈尔滨工业大学,2012.   
[56]Streun Gabriel L,Elmiger Marco P,Dobay Akos,Ebert Lars et al.A machine learning approach for handling big data produced by high resolution mass spectrometry after data independent acquisitionof small molecules-Proof of concept study using an artificial neural network for sample classification.[J].Drug testing and analysis,2020,12(6).   
[57]CHUNG Y A,LIN H T,YANG S W.Cost-aware pre-training for multiclasscost-sensitive deep learning[J]. arXiv preprint arXiv:1511.09337, 2015.   
[58]ZHANG G,SUN H,JI Z,et al.Cost-sensitive dictionary learning for facerecognition[J]. Pattern Recognition, 2016, 60: 613-629.

# 攻读硕士学位期间发表学术论文情况

[1] 陈小静，曹语含，张学东.基于生成对抗网络的纸币红外特征鉴伪[J]辽宁科技大学学报,2020(6).

# 致 谢

时间快的让我着急啊，还没好好珍惜，大学美好时光就没了，还能在科研中感受快乐，研究生的充实岁月也即将终结。真的好希望时间静止啊，停在这一刻，阳光透过玻璃落在我的胳膊上，岁月静好。

在此我首先要感谢我的导师张学东教授，这两年半一来，我的导师对学术的认真与严谨的态度潜移默化影响着我。在我遇到问题停滞不前时，我的导师不会置之不理，也不会苛责我，总是给予我最舒适的帮助，让我在鼓励中成长，这个方式对我真是太有效了，十分感谢张学东老师的教诲。我的导师总是能引导我去科研，就像黑夜中始终有一盏灯在不远处亮着，温暖又有方向。我的导师不仅对我学业科研有所帮助，导师的优秀品德，人格魅力，幽默且有深度的思想等等对我也有深远的影响。虽然要毕业了，还想继续跟着老师学习，我总是和他人说感觉没能用更多的时间跟着老师学习，遗失了一大笔财富，让我再次感谢我的导师张学东教授。真希望时间多一点，还能在您的指导下继续科研。我还要感谢身边热心善良可爱的同学们，在炎热的暑假，我们为了完成论文并肩作战，有你们在我身边，再棘手的困难都可以顺利解决，再炎热的天气也可以快乐度过，我们一起同甘苦、共患难，互相帮助，关爱彼此，两年半的时间培养了我们深厚的友谊，你们是我奋斗路上最坚强的后盾，愿我们的友谊天长地久！

我还要感谢我的学姐赵彩凤、李若曦、赵一秾以及我的科研伙伴曹语含、师妹杜晓雨，我的室友齐佳琪、朱鑫洋、何明以及朋友们，无论学业还是生活都因为你们在我生活中得出现变得有声有色，我很庆幸遇到你们！

另外感谢我的家人对我的陪伴与支持，让我勇往直前，让我可以单纯快乐，让我可以享受生活！

即将结束在此学习的生活，相信等待我的是一片充满机遇、风险与快乐的土地;也相信我和同仁们的事业必将如涅磐之凤、浴火之凰;更加相信，不朽的民族精神终将引领我们创造新的奇迹!“风雨不改凌云志，振衣濯足展襟怀。行方智圆煅内蕴，海阔天空铸宏图。”

研究生生活快要结束了，虽然舍不得，可是人生就是这样，有好多个站点。我会整理好自己，下车后脚踏实地的走向未来，不辜负爱我的人的期望，不辜负现在的自己。未来你好呀，我会做好准备去接你的！

![](images/1c6cab0d4eb8ba1a77d7d6988cbd60d2ba0964023cdc0b3b679cc4c0ad96cc91.jpg)